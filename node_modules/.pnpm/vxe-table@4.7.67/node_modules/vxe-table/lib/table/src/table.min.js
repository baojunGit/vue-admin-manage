"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _vue=require("vue"),_xeUtils=_interopRequireDefault(require("xe-utils")),_dom=require("../../ui/src/dom"),_utils=require("../../ui/src/utils"),_ui=require("../../ui"),_cell=_interopRequireDefault(require("./cell")),_body=_interopRequireDefault(require("./body")),_header=_interopRequireDefault(require("./header")),_footer=_interopRequireDefault(require("./footer")),_props=_interopRequireDefault(require("./props")),_emits=_interopRequireDefault(require("./emits")),_util=require("./util"),_vn=require("../../ui/src/vn"),_log=require("../../ui/src/log"),_panel=_interopRequireDefault(require("../module/custom/panel")),_panel2=_interopRequireDefault(require("../module/filter/panel")),_importPanel=_interopRequireDefault(require("../module/export/import-panel")),_exportPanel=_interopRequireDefault(require("../module/export/export-panel")),_panel3=_interopRequireDefault(require("../module/menu/panel"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const{getConfig,getI18n,renderer,formats,createEvent,globalResize,interceptor,hooks,globalEvents,GLOBAL_EVENT_KEYS,useFns}=_ui.VxeUI,isWebkit=_dom.browse["-webkit"]&&!_dom.browse.edge,customStorageKey="VXE_CUSTOM_STORE";var _default=exports.default=(0,_vue.defineComponent)({name:"VxeTable",props:_props.default,emits:_emits.default,setup(H,l){const{slots:P,emit:r}=l,se=_xeUtils.default.uniqueId(),de=_ui.VxeUI.getComponent("VxeLoading"),j=_ui.VxeUI.getComponent("VxeTooltip"),a=(0,_vue.inject)("$xeTabs",null),ce=useFns.useSize(H)["computeSize"],W=(0,_vue.reactive)({isCalcColumn:!1,staticColumns:[],tableGroupColumn:[],tableColumn:[],tableData:[],scrollXLoad:!1,scrollYLoad:!1,overflowY:!0,overflowX:!1,scrollbarWidth:0,scrollbarHeight:0,lastScrollTime:0,rowHeight:0,parentHeight:0,isGroup:!1,isAllOverflow:!1,isAllSelected:!1,isIndeterminate:!1,selectCheckboxMaps:{},currentRow:null,currentColumn:null,selectRadioRow:null,footerTableData:[],expandColumn:null,treeNodeColumn:null,hasFixedColumn:!1,rowExpandedMaps:{},rowExpandLazyLoadedMaps:{},treeExpandedMaps:{},treeExpandLazyLoadedMaps:{},treeIndeterminateMaps:{},mergeList:[],mergeFooterList:[],upDataFlag:0,reColumnFlag:0,pendingRowMaps:{},pendingRowList:[],initStore:{filter:!1,import:!1,export:!1,custom:!1},customStore:{btnEl:null,isAll:!1,isIndeterminate:!1,activeBtn:!1,activeWrapper:!1,visible:!1,maxHeight:0,oldSortMaps:{},oldFixedMaps:{},oldVisibleMaps:{}},customColumnList:[],filterStore:{isAllSelected:!1,isIndeterminate:!1,style:null,options:[],column:null,multiple:!1,visible:!1,maxHeight:null},columnStore:{leftList:[],centerList:[],rightList:[],resizeList:[],pxList:[],pxMinList:[],autoMinList:[],scaleList:[],scaleMinList:[],autoList:[],remainList:[]},ctxMenuStore:{selected:null,visible:!1,showChild:!1,selectChild:null,list:[],style:null},editStore:{indexs:{columns:[]},titles:{columns:[]},selected:{row:null,column:null},copyed:{cut:!1,rows:[],columns:[]},actived:{row:null,column:null},focused:{row:null,column:null},insertMaps:{},removeMaps:{}},tooltipStore:{row:null,column:null,content:null,visible:!1,currOpts:{}},validStore:{visible:!1},validErrorMaps:{},importStore:{inited:!1,file:null,type:"",modeList:[],typeList:[],filename:"",visible:!1},importParams:{mode:"",types:null,message:!0},exportStore:{inited:!1,name:"",modeList:[],typeList:[],columns:[],isPrint:!1,hasFooter:!1,hasMerge:!1,hasTree:!1,hasColgroup:!1,visible:!1},exportParams:{filename:"",sheetName:"",mode:"",type:"",isColgroup:!1,isMerge:!1,isAllExpand:!1,useStyle:!1,original:!1,message:!0,isHeader:!1,isFooter:!1},scrollVMLoading:!1,_isResize:!1,_isLoading:!1}),K={tZindex:0,elemStore:{},scrollXStore:{offsetSize:0,visibleSize:0,startIndex:0,endIndex:0},scrollYStore:{rowHeight:0,offsetSize:0,visibleSize:0,startIndex:0,endIndex:0},tableWidth:0,tableHeight:0,headerHeight:0,footerHeight:0,customHeight:0,customMinHeight:0,customMaxHeight:0,hoverRow:null,lastScrollLeft:0,lastScrollTop:0,radioReserveRow:null,checkboxReserveRowMap:{},rowExpandedReserveRowMap:{},treeExpandedReserveRowMap:{},treeIndeterminateRowMaps:{},tableFullData:[],afterFullData:[],afterTreeFullData:[],afterFullRowMaps:{},tableFullTreeData:[],tableSynchData:[],tableSourceData:[],collectColumn:[],tableFullColumn:[],visibleColumn:[],fullAllDataRowIdData:{},sourceDataRowIdData:{},fullDataRowIdData:{},fullColumnIdData:{},fullColumnFieldData:{},inited:!1,tooltipTimeout:null,initStatus:!1,isActivated:!1};let B={},Y={};const X=(0,_vue.ref)(),G=(0,_vue.ref)(),ve=(0,_vue.ref)(),ge=(0,_vue.ref)(),fe=(0,_vue.ref)(),he=(0,_vue.ref)(),me=(0,_vue.ref)(),Z=(0,_vue.ref)(),J=(0,_vue.ref)(),Q=(0,_vue.ref)(),s=(0,_vue.ref)(),v=(0,_vue.ref)(),g=(0,_vue.ref)(),f=(0,_vue.ref)(),d=(0,_vue.ref)(),p=(0,_vue.ref)(),$=(0,_vue.ref)(),z=(0,_vue.ref)(),pe=(0,_vue.ref)(),xe=(0,_vue.ref)(),ee=(0,_vue.inject)("$xeGrid",null);let m;const u=(0,_vue.computed)(()=>{var e=H["id"];return e?_xeUtils.default.isFunction(e)?""+(e({$table:ue,$grid:ee})||""):""+e:""}),_e=(0,_vue.computed)(()=>Object.assign({},getConfig().table.validConfig,H.validConfig)),y=(0,_vue.computed)(()=>Object.assign({},getConfig().table.scrollX,H.scrollX)),_=(0,_vue.computed)(()=>Object.assign({},getConfig().table.scrollY,H.scrollY)),i=(0,_vue.computed)(()=>({default:48,medium:44,small:40,mini:36})),te=(0,_vue.computed)(()=>Object.assign({},getConfig().table.columnConfig,H.columnConfig)),le=(0,_vue.computed)(()=>Object.assign({},getConfig().table.rowConfig,H.rowConfig)),x=(0,_vue.computed)(()=>Object.assign({},getConfig().table.resizeConfig,H.resizeConfig));var e=(0,_vue.computed)(()=>Object.assign({},getConfig().table.resizableConfig,H.resizableConfig)),t=(0,_vue.computed)(()=>Object.assign({startIndex:0},getConfig().table.seqConfig,H.seqConfig));const R=(0,_vue.computed)(()=>Object.assign({},getConfig().table.radioConfig,H.radioConfig)),re=(0,_vue.computed)(()=>Object.assign({},getConfig().table.checkboxConfig,H.checkboxConfig));(0,_vue.ref)();let c;c=(0,_vue.computed)(()=>Object.assign({},getConfig().tooltip,getConfig().table.tooltipConfig,H.tooltipConfig));const we=(0,_vue.computed)(()=>{var e=c.value;return Object.assign({},e)}),Ce=(0,_vue.computed)(()=>{var e=c.value;return Object.assign({isArrow:!1},e)}),oe=(0,_vue.computed)(()=>Object.assign({},getConfig().table.editConfig,H.editConfig)),w=(0,_vue.computed)(()=>Object.assign({orders:["asc","desc",null]},getConfig().table.sortConfig,H.sortConfig)),S=(0,_vue.computed)(()=>Object.assign({},getConfig().table.filterConfig,H.filterConfig)),ae=(0,_vue.computed)(()=>Object.assign({},getConfig().table.mouseConfig,H.mouseConfig)),D=(0,_vue.computed)(()=>Object.assign({},getConfig().table.areaConfig,H.areaConfig)),ie=(0,_vue.computed)(()=>Object.assign({},getConfig().table.keyboardConfig,H.keyboardConfig));var M=(0,_vue.computed)(()=>Object.assign({},getConfig().table.clipConfig,H.clipConfig)),L=(0,_vue.computed)(()=>Object.assign({},getConfig().table.fnrConfig,H.fnrConfig));const o=(0,_vue.computed)(()=>Object.assign({},getConfig().table.menuConfig,H.menuConfig)),k=(0,_vue.computed)(()=>{var e=o.value.header;return e&&e.options?e.options:[]}),be=(0,_vue.computed)(()=>{var e=o.value.body;return e&&e.options?e.options:[]}),I=(0,_vue.computed)(()=>{var e=o.value.footer;return e&&e.options?e.options:[]}),Ee=(0,_vue.computed)(()=>{var e=o.value,t=k.value,l=be.value,r=I.value;return!!(H.menuConfig&&(0,_utils.isEnableConf)(e)&&(t.length||l.length||r.length))}),Re=(0,_vue.computed)(()=>{var e=W["ctxMenuStore"];const t=[];return e.list.forEach(e=>{e.forEach(e=>{t.push(e)})}),t}),F=(0,_vue.computed)(()=>Object.assign({},getConfig().table.exportConfig,H.exportConfig)),U=(0,_vue.computed)(()=>Object.assign({},getConfig().table.importConfig,H.importConfig));var O=(0,_vue.computed)(()=>Object.assign({},getConfig().table.printConfig,H.printConfig));const T=(0,_vue.computed)(()=>Object.assign({},getConfig().table.expandConfig,H.expandConfig)),ne=(0,_vue.computed)(()=>Object.assign({},getConfig().table.treeConfig,H.treeConfig)),Te=(0,_vue.computed)(()=>Object.assign({},getConfig().table.emptyRender,H.emptyRender)),ye=(0,_vue.computed)(()=>Object.assign({},getConfig().table.loadingConfig,H.loadingConfig)),Se=(0,_vue.computed)(()=>H.border?Math.max(2,Math.ceil(W.scrollbarWidth/W.tableColumn.length)):1),h=(0,_vue.computed)(()=>Object.assign({},getConfig().table.customConfig,H.customConfig)),A=(0,_vue.computed)(()=>{var e=K["visibleColumn"],t=W["tableColumn"];return t.length||e.length?e.filter(e=>"auto"===e.width||"auto"===e.minWidth):[]}),N=(0,_vue.computed)(()=>{var e=K["collectColumn"];let t=0;return e.forEach(e=>{e.renderFixed&&t++}),t}),V=(0,_vue.computed)(()=>{var e=N.value,t=te.value["maxFixedSize"];return!!t&&t<=e}),De=(0,_vue.computed)(()=>{var e=H["border"];return!0===e?"full":e||"default"});var q=(0,_vue.computed)(()=>{var{}=H,e=W["tableData"],t=K["tableFullData"];const{strict:l,checkMethod:r}=re.value;return!!l&&(!e.length&&!t.length||!!r&&t.every(e=>!r({row:e})))});const Me={refElem:X,refTooltip:G,refValidTooltip:ge,refTableFilter:he,refTableCustom:me,refTableMenu:fe,refTableHeader:Z,refTableBody:J,refTableFooter:Q,refTableLeftHeader:s,refTableLeftBody:v,refTableLeftFooter:g,refTableRightHeader:f,refTableRightBody:d,refTableRightFooter:p,refLeftContainer:$,refRightContainer:z,refCellResizeBar:pe},Le={computeSize:ce,computeTableId:u,computeValidOpts:_e,computeSXOpts:y,computeSYOpts:_,computeColumnOpts:te,computeRowOpts:le,computeResizeleOpts:x,computeResizableOpts:e,computeSeqOpts:t,computeRadioOpts:R,computeCheckboxOpts:re,computeTooltipOpts:c,computeEditOpts:oe,computeSortOpts:w,computeFilterOpts:S,computeMouseOpts:ae,computeAreaOpts:D,computeKeyboardOpts:ie,computeClipOpts:M,computeFNROpts:L,computeHeaderMenu:k,computeBodyMenu:be,computeFooterMenu:I,computeIsMenu:Ee,computeMenuOpts:o,computeExportOpts:F,computeImportOpts:U,computePrintOpts:O,computeExpandOpts:T,computeTreeOpts:ne,computeEmptyOpts:Te,computeLoadingOpts:ye,computeCustomOpts:h,computeFixedColumnSize:N,computeIsMaxFixedColumn:V,computeIsAllCheckboxDisabled:q},ue={xID:se,props:H,context:l,reactData:W,internalData:K,getRefMaps:()=>Me,getComputeMaps:()=>Le,xegrid:ee},ke=(e,t,l)=>{e=_xeUtils.default.get(e,l),t=_xeUtils.default.get(t,l);return!(!(0,_utils.eqEmptyValue)(e)||!(0,_utils.eqEmptyValue)(t))||(_xeUtils.default.isString(e)||_xeUtils.default.isNumber(e)?""+e==""+t:_xeUtils.default.isEqual(e,t))},Ie=e=>{var t=w.value["orders"],e=e.order||null,e=t.indexOf(e)+1;return t[e<t.length?e:0]},Fe=e=>{var t=getConfig().version,l=_xeUtils.default.toStringJSON(localStorage.getItem(customStorageKey)||""),l=l&&l._v===t?l:{_v:t};return(e?l[e]:l)||{}},Ue=e=>{const l=K["fullAllDataRowIdData"],r={};return _xeUtils.default.each(e,(e,t)=>{l[t]&&(r[t]=e)}),r},Oe=e=>{const l=K["fullDataRowIdData"],r=[];return _xeUtils.default.each(e,(e,t)=>{l[t]&&-1===ue.findRowIndexOf(r,l[t].row)&&r.push(l[t].row)}),r},Ae=()=>{var a=K["visibleColumn"],e=J.value,e=e?e.$el:null;if(e){var{scrollLeft:i,clientWidth:e}=e,n=i+e;let l=-1,r=0,o=0;for(let e=0,t=a.length;e<t&&(r+=a[e].renderWidth,!(0<=(l=-1===l&&i<r?e:l)&&(o++,r>n)));e++);return{toVisibleIndex:Math.max(0,l),visibleSize:Math.max(8,o)}}return{toVisibleIndex:0,visibleSize:8}},Ne=()=>{var l=Z.value,r=J.value,r=r?r.$el:null,o=ce.value,a=i.value;if(r){l=l?l.$el:null;let e=0,t;!(t=r.querySelector("tr"))&&l&&(t=l.querySelector("tr")),e=(e=t?t.clientHeight:e)||a[o||"default"];l=Math.max(8,Math.ceil(r.clientHeight/e)+2);return{rowHeight:e,visibleSize:l}}return{rowHeight:0,visibleSize:8}},Ve=(l,r,o)=>{for(let e=0,t=l.length;e<t;e++){var a=l[e],{startIndex:i,endIndex:n}=r,u=a[o],a=u+a[o+"span"];u<i&&i<a&&(r.startIndex=u),u<n&&n<a&&(r.endIndex=a),r.startIndex===i&&r.endIndex===n||(e=-1)}},qe=(e,i,n)=>{if(e){var t=H["treeConfig"];const u=K["visibleColumn"];_xeUtils.default.isArray(e)||(e=[e]),t&&e.length&&(0,_log.errLog)("vxe.error.noTree",["merge-cells | merge-footer-items"]),e.forEach(e=>{let{row:t,col:l,rowspan:r,colspan:o}=e;var a;n&&_xeUtils.default.isNumber(t)&&(t=n[t]),_xeUtils.default.isNumber(l)&&(l=u[l]),(n?t:_xeUtils.default.isNumber(t))&&l&&(r||o)&&(r=_xeUtils.default.toNumber(r)||1,o=_xeUtils.default.toNumber(o)||1,1<r||1<o)&&(e=_xeUtils.default.findIndexOf(i,e=>!(e._row!==t&&(0,_util.getRowid)(ue,e._row)!==(0,_util.getRowid)(ue,t)||e._col.id!==l&&e._col.id!==l.id)),(e=i[e])?(e.rowspan=r,e.colspan=o,e._rowspan=r,e._colspan=o):(e=n?ue.findRowIndexOf(n,t):t,a=B.getVTColumnIndex(l),i.push({row:e,col:a,rowspan:r,colspan:o,_row:t,_col:l,_rowspan:r,_colspan:o})))})}},$e=(e,r,o)=>{const a=[];if(e){var t=H["treeConfig"];const i=K["visibleColumn"];_xeUtils.default.isArray(e)||(e=[e]),t&&e.length&&(0,_log.errLog)("vxe.error.noTree",["merge-cells | merge-footer-items"]),e.forEach(e=>{let{row:t,col:l}=e;o&&_xeUtils.default.isNumber(t)&&(t=o[t]),_xeUtils.default.isNumber(l)&&(l=i[l]);var e=_xeUtils.default.findIndexOf(r,e=>!(e._row!==t&&(0,_util.getRowid)(ue,e._row)!==(0,_util.getRowid)(ue,t)||e._col.id!==l&&e._col.id!==l.id));-1<e&&(e=r.splice(e,1),a.push(e[0]))})}return a},ze=()=>{var e=K["tableFullColumn"];e.forEach(e=>{e.order=null})},Pe=e=>{var t,l=W["parentHeight"],e=H[e];let r=0;return r=e?"100%"===e||"auto"===e?l:(t=ue.getExcludeHeight(),r=(0,_dom.isScale)(e)?Math.floor((_xeUtils.default.toInteger(e)||1)/100*l):_xeUtils.default.toNumber(e),Math.max(40,r-t)):r},He=e=>{var t=K["collectColumn"];const{resizableData:i,sortData:n,visibleData:u,fixedData:s}=e;let d=!1;(i||n||u||s)&&(_xeUtils.default.eachTree(t,(e,t,l,r,o)=>{var a=e.getKey();o||(s&&s[a]&&(e.fixed=s[a]),n&&_xeUtils.default.isNumber(n[a])&&(d=!0,e.renderSortNumber=n[a])),i&&_xeUtils.default.isNumber(i[a])&&(e.resizeWidth=i[a]),u&&_xeUtils.default.isBoolean(u[a])&&(e.visible=u[a])}),d)&&(t=_xeUtils.default.orderBy(t,"renderSortNumber"),K.collectColumn=t,K.tableFullColumn=st(t))},je=()=>{var{tableFullColumn:e,collectColumn:t}=K;const d=K.fullColumnIdData={},c=K.fullColumnFieldData={};var l=ae.value,r=te.value,o=le.value,a=t.some(_utils.hasChildrenList);let v=!!H.showOverflow,g,f,h,m,p,x;const i=(e,t,l,r,o)=>{var{id:a,field:i,fixed:n,type:u,treeNode:s}=e,t={column:e,colid:a,index:t,items:l,parent:o};i&&("development"===process.env.NODE_ENV&&c[i]&&(0,_log.warnLog)("vxe.error.colRepet",["field",i]),c[i]=t),!x&&n&&(x=n),p||"html"!==u||(p=e),s?("development"===process.env.NODE_ENV&&f&&(0,_log.warnLog)("vxe.error.colRepet",["tree-node",s]),f=f||e):"expand"===u&&("development"===process.env.NODE_ENV&&g&&(0,_log.warnLog)("vxe.error.colRepet",["type",u]),g=g||e),"development"===process.env.NODE_ENV&&("checkbox"===u?(h&&(0,_log.warnLog)("vxe.error.colRepet",["type",u]),h=h||e):"radio"===u&&(m&&(0,_log.warnLog)("vxe.error.colRepet",["type",u]),m=m||e)),v&&!1===e.showOverflow&&(v=!1),d[a]&&(0,_log.errLog)("vxe.error.colRepet",["colId",a]),d[a]=t};a?_xeUtils.default.eachTree(t,(e,t,l,r,o,a)=>{e.level=a.length,i(e,t,l,0,o)}):e.forEach(i),"development"===process.env.NODE_ENV&&g&&l.area&&(0,_log.errLog)("vxe.error.errConflicts",["mouse-config.area","column.type=expand"]),"development"===process.env.NODE_ENV&&p&&(r.useKey||(0,_log.errLog)("vxe.error.reqProp",["column-config.useKey","column.type=html"]),o.useKey||(0,_log.errLog)("vxe.error.reqProp",["row-config.useKey","column.type=html"])),W.isGroup=a,W.treeNodeColumn=f,W.expandColumn=g,W.isAllOverflow=v},We=()=>{K.customHeight=Pe("height"),K.customMinHeight=Pe("minHeight"),K.customMaxHeight=Pe("maxHeight")},Ke=()=>{var n=Z.value,u=J.value,s=Q.value;const d=u?u.$el:null,c=n?n.$el:null;u=s?s.$el:null;if(d){let l=0;n=d.clientWidth-1,s=n;let r=s/100;var v=H["fit"],g=W["columnStore"],{resizeList:g,pxMinList:f,autoMinList:h,pxList:m,scaleList:p,scaleMinList:x,autoList:_,remainList:w}=g;if(f.forEach(e=>{var t=_xeUtils.default.toInteger(e.minWidth);l+=t,e.renderWidth=t}),h.forEach(e=>{var t=Math.max(60,_xeUtils.default.toInteger(e.renderAutoWidth));l+=t,e.renderWidth=t}),x.forEach(e=>{var t=Math.floor(_xeUtils.default.toInteger(e.minWidth)*r);l+=t,e.renderWidth=t}),p.forEach(e=>{var t=Math.floor(_xeUtils.default.toInteger(e.width)*r);l+=t,e.renderWidth=t}),m.forEach(e=>{var t=_xeUtils.default.toInteger(e.width);l+=t,e.renderWidth=t}),_.forEach(e=>{var t=Math.max(60,_xeUtils.default.toInteger(e.renderAutoWidth));l+=t,e.renderWidth=t}),g.forEach(e=>{var t=_xeUtils.default.toInteger(e.resizeWidth);l+=t,e.renderWidth=t}),s-=l,r=0<s?Math.floor(s/(x.length+f.length+h.length+w.length)):0,v?0<s&&x.concat(f).concat(h).forEach(e=>{l+=r,e.renderWidth+=r}):r=40,w.forEach(e=>{var t=Math.max(r,40);e.renderWidth=t,l+=t}),v){var C=p.concat(x).concat(f).concat(h).concat(w);let t=C.length-1;if(0<t){let e=n-l;if(0<e){for(;0<e&&0<=t;)e--,C[t--].renderWidth++;l=n}}}m=d.offsetHeight,_=d.scrollHeight>d.clientHeight;let e=0,t=(_&&(e=Math.max(d.offsetWidth-d.clientWidth,0)),W.scrollbarWidth=e,W.overflowY=_,K.tableWidth=l,K.tableHeight=m,0),o=(c&&(t=c.clientHeight,(0,_vue.nextTick)(()=>{c&&d&&c.scrollLeft!==d.scrollLeft&&(c.scrollLeft=d.scrollLeft)})),K.headerHeight=t,!1),a=0,i=0;i=u?(a=u.offsetHeight,o=l>u.clientWidth,Math.max(a-u.clientHeight,0)):(o=l>n,Math.max(m-d.clientHeight,0)),K.footerHeight=a,W.overflowX=o,W.scrollbarHeight=i,We(),W.parentHeight=Math.max(K.headerHeight+a+20,Y.getParentHeight()),o&&Y.checkScrolling()}},Be=l=>{const{sortBy:r,sortType:o}=l;return e=>{let t;return t=r?_xeUtils.default.isFunction(r)?r({row:e,column:l}):_xeUtils.default.get(e,r):B.getCellLabel(e,l),o&&"auto"!==o?"number"===o?_xeUtils.default.toNumber(t):"string"===o?_xeUtils.default.toValueString(t):t:isNaN(t)?t:_xeUtils.default.toNumber(t)}},Ye=()=>{var e=H["treeConfig"];const{afterFullData:t,fullDataRowIdData:i,fullAllDataRowIdData:n}=K;var l=K["afterTreeFullData"],r=ne.value,o=r.children||r.childrenField;const u={};e?_xeUtils.default.eachTree(l,(e,t,l,r)=>{var o=(0,_util.getRowid)(ue,e),a=n[o],r=r.map((e,t)=>t%2==0?Number(e)+1:".").join("");a?(a.seq=r,a._index=t):(a={row:e,rowid:o,seq:r,index:-1,$index:-1,_index:t,items:[],parent:null,level:0},n[o]=a,i[o]=a),u[o]=e},{children:r.transform?r.mapChildrenField:o}):t.forEach((e,t)=>{var l=(0,_util.getRowid)(ue,e),r=n[l],o=t+1;r?(r.seq=o,r._index=t):(r={row:e,rowid:l,seq:o,index:-1,$index:-1,_index:t,items:[],parent:null,level:0},n[l]=r,i[l]=r),u[l]=e}),K.afterFullRowMaps=u},n=()=>{var e=H["treeConfig"];const n=W["treeExpandedMaps"];var t=ne.value;if(e&&t.transform){const u=[],s={};return _xeUtils.default.eachTree(K.afterTreeFullData,(e,t,l,r,o)=>{var a=(0,_util.getRowid)(ue,e),i=(0,_util.getRowid)(ue,o);(!o||s[i]&&n[i])&&(s[a]=1,u.push(e))},{children:t.mapChildrenField}),K.afterFullData=u,vt(u),u}return K.afterFullData},C=()=>{const{border:c,showFooter:v,showOverflow:g,showHeaderOverflow:f,showFooterOverflow:h,mouseConfig:e,spanMethod:m,footerSpanMethod:p,keyboardConfig:x}=H,{isGroup:_,currentRow:t,tableColumn:w,scrollXLoad:C,scrollYLoad:b,scrollbarWidth:E,scrollbarHeight:R,columnStore:l,editStore:r,mergeList:T,mergeFooterList:y,isAllOverflow:S}=W;let{visibleColumn:D,fullColumnIdData:M,tableHeight:L,tableWidth:k,headerHeight:I,footerHeight:F,elemStore:U,customHeight:O,customMinHeight:A,customMaxHeight:N}=K;var o=xe.value;const V=Se.value;var a=ae.value;const q=ie.value;var i=U["main-body-wrapper"],i=i?i.value:null;return o&&(o.style.top=I+"px",o.style.height=i?i.offsetHeight-R+"px":""),0<O&&v&&(O+=R),["main","left","right"].forEach((u,e)=>{const a=0<e?u:"";const i="left"===a;let s=[],d;a&&(s=i?l.leftList:l.rightList,d=(i?$:z).value),["header","body","footer"].forEach(n=>{var l=U[u+`-${n}-wrapper`],l=l?l.value:null,t=U[u+`-${n}-table`],t=t?t.value:null;if("header"===n){k;let e=w;_?e=D:a&&(C||f)&&(e=s),r=e.reduce((e,t)=>e+t.renderWidth,0),t&&(t.style.width=r?r+E+"px":"");var r=U[u+`-${n}-repair`],r=r?r.value:null,r=(r&&(r.style.width=k+"px"),U[u+`-${n}-list`]),r=r?r.value:null;_&&r&&_xeUtils.default.arrayEach(r.querySelectorAll(".col--group"),e=>{var r=B.getColumnNode(e);if(r){const o=r.item;r=o["showHeaderOverflow"],r=_xeUtils.default.isBoolean(r)?r:f,r="title"===r||(!0===r||"tooltip"===r)||"ellipsis"===r;let t=0,l=0;r&&_xeUtils.default.eachTree(o.children,e=>{e.children&&o.children.length||l++,t+=e.renderWidth},{children:"children"}),e.style.width=r?t-l-(c?2:0)+"px":""}})}else if("body"===n){r=U[u+`-${n}-emptyBlock`],r=r?r.value:null;if((0,_dom.isNodeElement)(l)){let t=0;var o=A-I-F;if(N&&(t=N-I-F,a&&(t-=v?0:R),t=Math.max(o,t),l.style.maxHeight=t+"px"),O){let e=O-I-F;a&&(e-=v?0:R),t&&(e=Math.min(t,e)),l.style.height=Math.max(o,e)+"px"}else l.style.height="";l.style.minHeight=o+"px"}d&&((0,_dom.isNodeElement)(l)&&(l.style.top=I+"px"),d.style.height=(0<O?O-I-F:L)+I+F-R*(v?2:1)+"px",d.style.width=s.reduce((e,t)=>e+t.renderWidth,i?0:E)+"px");k;let e=w;o=(e=a?W.expandColumn||!(b||g&&S)||T.length||m||x&&q.isMerge?D:s:e).reduce((e,t)=>e+t.renderWidth,0),t&&(t.style.width=o?o+"px":"",t.style.paddingRight=E&&a&&(_dom.browse["-moz"]||_dom.browse.safari)?E+"px":""),r&&(r.style.width=o?o+"px":"")}else if("footer"===n){k;let e=w;r=(e=a?W.expandColumn||!C&&!h||y.length&&p?D:s:e).reduce((e,t)=>e+t.renderWidth,0),(0,_dom.isNodeElement)(l)&&(d&&(l.style.top=`${0<O?O-F:L+I}px`),l.style.marginTop=-Math.max(1,R)+"px"),t&&(t.style.width=r?r+E+"px":"")}o=U[u+`-${n}-colgroup`],l=o?o.value:null;l&&_xeUtils.default.arrayEach(l.children,t=>{var l=t.getAttribute("name");if("col_gutter"===l&&(t.style.width=E+"px"),M[l]){const i=M[l].column;var{showHeaderOverflow:l,showFooterOverflow:r,showOverflow:o}=i;let e;t.style.width=i.renderWidth+"px";t="ellipsis"===(e="header"===n?_xeUtils.default.isUndefined(l)||_xeUtils.default.isNull(l)?f:l:"footer"===n?_xeUtils.default.isUndefined(r)||_xeUtils.default.isNull(r)?h:r:_xeUtils.default.isUndefined(o)||_xeUtils.default.isNull(o)?g:o),l="title"===e,r=!0===e||"tooltip"===e;let a=l||r||t;o=U[u+`-${n}-list`],l=o?o.value:null;b&&!a&&(a=!0),l&&_xeUtils.default.arrayEach(l.querySelectorAll("."+i.id),e=>{var t=parseInt(e.getAttribute("colspan")||1),e=e.querySelector(".vxe-cell");let l=i.renderWidth;if(e){if(1<t){var r=B.getColumnIndex(i);for(let e=1;e<t;e++){var o=B.getColumns(r+e);o&&(l+=o.renderWidth)}}e.style.width=a?l-V*t+"px":""}})}})})}),t&&B.setCurrentRow(t),e&&a.selected&&r.selected.row&&r.selected.column&&ue.addCellSelectedClass(),(0,_vue.nextTick)()},Xe=e=>ue.triggerValidate?ue.triggerValidate(e):(0,_vue.nextTick)(),Ge=(e,t)=>{Xe("blur").catch(e=>e).then(()=>{ue.handleActived(t,e).then(()=>Xe("change")).catch(e=>e)})},b=(e,t)=>{var l,r=K["checkboxReserveRowMap"];re.value.reserve&&(l=(0,_util.getRowid)(ue,e),t?r[l]=e:r[l]&&delete r[l])},Ze=(e,t)=>{var l=R.value["checkMethod"];return e&&(t||!l||l({row:e}))&&(W.selectRadioRow=e,t=e,R.value.reserve)&&(K.radioReserveRow=t),(0,_vue.nextTick)()},E=(e,t,l)=>((e=e&&!_xeUtils.default.isArray(e)?[e]:e).forEach(e=>Y.handleSelectRow({row:e},!!t,l)),(0,_vue.nextTick)()),Je=(t,l)=>{const r=H["treeConfig"],o=W["selectCheckboxMaps"],{afterFullData:e,afterFullRowMaps:a,checkboxReserveRowMap:i}=K;var n=ne.value,n=n.children||n.childrenField,u=re.value;const{checkField:s,reserve:d,checkStrictly:c,checkMethod:v}=u,g=u.indeterminateField||u.halfField,f={};return r||_xeUtils.default.each(o,(e,t)=>{a[t]||(f[t]=e)}),c?W.isAllSelected=t:(s?(u=e=>{!l&&v&&!v({row:e})||(t&&(f[(0,_util.getRowid)(ue,e)]=e),_xeUtils.default.set(e,s,t)),r&&g&&_xeUtils.default.set(e,g,!1)},r?_xeUtils.default.eachTree(e,u,{children:n}):e.forEach(u)):r?t?_xeUtils.default.eachTree(e,e=>{!l&&v&&!v({row:e})||(f[(0,_util.getRowid)(ue,e)]=e)},{children:n}):!l&&v&&_xeUtils.default.eachTree(e,e=>{var t=(0,_util.getRowid)(ue,e);!v({row:e})&&o[t]&&(f[t]=e)},{children:n}):t?!l&&v?e.forEach(e=>{var t=(0,_util.getRowid)(ue,e);(o[t]||v({row:e}))&&(f[t]=e)}):e.forEach(e=>{f[(0,_util.getRowid)(ue,e)]=e}):!l&&v&&e.forEach(e=>{var t=(0,_util.getRowid)(ue,e);!v({row:e})&&o[t]&&(f[t]=e)}),d&&(t?_xeUtils.default.each(f,(e,t)=>{i[t]=e}):e.forEach(e=>b(e,!1))),W.selectCheckboxMaps=s?{}:f),W.treeIndeterminateMaps={},K.treeIndeterminateRowMaps={},Y.checkSelectionStatus(),(0,_vue.nextTick)()},Qe=a=>{var e=ne.value,t=re.value;const{transform:i,loadMethod:n}=e,u=t["checkStrictly"];return new Promise(e=>{if(n){const l=W["treeExpandLazyLoadedMaps"];var t=K["fullAllDataRowIdData"];const r=(0,_util.getRowid)(ue,a),o=t[r];l[r]=a,Promise.resolve(n({$table:ue,row:a})).then(e=>{if(o.treeLoaded=!0,l[r]&&delete l[r],e=_xeUtils.default.isArray(e)?e:[])return B.loadTreeChildren(a,e).then(e=>{var t=W["treeExpandedMaps"];return e.length&&!t[r]&&(t[r]=a),!u&&B.isCheckedByCheckboxRow(a)&&E(e,!0),(0,_vue.nextTick)().then(()=>{if(i)return Y.handleTableData()})})}).catch(()=>{var e=W["treeExpandLazyLoadedMaps"];o.treeLoaded=!1,e[r]&&delete e[r]}).finally(()=>{(0,_vue.nextTick)().then(()=>B.recalculate()).then(()=>e())})}else e()})},et=(e,t)=>{var l,r=K["treeExpandedReserveRowMap"];ne.value.reserve&&(l=(0,_util.getRowid)(ue,e),t?r[l]=e:r[l]&&delete r[l])},tt=i=>new Promise(t=>{var e=T.value["loadMethod"];if(e){var l=K["fullAllDataRowIdData"],r=W["rowExpandLazyLoadedMaps"];const o=(0,_util.getRowid)(ue,i),a=l[o];r[o]=i,e({$table:ue,row:i,rowIndex:B.getRowIndex(i),$rowIndex:B.getVMRowIndex(i)}).then(()=>{var e=W["rowExpandedMaps"];a.expandLoaded=!0,e[o]=i}).catch(()=>{a.expandLoaded=!1}).finally(()=>{var e=W["rowExpandLazyLoadedMaps"];e[o]&&delete e[o],(0,_vue.nextTick)().then(()=>B.recalculate()).then(()=>t())})}else t()}),lt=(e,t)=>{var l,r=K["rowExpandedReserveRowMap"];T.value.reserve&&(l=(0,_util.getRowid)(ue,e),t?r[l]=e:r[l]&&delete r[l])},rt=()=>(0,_vue.nextTick)().then(()=>{var{scrollXLoad:e,scrollYLoad:t}=W,{scrollXStore:l,scrollYStore:r}=K,o=_.value,a=y.value,{rowHeight:e,visibleSize:a}=(e?(e=Ae()["visibleSize"],a=a.oSize?_xeUtils.default.toNumber(a.oSize):_dom.browse.edge?5:0,l.offsetSize=a,l.visibleSize=e,l.endIndex=Math.max(l.startIndex+l.visibleSize+a,l.endIndex),Y.updateScrollXData()):Y.updateScrollXSpace(),Ne());r.rowHeight=e,t?(l=o.oSize?_xeUtils.default.toNumber(o.oSize):_dom.browse.edge?10:0,r.offsetSize=l,r.visibleSize=a,r.endIndex=Math.max(r.startIndex+a+l,r.endIndex),Y.updateScrollYData()):Y.updateScrollYSpace(),W.rowHeight=e,(0,_vue.nextTick)(C)}),ot=e=>{var{keepSource:t,treeConfig:l}=H;const{editStore:r,scrollYLoad:f}=W,{scrollYStore:h,scrollXStore:o,lastScrollLeft:m,lastScrollTop:p}=K;var a=ne.value,i=a["transform"],n=a.children||a.childrenField;let u=[],s=(0,_vue.reactive)(e?e.slice(0):[]);l&&(i?("development"===process.env.NODE_ENV&&(a.rowField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.rowField"]),a.parentField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.parentField"]),n||(0,_log.errLog)("vxe.error.reqProp",["tree-config.childrenField"]),a.mapChildrenField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.mapChildrenField"]),n===a.mapChildrenField)&&(0,_log.errLog)("vxe.error.errConflicts",["tree-config.childrenField","tree-config.mapChildrenField"]),u=_xeUtils.default.toArrayTree(s,{key:a.rowField,parentKey:a.parentField,children:n,mapChildren:a.mapChildrenField}),s=u.slice(0)):u=s.slice(0)),h.startIndex=0,h.endIndex=1,o.startIndex=0,o.endIndex=1,W.scrollVMLoading=!1,r.insertMaps={},r.removeMaps={};const x=vt(s);return W.scrollYLoad=x,K.tableFullData=s,K.tableFullTreeData=u,Y.cacheRowMap(!0),K.tableSynchData=e,t&&Y.cacheSourceMap(s),"development"===process.env.NODE_ENV&&x&&(H.height||H.maxHeight||(0,_log.errLog)("vxe.error.reqProp",["table.height | table.max-height | table.scroll-y={enabled: false}"]),H.showOverflow||(0,_log.warnLog)("vxe.error.reqProp",["table.show-overflow"]),H.spanMethod)&&(0,_log.warnLog)("vxe.error.scrollErrProp",["table.span-method"]),ue.clearCellAreas&&H.mouseConfig&&(ue.clearCellAreas(),ue.clearCopyCellArea()),B.clearMergeCells(),B.clearMergeFooterItems(),Y.handleTableData(!0),B.updateFooter(),(0,_vue.nextTick)().then(()=>{We(),C()}).then(()=>{rt()}).then(()=>{x&&(h.endIndex=h.visibleSize);var e=H["treeConfig"],{expandColumn:t,currentRow:l,selectCheckboxMaps:r,selectRadioRow:o,rowExpandedMaps:a,treeExpandedMaps:i}=W,{fullDataRowIdData:n,fullAllDataRowIdData:u,radioReserveRow:s}=K,d=T.value,c=ne.value,v=R.value,g=re.value;return o&&!u[(0,_util.getRowid)(ue,o)]&&(W.selectRadioRow=null),v.reserve&&s&&n[o=(0,_util.getRowid)(ue,s)]&&Ze(n[o].row,!0),W.selectCheckboxMaps=Ue(r),g.reserve&&E(Oe(K.checkboxReserveRowMap),!0,!0),l&&!u[(0,_util.getRowid)(ue,l)]&&(W.currentRow=null),W.rowExpandedMaps=t?Ue(a):{},t&&d.reserve&&B.setRowExpand(Oe(K.rowExpandedReserveRowMap),!0),W.treeExpandedMaps=e?Ue(i):{},e&&c.reserve&&B.setTreeExpand(Oe(K.treeExpandedReserveRowMap),!0),Y.checkSelectionStatus(),new Promise(o=>{(0,_vue.nextTick)().then(()=>B.recalculate()).then(()=>{let e=m,t=p;var l=y.value,r=_.value;l.scrollToLeftOnChange&&(e=0),r.scrollToTopOnChange&&(t=0),f===x?(0,_util.restoreScrollLocation)(ue,e,t).then(o):setTimeout(()=>(0,_util.restoreScrollLocation)(ue,e,t).then(o))})})})},at=()=>{if(e=H["checkboxConfig"]){const a=K["fullDataRowIdData"];var{checkAll:e,checkRowKeys:t}=re.value;if(e)Je(!0,!0);else if(t){const i=[];t.forEach(e=>{a[e]&&i.push(a[e].row)}),E(i,!0,!0)}}if((e=H.radioConfig)&&(e=K["fullDataRowIdData"],{checkRowKey:t,reserve:l}=R.value,t)&&(e[t]&&Ze(e[t].row,!0),l)&&(e=(0,_util.getRowkey)(ue),K.radioReserveRow={[e]:t}),l=H["expandConfig"]){const n=K["fullDataRowIdData"];var{expandAll:l,expandRowKeys:e}=T.value;if(l)B.setAllRowExpand(!0);else if(e){const u=[];e.forEach(e=>{n[e]&&u.push(n[e].row)}),B.setRowExpand(u,!0)}}if(e=H["treeConfig"]){const s=K["tableFullData"];var e=ne.value,{expandAll:r,expandRowKeys:o}=e;const d=e.children||e.childrenField;if(r)B.setAllTreeExpand(!0);else if(o){const c=[],v=(0,_util.getRowkey)(ue);o.forEach(t=>{var e=_xeUtils.default.findTree(s,e=>t===_xeUtils.default.get(e,v),{children:d});e&&c.push(e.item)}),B.setTreeExpand(c,!0)}}(e=H.mergeCells)&&B.setMergeCells(e),(r=H.mergeFooterItems)&&B.setMergeFooterItems(r),(0,_vue.nextTick)(()=>setTimeout(()=>B.recalculate()))},it=()=>{var t=H["sortConfig"];if(t){var l=w.value;let e=l["defaultSort"];e&&(e=_xeUtils.default.isArray(e)?e:[e]).length&&((t.multiple?e:e.slice(0,1)).forEach((e,t)=>{var{field:e,order:l}=e;e&&l&&(e=B.getColumnByField(e))&&e.sortable&&(e.order=l,e.sortTime=Date.now()+t)}),l.remote||Y.handleTableData(!0).then(C))}},nt=()=>{var e=W["scrollXLoad"];const{visibleColumn:t,scrollXStore:l,fullColumnIdData:r}=K;e=e?t.slice(l.startIndex,l.endIndex):t.slice(0);e.forEach((e,t)=>{e=e.id,e=r[e];e&&(e.$index=t)}),W.tableColumn=e},ut=()=>{var{mergeList:e,mergeFooterList:t}=W,l=K["scrollXStore"],{startIndex:r,endIndex:o,offsetSize:a}=l,{toVisibleIndex:i,visibleSize:n}=Ae(),a={startIndex:Math.max(0,i-1-a),endIndex:i+n+a},{startIndex:e,endIndex:t}=(Ve(e.concat(t),a,"col"),a);!(i<=r||o-n-1<=i)||r===e&&o===t||(l.startIndex=e,l.endIndex=t,Y.updateScrollXData()),B.closeTooltip()},st=e=>{const t=[];return e.forEach(e=>{t.push(...e.children&&e.children.length?st(e.children):[e])}),t},dt=()=>{const i=[],n=[],u=[];var{isGroup:e,columnStore:t}=W,l=y.value;const{collectColumn:r,tableFullColumn:o,scrollXStore:a,fullColumnIdData:s}=K;if(e){const c=[],v=[],g=[];_xeUtils.default.eachTree(r,(e,t,l,r,o)=>{var a=(0,_utils.hasChildrenList)(e);o&&o.fixed&&(e.fixed=o.fixed),o&&e.fixed!==o.fixed&&(0,_log.errLog)("vxe.error.groupFixed"),a?e.visible=!!_xeUtils.default.findTree(e.children,e=>!(0,_utils.hasChildrenList)(e)&&e.visible):e.visible&&("left"===e.fixed?i:"right"===e.fixed?u:n).push(e)}),r.forEach(e=>{e.visible&&("left"===e.fixed?c:"right"===e.fixed?g:v).push(e)}),W.tableGroupColumn=c.concat(v).concat(g)}else o.forEach(e=>{e.visible&&("left"===e.fixed?i:"right"===e.fixed?u:n).push(e)});const d=i.concat(n).concat(u);e=!!l.enabled&&-1<l.gt&&(0===l.gt||l.gt<o.length);return W.hasFixedColumn=0<i.length||0<u.length,Object.assign(t,{leftList:i,centerList:n,rightList:u}),e&&("development"===process.env.NODE_ENV&&(H.spanMethod&&(0,_log.warnLog)("vxe.error.scrollErrProp",["span-method"]),H.footerSpanMethod)&&(0,_log.warnLog)("vxe.error.scrollErrProp",["footer-span-method"]),l=Ae()["visibleSize"],a.startIndex=0,a.endIndex=l,a.visibleSize=l),d.length===K.visibleColumn.length&&K.visibleColumn.every((e,t)=>e===d[t])||(B.clearMergeCells(),B.clearMergeFooterItems()),W.scrollXLoad=e,d.forEach((e,t)=>{e=e.id,e=s[e];e&&(e._index=t)}),K.visibleColumn=d,nt(),B.updateFooter().then(()=>B.recalculate()).then(()=>(B.updateCellAreas(),B.recalculate()))},ct=e=>{K.collectColumn=e;var t=st(e);return K.tableFullColumn=t,W._isLoading=!0,K.collectColumn.forEach((e,t)=>{t+=1;e.sortNumber=t,e.renderSortNumber=t}),Promise.resolve((()=>{var e=H["customConfig"],t=u.value,{storage:l,restoreStore:r}=h.value,o=!0===l,l=o?{}:Object.assign({},l||{}),a=o||l.resizable,i=o||l.visible,n=o||l.fixed,o=o||l.sort;if(e&&(a||i||n||o)){if(t)return l=Fe(t),r?Promise.resolve(r({id:t,type:"restore",storeData:l})).then(e=>{if(e)return He(e)}).catch(e=>e):He(l);(0,_log.errLog)("vxe.error.reqProp",["id"])}})()).then(()=>(W._isLoading=!1,je(),dt().then(()=>{W.scrollXLoad&&ut()}),B.clearMergeCells(),B.clearMergeFooterItems(),Y.handleTableData(!0),"development"===process.env.NODE_ENV&&(W.scrollXLoad||W.scrollYLoad)&&W.expandColumn&&(0,_log.warnLog)("vxe.error.scrollErrProp",["column.type=expand"]),(0,_vue.nextTick)().then(()=>(m&&m.syncUpdate({collectColumn:e,$table:ue}),B.recalculate()))))},vt=e=>{var t=H["treeConfig"],l=_.value,r=ne.value["transform"],e=e||K.tableFullData,r=(r||!t)&&!!l.enabled&&-1<l.gt&&(0===l.gt||l.gt<e.length);return W.scrollYLoad=r},gt=(e,t)=>{const{treeExpandedMaps:l,treeExpandLazyLoadedMaps:r,treeNodeColumn:o}=W,a=Object.assign({},l),{fullAllDataRowIdData:i,tableFullData:n}=K;var u=ne.value;const{reserve:s,lazy:d,accordion:c,toggleMethod:v}=u,g=u.children||u.childrenField,f=u.hasChild||u.hasChildField,h=[],m=B.getColumnIndex(o),p=B.getVMColumnIndex(o);let x=v?e.filter(e=>v({$table:ue,expanded:t,column:o,columnIndex:m,$columnIndex:p,row:e})):e;return c&&(x=x.length?[x[x.length-1]]:[],u=_xeUtils.default.findTree(n,e=>e===x[0],{children:g}))&&u.items.forEach(e=>{e=(0,_util.getRowid)(ue,e);a[e]&&delete a[e]}),t?x.forEach(e=>{var t,l=(0,_util.getRowid)(ue,e);a[l]||(t=i[l],d&&e[f]&&!t.treeLoaded&&!r[l]?h.push(Qe(e)):e[g]&&e[g].length&&(a[l]=e))}):x.forEach(e=>{e=(0,_util.getRowid)(ue,e);a[e]&&delete a[e]}),s&&x.forEach(e=>et(e,t)),W.treeExpandedMaps=a,Promise.all(h).then(()=>B.recalculate())},ft=(e,t)=>{Je(t),e&&B.dispatchEvent("checkbox-all",{records:B.getCheckboxRecords(),reserves:B.getCheckboxReserveRecords(),indeterminates:B.getCheckboxIndeterminateRecords(),checked:t},e)},ht=e=>{var t=W["mergeList"],l=K["scrollYStore"],{startIndex:r,endIndex:o,visibleSize:a,offsetSize:i,rowHeight:n}=l,e=(e.currentTarget||e.target).scrollTop,e=Math.floor(e/n),n={startIndex:Math.max(0,e-1-i),endIndex:e+a+i},{startIndex:i,endIndex:t}=(Ve(t,n,"row"),n);!(e<=r||o-a-1<=e)||r===i&&o===t||(l.startIndex=i,l.endIndex=t,Y.updateScrollYData())};e=l=>function(e){var t=K["fullAllDataRowIdData"];if(e){t=t[(0,_util.getRowid)(ue,e)];if(t)return t[l]}return-1},t=l=>function(e){var t=K["fullColumnIdData"];if(e){t=t[e.id];if(t)return t[l]}return-1};const mt=_xeUtils.default.debounce(function(e){ht(e)},20,{leading:!1,trailing:!0});let pt;B={dispatchEvent(e,t,l){r(e,createEvent(l,{$table:ue,$grid:ee},t))},clearAll(){return(0,_util.clearTableAllStatus)(ue)},syncData(){return(0,_log.warnLog)("vxe.error.delFunc",["syncData","getData"]),(0,_vue.nextTick)().then(()=>(W.tableData=[],r("update:data",K.tableFullData),(0,_vue.nextTick)()))},updateData(){const{scrollXLoad:e,scrollYLoad:t}=W;return Y.handleTableData(!0).then(()=>{if(B.updateFooter(),e||t)return e&&Y.updateScrollXSpace(),t&&Y.updateScrollYSpace(),B.refreshScroll()}).then(()=>(B.updateCellAreas(),B.recalculate(!0))).then(()=>{setTimeout(()=>ue.recalculate(),50)})},loadData(e){const{inited:t,initStatus:l}=K;return ot(e).then(()=>(K.inited=!0,K.initStatus=!0,l||at(),t||it(),B.recalculate()))},reloadData(e){const t=K["inited"];return B.clearAll().then(()=>(K.inited=!0,K.initStatus=!0,ot(e))).then(()=>(at(),t||it(),B.recalculate()))},setRow(t,l){if(t&&l){let e=t;(e=_xeUtils.default.isArray(t)?e:[t]).forEach(e=>Object.assign(e,l))}return(0,_vue.nextTick)()},reloadRow(e,t,l){var r=H["keepSource"],o=W["tableData"],a=K["tableSourceData"];return r?((r=a[B.getRowIndex(e)])&&e&&(l?(a=_xeUtils.default.get(t||e,l),_xeUtils.default.set(e,l,a),_xeUtils.default.set(r,l,a)):(l=_xeUtils.default.clone(Object.assign({},t),!0),_xeUtils.default.destructuring(r,Object.assign(e,l)))),W.tableData=o.slice(0)):"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.reqProp",["keep-source"]),(0,_vue.nextTick)()},getParams(){return H.params},loadTreeChildren(r,e){const o=H["keepSource"],{tableSourceData:a,fullDataRowIdData:n,fullAllDataRowIdData:u,sourceDataRowIdData:i}=K;var t=ne.value;const{transform:s,mapChildrenField:d}=t,c=t.children||t.childrenField,v=u[(0,_util.getRowid)(ue,r)],g=v?v.level:0;return B.createData(e).then(e=>{if(o){const l=(0,_util.getRowid)(ue,r);var t=_xeUtils.default.findTree(a,e=>l===(0,_util.getRowid)(ue,e),{children:c});t&&(t.item[c]=_xeUtils.default.clone(e,!0)),e.forEach(e=>{var t=(0,_util.getRowid)(ue,e);i[t]=_xeUtils.default.clone(e,!0)})}return _xeUtils.default.eachTree(e,(e,t,l,r,o,a)=>{var i=(0,_util.getRowid)(ue,e),e={row:e,rowid:i,seq:-1,index:t,_index:-1,$index:-1,items:l,parent:o||v.row,level:g+a.length};n[i]=e,u[i]=e},{children:c}),r[c]=e,s&&(r[d]=_xeUtils.default.clone(e,!1)),Ye(),e})},loadColumn(e){e=_xeUtils.default.mapTree(e,e=>(0,_vue.reactive)(_cell.default.createColumn(ue,e)));return ct(e)},reloadColumn(e){return B.clearAll().then(()=>B.loadColumn(e))},getRowNode(e){if(e){var t=K["fullAllDataRowIdData"],e=e.getAttribute("rowid");if(e){t=t[e];if(t)return{rowid:t.rowid,item:t.row,index:t.index,items:t.items,parent:t.parent}}}return null},getColumnNode(e){if(e){var t=K["fullColumnIdData"],e=e.getAttribute("colid");if(e){t=t[e];if(t)return{colid:t.colid,item:t.column,index:t.index,items:t.items,parent:t.parent}}}return null},getRowSeq:e("seq"),getRowIndex:e("index"),getVTRowIndex:e("_index"),getVMRowIndex:e("$index"),getColumnIndex:t("index"),getVTColumnIndex:t("_index"),getVMColumnIndex:t("$index"),createData(e){return(0,_vue.nextTick)().then(()=>(0,_vue.reactive)(Y.defineField(e)))},createRow(e){const t=_xeUtils.default.isArray(e);return t||(e=[e||{}]),B.createData(e).then(e=>t?e:e[0])},revertData(e,l){var t=H["keepSource"];const{tableSourceData:r,sourceDataRowIdData:o}=K;if(!t)return"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.reqProp",["keep-source"]),(0,_vue.nextTick)();let a=e;return e?_xeUtils.default.isArray(e)||(a=[e]):a=_xeUtils.default.toArray(ue.getUpdateRecords()),a.length&&a.forEach(e=>{var t;B.isInsertByRow(e)||(t=(0,_util.getRowid)(ue,e),(t=o[t])&&e&&(l?_xeUtils.default.set(e,l,_xeUtils.default.clone(_xeUtils.default.get(t,l),!0)):_xeUtils.default.destructuring(e,_xeUtils.default.clone(t,!0))))}),e?(0,_vue.nextTick)():B.reloadData(r)},clearData(e,t){const{tableFullData:l,visibleColumn:r}=K;return arguments.length?e&&!_xeUtils.default.isArray(e)&&(e=[e]):e=l,t?e.forEach(e=>_xeUtils.default.set(e,t,null)):e.forEach(t=>{r.forEach(e=>{e.field&&(0,_util.setCellValue)(t,e,null)})}),(0,_vue.nextTick)()},getCellElement(e,t){t=(0,_util.handleFieldOrColumn)(ue,t);if(!t)return null;var e=(0,_util.getRowid)(ue,e),l=J.value,r=v.value,o=d.value;let a;return t&&(t.fixed&&("left"===t.fixed?r&&(a=r.$el):o&&(a=o.$el)),a=a||l.$el)?a.querySelector(`.vxe-body--row[rowid="${e}"] .`+t.id):null},getCellLabel(t,l){l=(0,_util.handleFieldOrColumn)(ue,l);if(!l)return null;var r=l.formatter,o=(0,_util.getCellValue)(t,l);let a=o;if(r){let e;var i=K["fullAllDataRowIdData"],n=(0,_util.getRowid)(ue,t),u=l.id,s=i[n];if(s&&(e=(e=s.formatData)||(i[n].formatData={}),s)&&e[u]&&e[u].value===o)return e[u].label;i={cellValue:o,row:t,rowIndex:B.getRowIndex(t),column:l,columnIndex:B.getColumnIndex(l)};a=_xeUtils.default.isString(r)?(s=(n=formats.get(r))?n.tableCellFormatMethod||n.cellFormatMethod:null)?s(i):"":_xeUtils.default.isArray(r)?(l=(t=formats.get(r[0]))?t.tableCellFormatMethod||t.cellFormatMethod:null)?l(i,...r.slice(1)):"":r(i),e&&(e[u]={value:o,label:a})}return a},isInsertByRow(e){var t=W["editStore"],e=(0,_util.getRowid)(ue,e);return t.insertMaps[e]},removeInsertRow(){var e=W["editStore"];return e.insertMaps={},ue.remove(ue.getInsertRecords())},isUpdateByRow(l,e){var t=H["keepSource"],{tableFullColumn:r,fullDataRowIdData:o,sourceDataRowIdData:a}=K;if(t){t=(0,_util.getRowid)(ue,l);if(!o[t])return!1;var i=a[t];if(i){if(1<arguments.length)return!ke(i,l,e);for(let e=0,t=r.length;e<t;e++){var n=r[e].field;if(n&&!ke(i,l,n))return!0}}}return!1},getColumns(e){var t=K.visibleColumn;return _xeUtils.default.isUndefined(e)?t.slice(0):t[e]},getColid(e){e=(0,_util.handleFieldOrColumn)(ue,e);return e?e.id:null},getColumnById(e){var t=K.fullColumnIdData;return e&&t[e]?t[e].column:null},getColumnByField(e){var t=K.fullColumnFieldData;return e&&t[e]?t[e].column:null},getParentColumn(e){var t=K.fullColumnIdData,e=(0,_util.handleFieldOrColumn)(ue,e);return e&&e.parentId&&t[e.parentId]?t[e.parentId].column:null},getTableColumn(){return{collectColumn:K.collectColumn.slice(0),fullColumn:K.tableFullColumn.slice(0),visibleColumn:K.visibleColumn.slice(0),tableColumn:W.tableColumn.slice(0)}},getData(e){var t=H.data||K.tableSynchData;return _xeUtils.default.isUndefined(e)?t.slice(0):t[e]},getCheckboxRecords(l){var e=H["treeConfig"];const{tableFullData:t,afterFullData:r,afterTreeFullData:o,tableFullTreeData:a,fullDataRowIdData:i,afterFullRowMaps:n}=K;var u=ne.value,{transform:s,mapChildrenField:d}=u;const c=re.value["checkField"];u=u.children||u.childrenField;let v=[];var g=l?s?a:t:s?o:r;return c?v=e?_xeUtils.default.filterTree(g,e=>_xeUtils.default.get(e,c),{children:s?d:u}):g.filter(e=>_xeUtils.default.get(e,c)):(e=W["selectCheckboxMaps"],_xeUtils.default.each(e,(e,t)=>{l?i[t]&&v.push(i[t].row):n[t]&&v.push(n[t])})),v},getParentRow(t){var l=H["treeConfig"],r=K["fullDataRowIdData"];if(t&&l){let e;if(e=_xeUtils.default.isString(t)?t:(0,_util.getRowid)(ue,t))return(l=r[e])?l.parent:null}return null},getRowById(e){var t=K["fullDataRowIdData"],e=_xeUtils.default.eqNull(e)?"":encodeURIComponent(e||"");return t[e]?t[e].row:null},getRowid(e){return(0,_util.getRowid)(ue,e)},getTableData(){var{tableData:e,footerTableData:t}=W,{tableFullData:l,afterFullData:r,tableFullTreeData:o}=K;return{fullData:(H.treeConfig?o:l).slice(0),visibleData:r.slice(0),tableData:e.slice(0),footerData:t.slice(0)}},setColumnFixed(e,t){var e=(0,_util.handleFieldOrColumn)(ue,e),e=(0,_util.getRootColumn)(ue,e),l=V.value,r=te.value;return e&&e.fixed!==t?!e.fixed&&l?(_ui.VxeUI.modal&&_ui.VxeUI.modal.message({status:"error",content:getI18n("vxe.table.maxFixedCol",[r.maxFixedSize])}),(0,_vue.nextTick)()):(_xeUtils.default.eachTree([e],e=>{e.fixed=t}),Y.saveCustomStore("update:fixed"),B.refreshColumn()):(0,_vue.nextTick)()},clearColumnFixed(e){e=(0,_util.handleFieldOrColumn)(ue,e),e=(0,_util.getRootColumn)(ue,e);return e&&e.fixed?(_xeUtils.default.eachTree([e],e=>{e.fixed=null}),Y.saveCustomStore("update:fixed"),B.refreshColumn()):(0,_vue.nextTick)()},hideColumn(e){e=(0,_util.handleFieldOrColumn)(ue,e);return e&&e.visible?(e.visible=!1,Y.handleCustom()):(0,_vue.nextTick)()},showColumn(e){e=(0,_util.handleFieldOrColumn)(ue,e);return e&&!e.visible?(e.visible=!0,Y.handleCustom()):(0,_vue.nextTick)()},setColumnWidth(t,l){t=(0,_util.handleFieldOrColumn)(ue,t);if(t){var r=_xeUtils.default.toInteger(l);let e=r;return(0,_dom.isScale)(l)&&(l=(l=(l=J.value)?l.$el:null)?l.clientWidth-1:0,e=Math.floor(r*l)),t.resizeWidth=e,B.refreshColumn()}return(0,_vue.nextTick)()},getColumnWidth(e){e=(0,_util.handleFieldOrColumn)(ue,e);return e?e.renderWidth:0},resetColumn(e){var t=K["collectColumn"];const l=h.value["checkMethod"],r=Object.assign({visible:!0,resizable:!0===e,fixed:!0===e,sort:!0===e},e);return _xeUtils.default.eachTree(t,e=>{r.resizable&&(e.resizeWidth=0),r.fixed&&(e.fixed=e.defaultFixed),r.sort&&(e.renderSortNumber=e.sortNumber),l&&!l({column:e})||(e.visible=e.defaultVisible),e.renderResizeWidth=e.renderWidth}),ue.saveCustomStore("reset"),Y.handleCustom()},refreshColumn(e){return e&&(e=_xeUtils.default.orderBy(K.collectColumn,"renderSortNumber"),K.collectColumn=e,e=st(e),K.tableFullColumn=e,je()),dt().then(()=>B.refreshScroll()).then(()=>B.recalculate())},refreshScroll(){const{lastScrollLeft:t,lastScrollTop:l}=K;var e=J.value,r=Q.value,o=v.value,a=d.value;const i=e?e.$el:null,n=o?o.$el:null,u=a?a.$el:null,s=r?r.$el:null;return new Promise(e=>{if(t||l)return(0,_util.restoreScrollLocation)(ue,t,l).then().then(()=>{setTimeout(e,30)});(0,_dom.setScrollTop)(i,l),(0,_dom.setScrollTop)(n,l),(0,_dom.setScrollTop)(u,l),(0,_dom.setScrollLeft)(s,t),setTimeout(e,30)})},recalculate(e){var t=X.value;if(!t||!t.clientWidth)return(0,_vue.nextTick)();{t=W.tableData;const l=A.value;t.length&&l.length?(W.isCalcColumn=!0,(0,_vue.nextTick)().then(()=>{const a=X.value;a&&(l.forEach(e=>{var t=a.querySelectorAll(`.vxe-header--column.${e.id}>.vxe-cell,.vxe-body--column.${e.id}>.vxe-cell,.vxe-footer--column.${e.id}>.vxe-cell`),l=t[0];let r=0,o=(l&&(l=getComputedStyle(l),r=Math.floor(_xeUtils.default.toNumber(l.paddingLeft)+_xeUtils.default.toNumber(l.paddingRight))+2),e.renderAutoWidth-r);_xeUtils.default.arrayEach(t,e=>{e=e.firstChild;e&&(o=Math.max(o,Math.ceil(e.offsetWidth)+4))}),e.renderAutoWidth=o+r}),Y.analyColumnWidth()),W.isCalcColumn=!1})):(W.isCalcColumn=!1,_vue.nextTick)()}return Ke(),!0===e?rt().then(()=>(Ke(),rt())):rt()},openTooltip(e,t){var l=ve.value;return l&&l.open?l.open(e,t):(0,_vue.nextTick)()},closeTooltip(){var e=W["tooltipStore"],t=G.value,l=ve.value;return e.visible&&(Object.assign(e,{row:null,column:null,content:null,visible:!1,currOpts:{}}),t)&&t.close&&t.close(),l&&l.close&&l.close(),(0,_vue.nextTick)()},isAllCheckboxChecked(){return W.isAllSelected},isAllCheckboxIndeterminate(){return!W.isAllSelected&&W.isIndeterminate},getCheckboxIndeterminateRecords(e){var t=H["treeConfig"];const l=K["fullDataRowIdData"];var r=W["treeIndeterminateMaps"];if(t){const o=[],a=[];return _xeUtils.default.each(r,(e,t)=>{e&&(o.push(e),l[t])&&a.push(e)}),e?o:a}return[]},setCheckboxRow(e,t){return E(e,t,!0)},isCheckedByCheckboxRow(e){var t=W["selectCheckboxMaps"],l=re.value["checkField"];return l?_xeUtils.default.get(e,l):!!t[(0,_util.getRowid)(ue,e)]},isIndeterminateByCheckboxRow(e){var t=W["treeIndeterminateMaps"];return!!t[(0,_util.getRowid)(ue,e)]&&!B.isCheckedByCheckboxRow(e)},toggleCheckboxRow(e){var t=W["selectCheckboxMaps"],l=re.value["checkField"],l=l?!_xeUtils.default.get(e,l):!t[(0,_util.getRowid)(ue,e)];return Y.handleSelectRow({row:e},l,!0),(0,_vue.nextTick)()},setAllCheckboxRow(e){return Je(e,!0)},getRadioReserveRecord(e){var t=H["treeConfig"],{fullDataRowIdData:l,radioReserveRow:r,afterFullData:o}=K,a=R.value,i=ne.value,i=i.children||i.childrenField;if(a.reserve&&r){const n=(0,_util.getRowid)(ue,r);if(e){if(!l[n])return r}else{const u=(0,_util.getRowkey)(ue);if(t){if(_xeUtils.default.findTree(o,e=>n===_xeUtils.default.get(e,u),{children:i}))return r}else if(!o.some(e=>n===_xeUtils.default.get(e,u)))return r}}return null},clearRadioReserve(){return(K.radioReserveRow=null,_vue.nextTick)()},getCheckboxReserveRecords(l){var e=H["treeConfig"];const{afterFullData:t,fullDataRowIdData:r,checkboxReserveRowMap:o}=K;var a=re.value,i=ne.value,i=i.children||i.childrenField;const n=[];if(a.reserve){const u={};e?_xeUtils.default.eachTree(t,e=>{u[(0,_util.getRowid)(ue,e)]=1},{children:i}):t.forEach(e=>{u[(0,_util.getRowid)(ue,e)]=1}),_xeUtils.default.each(o,(e,t)=>{e&&(l?r[t]||n.push(e):u[t]||n.push(e))})}return n},clearCheckboxReserve(){return K.checkboxReserveRowMap={},(0,_vue.nextTick)()},toggleAllCheckboxRow(){return ft(null,!W.isAllSelected),(0,_vue.nextTick)()},clearCheckboxRow(){const t=H["treeConfig"];var e=K["tableFullData"],l=ne.value,l=l.children||l.childrenField,r=re.value;const{checkField:o,reserve:a}=r,i=r.indeterminateField||r.halfField;return o&&(r=e=>{t&&i&&_xeUtils.default.set(e,i,!1),_xeUtils.default.set(e,o,!1)},t?_xeUtils.default.eachTree(e,r,{children:l}):e.forEach(r)),a&&e.forEach(e=>b(e,!1)),W.isAllSelected=!1,W.isIndeterminate=!1,W.selectCheckboxMaps={},W.treeIndeterminateMaps={},(0,_vue.nextTick)()},setCurrentRow(e){var t=le.value,l=X.value;return B.clearCurrentRow(),W.currentRow=e,(t.isCurrent||H.highlightCurrentRow)&&l&&_xeUtils.default.arrayEach(l.querySelectorAll(`[rowid="${(0,_util.getRowid)(ue,e)}"]`),e=>(0,_dom.addClass)(e,"row--current")),(0,_vue.nextTick)()},isCheckedByRadioRow(e){return ue.eqRow(W.selectRadioRow,e)},setRadioRow(e){return Ze(e,!0)},clearCurrentRow(){var e=X.value;return W.currentRow=null,K.hoverRow=null,e&&_xeUtils.default.arrayEach(e.querySelectorAll(".row--current"),e=>(0,_dom.removeClass)(e,"row--current")),(0,_vue.nextTick)()},clearRadioRow(){return(W.selectRadioRow=null,_vue.nextTick)()},getCurrentRecord(){return le.value.isCurrent||H.highlightCurrentRow?W.currentRow:null},getRadioRecord(e){var{fullDataRowIdData:t,afterFullRowMaps:l}=K,r=W["selectRadioRow"];if(r){var o=(0,_util.getRowid)(ue,r);if(e){if(t[o])return r}else if(l[o])return r}return null},getCurrentColumn(){return te.value.isCurrent||H.highlightCurrentColumn?W.currentColumn:null},setCurrentColumn(e){e=(0,_util.handleFieldOrColumn)(ue,e);return e&&(B.clearCurrentColumn(),W.currentColumn=e),(0,_vue.nextTick)()},clearCurrentColumn(){return(W.currentColumn=null,_vue.nextTick)()},setPendingRow(e,t){const l=Object.assign({},W.pendingRowMaps),r=[...W.pendingRowList];return e&&!_xeUtils.default.isArray(e)&&(e=[e]),t?e.forEach(e=>{var t=(0,_util.getRowid)(ue,e);t&&!l[t]&&(r.push(e),l[t]=e)}):e.forEach(e=>{var t=(0,_util.getRowid)(ue,e);t&&l[t]&&(-1<(e=ue.findRowIndexOf(r,e))&&r.splice(e,1),delete l[t])}),W.pendingRowMaps=l,W.pendingRowList=r,(0,_vue.nextTick)()},togglePendingRow(e){const r=Object.assign({},W.pendingRowMaps),o=[...W.pendingRowList];return(e=e&&!_xeUtils.default.isArray(e)?[e]:e).forEach(e=>{var t,l=(0,_util.getRowid)(ue,e);l&&(r[l]?(-1<(t=ue.findRowIndexOf(o,e))&&o.splice(t,1),delete r[l]):(o.push(e),r[l]=e))}),W.pendingRowMaps=r,W.pendingRowList=o,(0,_vue.nextTick)()},hasPendingByRow(e){return B.isPendingByRow(e)},isPendingByRow(e){var t=W["pendingRowMaps"];return!!t[(0,_util.getRowid)(ue,e)]},getPendingRecords(){var e=W["pendingRowList"];return e.slice(0)},clearPendingRow(){return W.pendingRowMaps={},W.pendingRowList=[],(0,_vue.nextTick)()},sort(e,t){const{multiple:l,remote:r,orders:a}=w.value;return e&&_xeUtils.default.isString(e)&&(e=[{field:e,order:t}]),(e=_xeUtils.default.isArray(e)?e:[e]).length?(l||ze(),(l?e:[e[0]]).forEach((e,t)=>{let{field:l,order:r}=e,o=l;(o=_xeUtils.default.isString(l)?B.getColumnByField(l):o)&&o.sortable&&(-1===a.indexOf(r)&&(r=Ie(o)),o.order!==r&&(o.order=r),o.sortTime=Date.now()+t)}),r||Y.handleTableData(!0),(0,_vue.nextTick)().then(()=>(B.updateCellAreas(),C()))):(0,_vue.nextTick)()},clearSort(e){var t=w.value;return e?(e=(0,_util.handleFieldOrColumn)(ue,e))&&(e.order=null):ze(),t.remote||Y.handleTableData(!0),(0,_vue.nextTick)().then(C)},isSort(e){return e?!!(e=(0,_util.handleFieldOrColumn)(ue,e))&&e.sortable&&!!e.order:0<B.getSortColumns().length},getSortColumns(){var{multiple:e,chronological:t}=w.value;const r=[];var l=K["tableFullColumn"];return l.forEach(e=>{var{field:t,order:l}=e;e.sortable&&l&&r.push({column:e,field:t,property:t,order:l,sortTime:e.sortTime})}),e&&t&&1<r.length?_xeUtils.default.orderBy(r,"sortTime"):r},closeFilter(){var e=W["filterStore"],{column:t,visible:l}=e;return Object.assign(e,{isAllSelected:!1,isIndeterminate:!1,options:[],visible:!1}),l&&ue.dispatchEvent("filter-visible",{column:t,property:t.field,field:t.field,filterList:ue.getCheckedFilters(),visible:!1},null),(0,_vue.nextTick)()},isActiveFilterByColumn(e){e=(0,_util.handleFieldOrColumn)(ue,e);return e?e.filters&&e.filters.some(e=>e.checked):0<ue.getCheckedFilters().length},isFilter(e){return B.isActiveFilterByColumn(e)},isRowExpandLoaded(e){var t=K["fullAllDataRowIdData"],t=t[(0,_util.getRowid)(ue,e)];return t&&!!t.expandLoaded},clearRowExpandLoaded(e){var t=W["rowExpandLazyLoadedMaps"],l=K["fullAllDataRowIdData"],r=T.value["lazy"],e=(0,_util.getRowid)(ue,e),l=l[e];return r&&l&&(l.expandLoaded=!1,delete t[e]),(0,_vue.nextTick)()},reloadRowExpand(e){var t=W["rowExpandLazyLoadedMaps"],l=T.value["lazy"],r=(0,_util.getRowid)(ue,e);return l&&!t[r]&&B.clearRowExpandLoaded(e).then(()=>tt(e)),(0,_vue.nextTick)()},reloadExpandContent(e){return"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.delFunc",["reloadExpandContent","reloadRowExpand"]),B.reloadRowExpand(e)},toggleRowExpand(e){return B.setRowExpand(e,!B.isRowExpandByRow(e))},setAllRowExpand(e){var t=ne.value,{tableFullData:l,tableFullTreeData:r}=K,t=t.children||t.childrenField;let o=[];return H.treeConfig?_xeUtils.default.eachTree(r,e=>{o.push(e)},{children:t}):o=l,B.setRowExpand(o,e)},setRowExpand(e,t){const{rowExpandedMaps:l,rowExpandLazyLoadedMaps:r,expandColumn:o}=W,a=K["fullAllDataRowIdData"];let i=Object.assign({},l);const{reserve:n,lazy:u,accordion:s,toggleMethod:d}=T.value,c=[],v=B.getColumnIndex(o),g=B.getVMColumnIndex(o);return e&&(_xeUtils.default.isArray(e)||(e=[e]),s&&(i={},e=e.slice(e.length-1,e.length)),e=d?e.filter(e=>d({$table:ue,expanded:t,column:o,columnIndex:v,$columnIndex:g,row:e,rowIndex:B.getRowIndex(e),$rowIndex:B.getVMRowIndex(e)})):e,t?e.forEach(e=>{var t,l=(0,_util.getRowid)(ue,e);i[l]||(t=a[l],u&&!t.expandLoaded&&!r[l]?c.push(tt(e)):i[l]=e)}):e.forEach(e=>{e=(0,_util.getRowid)(ue,e);i[e]&&delete i[e]}),n)&&e.forEach(e=>lt(e,t)),W.rowExpandedMaps=i,Promise.all(c).then(()=>B.recalculate())},isRowExpandByRow(e){var t=W["rowExpandedMaps"];return!!t[(0,_util.getRowid)(ue,e)]},isExpandByRow(e){return"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.delFunc",["isExpandByRow","isRowExpandByRow"]),B.isRowExpandByRow(e)},clearRowExpand(){var e=K["tableFullData"],t=T.value["reserve"];const l=B.getRowExpandRecords();return W.rowExpandedMaps={},t&&e.forEach(e=>lt(e,!1)),(0,_vue.nextTick)().then(()=>{l.length&&B.recalculate()})},clearRowExpandReserve(){return K.rowExpandedReserveRowMap={},(0,_vue.nextTick)()},getRowExpandRecords(){const t=[];return _xeUtils.default.each(W.rowExpandedMaps,e=>{e&&t.push(e)}),t},getTreeExpandRecords(){const t=[];return _xeUtils.default.each(W.treeExpandedMaps,e=>{e&&t.push(e)}),t},isTreeExpandLoaded(e){var t=K["fullAllDataRowIdData"],t=t[(0,_util.getRowid)(ue,e)];return t&&!!t.treeLoaded},clearTreeExpandLoaded(e){var t=W["treeExpandedMaps"],l=K["fullAllDataRowIdData"],{transform:r,lazy:o}=ne.value,e=(0,_util.getRowid)(ue,e),l=l[e];return o&&l&&(l.treeLoaded=!1,t[e])&&delete t[e],r?(n(),Y.handleTableData()):(0,_vue.nextTick)()},reloadTreeExpand(e){var t=W["treeExpandLazyLoadedMaps"],l=ne.value,r=l.hasChild||l.hasChildField;const{transform:o,lazy:a}=l;l=(0,_util.getRowid)(ue,e);return a&&e[r]&&!t[l]&&B.clearTreeExpandLoaded(e).then(()=>Qe(e)).then(()=>{if(o)return n(),Y.handleTableData()}).then(()=>B.recalculate()),(0,_vue.nextTick)()},reloadTreeChilds(e){return"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.delFunc",["reloadTreeChilds","reloadTreeExpand"]),B.reloadTreeExpand(e)},toggleTreeExpand(e){return B.setTreeExpand(e,!B.isTreeExpandByRow(e))},setAllTreeExpand(e){var t=K["tableFullData"],l=ne.value;const{transform:r,lazy:o}=l,a=l.children||l.childrenField,i=[];return _xeUtils.default.eachTree(t,e=>{var t=e[a];(o||t&&t.length)&&i.push(e)},{children:a}),B.setTreeExpand(i,e).then(()=>{if(r)return n(),B.recalculate()})},setTreeExpand(e,t){var l,r=ne.value["transform"];return e&&(e=_xeUtils.default.isArray(e)?e:[e]).length?r?(r=e,l=t,gt(r,l).then(()=>(n(),Y.handleTableData())).then(()=>B.recalculate())):gt(e,t):(0,_vue.nextTick)()},isTreeExpandByRow(e){var t=W["treeExpandedMaps"];return!!t[(0,_util.getRowid)(ue,e)]},clearTreeExpand(){var e=K["tableFullTreeData"],t=ne.value,l=t.children||t.childrenField;const{transform:r,reserve:o}=t,a=B.getTreeExpandRecords();return W.treeExpandedMaps={},o&&_xeUtils.default.eachTree(e,e=>et(e,!1),{children:l}),Y.handleTableData().then(()=>{if(r)return n(),Y.handleTableData()}).then(()=>{if(a.length)return B.recalculate()})},clearTreeExpandReserve(){return K.treeExpandedReserveRowMap={},(0,_vue.nextTick)()},getScroll(){var{scrollXLoad:e,scrollYLoad:t}=W,l=J.value.$el;return{virtualX:e,virtualY:t,scrollTop:l.scrollTop,scrollLeft:l.scrollLeft}},scrollTo(e,t){var l=J.value,r=Q.value,o=d.value,l=l?l.$el:null,o=o?o.$el:null,r=r?r.$el:null;return _xeUtils.default.isNumber(e)&&(0,_dom.setScrollLeft)(r||l,e),_xeUtils.default.isNumber(t)&&(0,_dom.setScrollTop)(o||l,t),W.scrollXLoad||W.scrollYLoad?new Promise(e=>{setTimeout(()=>{(0,_vue.nextTick)(()=>{e()})},50)}):(0,_vue.nextTick)()},scrollToRow(e,t){var l=[];return e&&(H.treeConfig?l.push(Y.scrollToTreeRow(e)):l.push((0,_util.rowToVisible)(ue,e))),t&&l.push(B.scrollToColumn(t)),Promise.all(l)},scrollToColumn(e){var t=K["fullColumnIdData"],e=(0,_util.handleFieldOrColumn)(ue,e);return e&&t[e.id]?(0,_util.colToVisible)(ue,e):(0,_vue.nextTick)()},clearScroll(){var{scrollXStore:e,scrollYStore:t}=K,l=J.value,r=Q.value,o=d.value,l=l?l.$el:null,o=o?o.$el:null,r=r?r.$el:null;return o&&((0,_util.restoreScrollListener)(o),o.scrollTop=0),r&&(r.scrollLeft=0),l&&((0,_util.restoreScrollListener)(l),l.scrollTop=0,l.scrollLeft=0),e.startIndex=0,e.endIndex=e.visibleSize,t.startIndex=0,t.endIndex=t.visibleSize,(0,_vue.nextTick)()},updateFooter(){var{showFooter:e,footerData:t,footerMethod:l}=H,{visibleColumn:r,afterFullData:o}=K;let a=[];return e&&t&&t.length?a=t.slice(0):e&&l&&(a=r.length?l({columns:r,data:o,$table:ue,$grid:ee}):[]),W.footerTableData=a,(0,_vue.nextTick)()},updateStatus(i,n){const u=!_xeUtils.default.isUndefined(n);return(0,_vue.nextTick)().then(()=>{var e=H["editRules"];const t=W["validStore"];var l=J.value;if(i&&l&&e){const{row:r,column:o}=i;if(ue.hasCellRules&&ue.hasCellRules("change",r,o)){const a=B.getCellElement(r,o);if(a)return ue.validCellRules("change",r,o,n).then(()=>{u&&t.visible&&(0,_util.setCellValue)(r,o,n),ue.clearValidate(r,o)}).catch(({rule:e})=>{u&&(0,_util.setCellValue)(r,o,n),ue.showValidTooltip({rule:e,row:r,column:o,cell:a})})}}})},setMergeCells(e){return H.spanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-cells","span-method"]),qe(e,W.mergeList,K.afterFullData),(0,_vue.nextTick)().then(()=>(B.updateCellAreas(),C()))},removeMergeCells(e){H.spanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-cells","span-method"]);const t=$e(e,W.mergeList,K.afterFullData);return(0,_vue.nextTick)().then(()=>(B.updateCellAreas(),C(),t))},getMergeCells(){return W.mergeList.slice(0)},clearMergeCells(){return W.mergeList=[],(0,_vue.nextTick)().then(()=>C())},setMergeFooterItems(e){return H.footerSpanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-footer-items","footer-span-method"]),qe(e,W.mergeFooterList),(0,_vue.nextTick)().then(()=>(B.updateCellAreas(),C()))},removeMergeFooterItems(e){H.footerSpanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-footer-items","footer-span-method"]);const t=$e(e,W.mergeFooterList);return(0,_vue.nextTick)().then(()=>(B.updateCellAreas(),C(),t))},getMergeFooterItems(){return W.mergeFooterList.slice(0)},clearMergeFooterItems(){return W.mergeFooterList=[],(0,_vue.nextTick)().then(()=>C())},updateCellAreas(){var e=H["mouseConfig"],t=ae.value;return e&&t.area&&ue.handleUpdateCellAreas?ue.handleUpdateCellAreas():(0,_vue.nextTick)()},getCustomStoreData(){var e=H["id"],t=h.value;const s=K["collectColumn"],d=t["checkMethod"],c={},v={},g={},f={};t={resizableData:void 0,sortData:void 0,visibleData:void 0,fixedData:void 0};if(e){let a=0,i=0,n=0,u=0;_xeUtils.default.eachTree(s,(e,t,l,r,o)=>{o||(s.forEach(e=>{var t=e.getKey();t&&(i=1,v[t]=e.renderSortNumber)}),e.fixed&&e.fixed!==e.defaultFixed&&(o=e.getKey())&&(n=1,f[o]=e.fixed)),e.resizeWidth&&(o=e.getKey())&&(a=1,c[o]=e.renderWidth),d&&!d({column:e})||(!e.visible&&e.defaultVisible?(o=e.getKey())&&(u=1,g[o]=!1):e.visible&&!e.defaultVisible&&(o=e.getKey())&&(u=1,g[o]=!0))}),a&&(t.resizableData=c),i&&(t.sortData=v),n&&(t.fixedData=f),u&&(t.visibleData=g)}else(0,_log.errLog)("vxe.error.reqProp",["id"]);return t},focus(){return K.isActivated=!0,(0,_vue.nextTick)()},blur(){return(K.isActivated=!1,_vue.nextTick)()},connect(e){return e?(m=e).syncUpdate({collectColumn:K.collectColumn,$table:ue}):(0,_log.errLog)("vxe.error.barUnableLink"),(0,_vue.nextTick)()}};const xt=l=>{var{editStore:e,ctxMenuStore:t,filterStore:r,customStore:o}=W,{mouseConfig:a,editRules:i}=H;const n=X.value,u=oe.value;var s=_e.value,d=D.value;const c=e["actived"];var e=ge.value,v=he.value,g=me.value,f=fe.value;if(!v||(0,_dom.getEventTargetNode)(l,n,"vxe-cell--filter").flag||(0,_dom.getEventTargetNode)(l,v.$el).flag||(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-clear").flag||Y.preventEvent(l,"event.clearFilter",r.args,B.closeFilter),!g||o.btnEl===l.target||(0,_dom.getEventTargetNode)(l,document.body,"vxe-toolbar-custom-target").flag||(0,_dom.getEventTargetNode)(l,g.$el).flag||(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-clear").flag||Y.preventEvent(l,"event.clearCustom",{},()=>{ue.closeCustom&&ue.closeCustom()}),c.row)!1===u.autoClear||(v=c.args.cell)&&(0,_dom.getEventTargetNode)(l,v).flag||e&&(0,_dom.getEventTargetNode)(l,e.$el).flag||K._lastCallTime&&!(K._lastCallTime+50<Date.now())||(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-clear").flag||Y.preventEvent(l,"event.clearEdit",c.args,()=>{let e;var t;(e=(e=(e="row"===u.mode?!!(t=(t=(0,_dom.getEventTargetNode)(l,n,"vxe-body--row")).flag?B.getRowNode(t.targetElem):null)&&!ue.eqRow(t.item,c.args.row):!(0,_dom.getEventTargetNode)(l,n,"col--edit").flag)||(0,_dom.getEventTargetNode)(l,n,"vxe-header--row").flag)||(0,_dom.getEventTargetNode)(l,n,"vxe-footer--row").flag)||!H.height||W.overflowY||(t=l.target,(0,_dom.hasClass)(t,"vxe-table--body-wrapper")&&(e=l.offsetY<t.clientHeight)),!e&&(0,_dom.getEventTargetNode)(l,n).flag||setTimeout(()=>ue.clearEdit(l))});else if(a&&!((0,_dom.getEventTargetNode)(l,n).flag||ee&&(0,_dom.getEventTargetNode)(l,ee.getRefMaps().refElem.value).flag||f&&(0,_dom.getEventTargetNode)(l,f.getRefMaps().refElem.value).flag||m&&(0,_dom.getEventTargetNode)(l,m.getRefMaps().refElem.value).flag)&&(ue.clearSelected&&ue.clearSelected(),d.autoClear)&&ue.getCellAreas){const h=ue.getCellAreas();h&&h.length&&!(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-areas-clear").flag&&Y.preventEvent(l,"event.clearAreas",{},()=>{ue.clearCellAreas(),ue.clearCopyCellArea(),ue.dispatchEvent("clear-cell-area-selection",{cellAreas:h},l)})}ue.closeMenu&&t.visible&&f&&!(0,_dom.getEventTargetNode)(l,f.getRefMaps().refElem.value).flag&&ue.closeMenu();r=(0,_dom.getEventTargetNode)(l,ee?ee.getRefMaps().refElem.value:n).flag;!r&&i&&s.autoClear&&(W.validErrorMaps={}),K.isActivated=r},_t=()=>{B.closeFilter(),ue.closeMenu&&ue.closeMenu()},wt=()=>{B.closeTooltip(),ue.closeMenu&&ue.closeMenu()},Ct=t=>{const{mouseConfig:l,keyboardConfig:r}=H,{filterStore:o,ctxMenuStore:a,editStore:e}=W,i=ae.value,n=ie.value,u=e["actived"];globalEvents.hasKey(t,GLOBAL_EVENT_KEYS.ESCAPE)&&Y.preventEvent(t,"event.keydown",null,()=>{if(B.dispatchEvent("keydown-start",{},t),r&&l&&i.area&&ue.handleKeyboardEvent)ue.handleKeyboardEvent(t);else if((u.row||o.visible||a.visible)&&(t.stopPropagation(),ue.closeMenu&&ue.closeMenu(),B.closeFilter(),r)&&n.isEsc&&u.row){const e=u.args;ue.clearEdit(t),i.selected&&(0,_vue.nextTick)(()=>ue.handleSelected(e,t))}B.dispatchEvent("keydown",{},t),B.dispatchEvent("keydown-end",{},t)})},bt=P=>{K.isActivated&&Y.preventEvent(P,"event.keydown",null,()=>{var{mouseConfig:e,keyboardConfig:t,treeConfig:l,editConfig:r,highlightCurrentRow:o}=H;const{ctxMenuStore:a,editStore:A,currentRow:i}=W;var n=Ee.value,u=be.value,s=ie.value,d=ae.value,c=oe.value,v=ne.value,g=Re.value,f=le.value;const{selected:h,actived:m}=A;var v=v.children||v.childrenField,p=P.keyCode,x=globalEvents.hasKey(P,GLOBAL_EVENT_KEYS.ESCAPE),_=globalEvents.hasKey(P,GLOBAL_EVENT_KEYS.BACKSPACE),N=globalEvents.hasKey(P,GLOBAL_EVENT_KEYS.TAB),w=globalEvents.hasKey(P,GLOBAL_EVENT_KEYS.ENTER),C=globalEvents.hasKey(P,GLOBAL_EVENT_KEYS.SPACEBAR),b=globalEvents.hasKey(P,GLOBAL_EVENT_KEYS.ARROW_LEFT),E=globalEvents.hasKey(P,GLOBAL_EVENT_KEYS.ARROW_UP),R=globalEvents.hasKey(P,GLOBAL_EVENT_KEYS.ARROW_RIGHT),T=globalEvents.hasKey(P,GLOBAL_EVENT_KEYS.ARROW_DOWN),V=globalEvents.hasKey(P,GLOBAL_EVENT_KEYS.DELETE),y=globalEvents.hasKey(P,GLOBAL_EVENT_KEYS.F2),S=globalEvents.hasKey(P,GLOBAL_EVENT_KEYS.CONTEXT_MENU),q=P.metaKey,D=P.ctrlKey,M=P.shiftKey,$=P.altKey,z=b||E||R||T,n=n&&a.visible&&(w||C||z),L=(0,_utils.isEnableConf)(r)&&m.column&&m.row;const k=c.beforeEditMethod||c.activeMethod;let I;if(n)P.preventDefault(),a.showChild&&(0,_utils.hasChildrenList)(a.selected)?ue.moveCtxMenu(P,a,"selectChild",b,!1,a.selected.children):ue.moveCtxMenu(P,a,"selected",R,!0,g);else if(t&&e&&d.area&&ue.handleKeyboardEvent)ue.handleKeyboardEvent(P);else if(x){if(ue.closeMenu&&ue.closeMenu(),B.closeFilter(),t&&s.isEsc&&m.row){const I=m.args;ue.clearEdit(P),d.selected&&(0,_vue.nextTick)(()=>ue.handleSelected(I,P))}}else if(C&&t&&s.isChecked&&h.row&&h.column&&("checkbox"===h.column.type||"radio"===h.column.type))P.preventDefault(),"checkbox"===h.column.type?Y.handleToggleCheckRowEvent(P,h.args):Y.triggerRadioRowEvent(P,h.args);else if(y&&(0,_utils.isEnableConf)(r))L||h.row&&h.column&&(P.preventDefault(),ue.handleActived(h.args,P));else if(S)K._keyCtx=h.row&&h.column&&u.length,clearTimeout(pt),pt=setTimeout(()=>{K._keyCtx=!1},1e3);else if(w&&!$&&t&&s.isEnter&&(h.row||m.row||l&&(f.isCurrent||o)&&i)){if(D)m.row&&(I=m.args,ue.clearEdit(P),d.selected)&&(0,_vue.nextTick)(()=>ue.handleSelected(I,P));else if(h.row||m.row){n=(h.row?h:m).args;M?s.enterToTab?ue.moveTabSelected(n,M,P):ue.moveSelected(n,b,!0,R,!1,P):s.enterToTab?ue.moveTabSelected(n,M,P):ue.moveSelected(n,b,!1,R,!0,P)}else if(l&&(f.isCurrent||o)&&i){g=i[v];if(g&&g.length){P.preventDefault();const F=g[0];I={$table:ue,row:F,rowIndex:B.getRowIndex(F),$rowIndex:B.getVMRowIndex(F)},B.setTreeExpand(i,!0).then(()=>B.scrollToRow(F)).then(()=>Y.triggerCurrentRowEvent(P,I))}}}else if(z&&t&&s.isArrow)L||(h.row&&h.column?ue.moveSelected(h.args,b,E,R,T,P):(E||T)&&(f.isCurrent||o)&&ue.moveCurrentRow(E,T,P));else if(N&&t&&s.isTab)h.row||h.column?ue.moveTabSelected(h.args,M,P):(m.row||m.column)&&ue.moveTabSelected(m.args,M,P);else if(t&&s.isDel&&V&&(0,_utils.isEnableConf)(r)&&(h.row||h.column))L||(e=s["delMethod"],x={row:h.row,rowIndex:B.getRowIndex(h.row),column:h.column,columnIndex:B.getColumnIndex(h.column),$table:ue},k&&!k(I))||(e?e(x):(0,_util.setCellValue)(h.row,h.column,null),B.updateFooter(),ue.dispatchEvent("cell-delete-value",x,P));else if(_&&t&&s.isBack&&(0,_utils.isEnableConf)(r)&&(h.row||h.column))L||(y=s["backMethod"],s.isDel&&(0,_utils.isEnableConf)(r)&&(h.row||h.column)&&(S={row:h.row,rowIndex:B.getRowIndex(h.row),column:h.column,columnIndex:B.getColumnIndex(h.column),$table:ue},k&&!k(I)||(y?y({row:h.row,rowIndex:B.getRowIndex(h.row),column:h.column,columnIndex:B.getColumnIndex(h.column),$table:ue}):((0,_util.setCellValue)(h.row,h.column,null),ue.handleActived(h.args,P)),ue.dispatchEvent("cell-backspace-value",S,P))));else if(_&&t&&l&&s.isBack&&(f.isCurrent||o)&&i){const U=_xeUtils.default.findTree(K.afterTreeFullData,e=>e===i,{children:v})["parent"];U&&(P.preventDefault(),I={$table:ue,row:U,rowIndex:B.getRowIndex(U),$rowIndex:B.getVMRowIndex(U)},B.setTreeExpand(U,!1).then(()=>B.scrollToRow(U)).then(()=>Y.triggerCurrentRowEvent(P,I)))}else if(t&&(0,_utils.isEnableConf)(r)&&s.isEdit&&!D&&!q&&(C||48<=p&&p<=57||65<=p&&p<=90||96<=p&&p<=111||186<=p&&p<=192||219<=p&&p<=222)){u=s["editMethod"];if(h.column&&h.row&&(0,_utils.isEnableConf)(h.column.editRender)){const k=c.beforeEditMethod||c.activeMethod;if(!k||k(Object.assign(Object.assign({},h.args),{$table:ue,$grid:ee}))){u?u({row:h.row,rowIndex:B.getRowIndex(h.row),column:h.column,columnIndex:B.getColumnIndex(h.column),$table:ue,$grid:ee}):((0,_util.setCellValue)(h.row,h.column,null),ue.handleActived(h.args,P));const O=c.afterEditMethod;O&&(0,_vue.nextTick)(()=>{O({row:h.row,rowIndex:B.getRowIndex(h.row),column:h.column,columnIndex:B.getColumnIndex(h.column),$table:ue,$grid:ee})})}}}B.dispatchEvent("keydown",{},P)})},Et=e=>{var{keyboardConfig:t,mouseConfig:l}=H,{editStore:r,filterStore:o}=W,a=K["isActivated"],i=ae.value,n=ie.value,r=r["actived"];a&&!o.visible&&(r.row||r.column||t&&n.isClip&&l&&i.area&&ue.handlePasteCellAreaEvent&&ue.handlePasteCellAreaEvent(e),B.dispatchEvent("paste",{},e))},Rt=e=>{var{keyboardConfig:t,mouseConfig:l}=H,{editStore:r,filterStore:o}=W,a=K["isActivated"],i=ae.value,n=ie.value,r=r["actived"];a&&!o.visible&&(r.row||r.column||t&&n.isClip&&l&&i.area&&ue.handleCopyCellAreaEvent&&ue.handleCopyCellAreaEvent(e),B.dispatchEvent("copy",{},e))},Tt=e=>{var{keyboardConfig:t,mouseConfig:l}=H,{editStore:r,filterStore:o}=W,a=K["isActivated"],i=ae.value,n=ie.value,r=r["actived"];a&&!o.visible&&(r.row||r.column||t&&n.isClip&&l&&i.area&&ue.handleCutCellAreaEvent&&ue.handleCutCellAreaEvent(e),B.dispatchEvent("cut",{},e))},yt=()=>{ue.closeMenu&&ue.closeMenu();var e=X.value;if(!e||!e.clientWidth)return(0,_vue.nextTick)();B.updateCellAreas(),B.recalculate(!0)},St=e=>{var t=G.value;clearTimeout(K.tooltipTimeout),e?B.closeTooltip():t&&t.setActived&&t.setActived(!0)},Dt=(e,t,l,r,o)=>{o.cell=t;var t=W["tooltipStore"],{column:a,row:i}=o,{showAll:n,contentMethod:u}=c.value,o=u?u(o):null,u=u&&!_xeUtils.default.eqNull(o);const s=u?o:_xeUtils.default.toString("html"===a.type?l.innerText:l.textContent).trim(),d=l.scrollWidth>l.clientWidth;return s&&(n||u||d)&&(Object.assign(t,{row:i,column:a,visible:!0,currOpts:{}}),(0,_vue.nextTick)(()=>{var e=G.value;e&&e.open&&e.open(!d&&r||l,(0,_utils.formatText)(s))})),(0,_vue.nextTick)()},Mt=(Y={getSetupOptions(){return getConfig()},updateAfterDataIndex:Ye,callSlot(e,t){if(e){if(ee)return ee.callSlot(e,t);if(_xeUtils.default.isFunction(e))return(0,_vn.getSlotVNs)(e(t))}return[]},getParentElem(){var e,t=X.value;return ee?(e=ee.getRefMaps().refElem.value)?e.parentNode:null:t?t.parentNode:null},getParentHeight(){var e=H["height"],t=X.value;return t?(t=t.parentNode,e="fill"===e||"auto"===e?(0,_dom.getPaddingTopBottomSize)(t):0,Math.floor(ee?ee.getParentHeight():_xeUtils.default.toNumber(getComputedStyle(t).height)-e)):0},getExcludeHeight(){return ee?ee.getExcludeHeight():0},defineField(e){const t=H["treeConfig"],l=T.value,r=ne.value,a=R.value,i=re.value,n=r.children||r.childrenField,u=(0,_util.getRowkey)(ue);return(e=_xeUtils.default.isArray(e)?e:[e]).map(o=>{return K.tableFullColumn.forEach(t=>{var{field:l,editRender:r}=t;if(l&&!_xeUtils.default.has(o,l)&&!o[l]){let e=null;r&&(r=r["defaultValue"],_xeUtils.default.isFunction(r)?e=r({column:t}):_xeUtils.default.isUndefined(r)||(e=r)),_xeUtils.default.set(o,l,e)}}),[a.labelField,i.checkField,i.labelField,l.labelField].forEach(e=>{e&&(0,_utils.eqEmptyValue)(_xeUtils.default.get(o,e))&&_xeUtils.default.set(o,e,null)}),t&&r.lazy&&_xeUtils.default.isUndefined(o[n])&&(o[n]=null),(0,_utils.eqEmptyValue)(_xeUtils.default.get(o,u))&&_xeUtils.default.set(o,u,(0,_util.getRowUniqueId)()),o})},handleTableData(l){var e=W["scrollYLoad"];const{scrollYStore:t,fullDataRowIdData:r}=K;let o=K.afterFullData;if(l){{var l=H["treeConfig"],{tableFullColumn:a,tableFullData:i,tableFullTreeData:u}=K,s=S.value,d=w.value,c=ne.value,v=c["transform"];const{remote:g,filterMethod:f}=s,{remote:h,sortMethod:m,multiple:p,chronological:x}=d;let e=[],t=[];if(g&&h)l&&v?(t=_xeUtils.default.searchTree(u,()=>!0,Object.assign(Object.assign({},c),{original:!0})),e=t):(e=(l?u:i).slice(0),t=e);else{const _=[];let n=[];a.forEach(e=>{var{field:t,sortable:l,order:r,filters:o}=e;if(!g&&o&&o.length){const a=[],i=[];o.forEach(e=>{e.checked&&(i.push(e),a.push(e.value))}),i.length&&_.push({column:e,valueList:a,itemList:i})}!h&&l&&r&&n.push({column:e,field:t,property:t,order:r,sortTime:e.sortTime})}),p&&x&&1<n.length&&(n=_xeUtils.default.orderBy(n,"sortTime")),!g&&_.length?(s=s=>_.every(({column:t,valueList:e,itemList:l})=>{const{filterMethod:r,filterRender:o}=t;var a=(0,_utils.isEnableConf)(o)?renderer.get(o.name):null;const i=a?a.tableFilterMethod||a.filterMethod:null,n=a?a.defaultTableFilterMethod||a.defaultFilterMethod:null,u=(0,_util.getCellValue)(s,t);return r?l.some(e=>r({value:e.value,option:e,cellValue:u,row:s,column:t,$table:ue})):i?l.some(e=>i({value:e.value,option:e,cellValue:u,row:s,column:t,$table:ue})):f?f({options:l,values:e,cellValue:u,row:s,column:t}):n?l.some(e=>n({value:e.value,option:e,cellValue:u,row:s,column:t,$table:ue})):-1<e.indexOf(_xeUtils.default.get(s,t.field))}),l&&v?(t=_xeUtils.default.searchTree(u,s,Object.assign(Object.assign({},c),{original:!0})),e=t):(e=(l?u:i).filter(s),t=e)):l&&v?(t=_xeUtils.default.searchTree(u,()=>!0,Object.assign(Object.assign({},c),{original:!0})),e=t):(e=(l?u:i).slice(0),t=e),!h&&n.length&&(l&&v?(t=m?(d=m({data:t,sortList:n,$table:ue}),_xeUtils.default.isArray(d)?d:t):_xeUtils.default.orderBy(t,n.map(({column:e,order:t})=>[Be(e),t])),e=t):(e=m?(a=m({data:e,sortList:n,$table:ue}),_xeUtils.default.isArray(a)?a:e):_xeUtils.default.orderBy(e,n.map(({column:e,order:t})=>[Be(e),t])),t=e))}K.afterFullData=e,K.afterTreeFullData=t,Ye()}o=n()}s=e?o.slice(t.startIndex,t.endIndex):o.slice(0);return s.forEach((e,t)=>{e=(0,_util.getRowid)(ue,e),e=r[e];e&&(e.$index=t)}),W.tableData=s,(0,_vue.nextTick)()},cacheRowMap(n){const u=H["treeConfig"];var e=ne.value;let{fullDataRowIdData:s,fullAllDataRowIdData:d,tableFullData:t,tableFullTreeData:l}=K;const c=e.children||e.childrenField,v=e.hasChild||e.hasChildField,g=(0,_util.getRowkey)(ue),f=u&&e.lazy;e=(e,t,l,r,o,a)=>{let i=(0,_util.getRowid)(ue,e);r=u&&r?(0,_util.toTreePathSeq)(r):t+1,a=a?a.length-1:0,(0,_utils.eqEmptyValue)(i)&&(i=(0,_util.getRowUniqueId)(),_xeUtils.default.set(e,g,i)),f&&e[v]&&_xeUtils.default.isUndefined(e[c])&&(e[c]=null),e={row:e,rowid:i,seq:r,index:u&&o?-1:t,_index:-1,$index:-1,items:l,parent:o,level:a};n&&(s[i]=e),d[i]=e};n&&(s=K.fullDataRowIdData={}),d=K.fullAllDataRowIdData={},u?_xeUtils.default.eachTree(l,e,{children:c}):t.forEach(e)},cacheSourceMap(e){var t=H["treeConfig"],l=ne.value;let r=K["sourceDataRowIdData"];e=_xeUtils.default.clone(e,!0);const o=(0,_util.getRowkey)(ue);r=K.sourceDataRowIdData={};var a=e=>{let t=(0,_util.getRowid)(ue,e);(0,_utils.eqEmptyValue)(t)&&(t=(0,_util.getRowUniqueId)(),_xeUtils.default.set(e,o,t)),r[t]=e};t?(t=l.children||l.childrenField,_xeUtils.default.eachTree(e,a,{children:l.transform?l.mapChildrenField:t})):e.forEach(a),K.tableSourceData=e},analyColumnWidth(){var e=K["tableFullColumn"];const{width:t,minWidth:l}=te.value,r=[],o=[],a=[],i=[],n=[],u=[],s=[],d=[];e.forEach(e=>{t&&!e.width&&(e.width=t),l&&!e.minWidth&&(e.minWidth=l),e.visible&&(e.resizeWidth?r:"auto"===e.width?s:(0,_dom.isPx)(e.width)?o:(0,_dom.isScale)(e.width)?n:(0,_dom.isPx)(e.minWidth)?a:"auto"===e.minWidth?i:(0,_dom.isScale)(e.minWidth)?u:d).push(e)}),Object.assign(W.columnStore,{resizeList:r,pxList:o,pxMinList:a,autoMinList:i,scaleList:n,scaleMinList:u,autoList:s,remainList:d})},saveCustomStore(e){var t=u.value,{updateStore:l,storage:r}=h.value,o=!0===r,r=o?{}:Object.assign({},r||{}),a=o||r.resizable,i=o||r.visible,n=o||r.fixed,o=o||r.sort;if(a||i||n||o){if(!t)return(0,_log.errLog)("vxe.error.reqProp",["id"]),(0,_vue.nextTick)();r="reset"===e?{resizableData:{},sortData:{},visibleData:{},fixedData:{}}:B.getCustomStoreData();if(l)return l({id:t,type:e,storeData:r});a=t,i="reset"===e?null:r,n=getConfig().version,(o=Fe())[a]=i||void 0,o._v=n,localStorage.setItem(customStorageKey,_xeUtils.default.toJSONString(o))}return(0,_vue.nextTick)()},handleCustom(){var e=H["mouseConfig"];return e&&(ue.clearSelected&&ue.clearSelected(),ue.clearCellAreas)&&(ue.clearCellAreas(),ue.clearCopyCellArea()),Y.analyColumnWidth(),B.refreshColumn(!0)},handleUpdateDataQueue(){W.upDataFlag++},handleRefreshColumnQueue(){W.reColumnFlag++},preventEvent(t,e,l,r,o){let a=interceptor.get(e);a.length||"event.clearEdit"!==e||(a=interceptor.get("event.clearActived"),"development"===process.env.NODE_ENV&&a.length&&(0,_log.warnLog)("vxe.error.delEvent",["event.clearActived","event.clearEdit"]));let i;return a.some(e=>!1===e(Object.assign({$grid:ee,$table:ue,$event:t},l)))||r&&(i=r()),o&&o(),i},checkSelectionStatus(){var r=H["treeConfig"];const{selectCheckboxMaps:o,treeIndeterminateMaps:a}=W;var i=K["afterFullData"],e=re.value;const{checkField:n,checkStrictly:t,checkMethod:u}=e,s=e.indeterminateField||e.halfField;if(!t){const d=[],c=[];let e=!1,t=!1,l=!1;l=n?(e=i.every(u?e=>u({row:e})?!!_xeUtils.default.get(e,n)&&(c.push(e),!0):(d.push(e),!0):e=>_xeUtils.default.get(e,n)),t=e&&i.length!==d.length,r?s?!t&&i.some(e=>_xeUtils.default.get(e,n)||_xeUtils.default.get(e,s)||!!a[(0,_util.getRowid)(ue,e)]):!t&&i.some(e=>_xeUtils.default.get(e,n)||!!a[(0,_util.getRowid)(ue,e)]):s?!t&&i.some(e=>_xeUtils.default.get(e,n)||_xeUtils.default.get(e,s)):!t&&i.some(e=>_xeUtils.default.get(e,n))):(e=i.every(u?e=>u({row:e})?!!o[(0,_util.getRowid)(ue,e)]&&(c.push(e),!0):(d.push(e),!0):e=>o[(0,_util.getRowid)(ue,e)]),t=e&&i.length!==d.length,r?!t&&i.some(e=>{e=(0,_util.getRowid)(ue,e);return a[e]||o[e]}):!t&&i.some(e=>o[(0,_util.getRowid)(ue,e)])),W.isAllSelected=t,W.isIndeterminate=l}},handleSelectRow({row:l},r,o){var e=H["treeConfig"];const{selectCheckboxMaps:t,treeIndeterminateMaps:a}=W,i=Object.assign({},t);var n=K["afterFullData"],u=ne.value,u=u.children||u.childrenField,s=re.value;const{checkField:d,checkStrictly:c,checkMethod:v}=s,g=s.indeterminateField||s.halfField;s=(0,_util.getRowid)(ue,l);if(d)if(e&&!c){-1===r?(a[s]||(g&&_xeUtils.default.set(l,g,!0),a[s]=l),_xeUtils.default.set(l,d,!1)):_xeUtils.default.eachTree([l],e=>{(ue.eqRow(e,l)||o||!v||v({row:e}))&&(_xeUtils.default.set(e,d,r),g&&_xeUtils.default.set(l,g,!1),delete a[(0,_util.getRowid)(ue,e)],b(l,r))},{children:u});var f=_xeUtils.default.findTree(n,e=>ue.eqRow(e,l),{children:u});if(f&&f.parent){let e;const h=[],m={};if(!o&&v?f.items.forEach(e=>{var t;v({row:e})&&(t=(0,_util.getRowid)(ue,e),m[t]=e,h.push(e))}):f.items.forEach(e=>{var t=(0,_util.getRowid)(ue,e);m[t]=e,h.push(e)}),_xeUtils.default.find(f.items,e=>!!a[(0,_util.getRowid)(ue,e)]))e=-1;else{const p=[];f.items.forEach(e=>{_xeUtils.default.get(e,d)&&p.push(e)}),e=p.filter(e=>m[(0,_util.getRowid)(ue,e)]).length===h.length||!(!p.length&&-1!==r)&&-1}return W.selectCheckboxMaps=i,Y.handleSelectRow({row:f.parent},e,o)}}else!o&&v&&!v({row:l})||(_xeUtils.default.set(l,d,r),b(l,r));else if(e&&!c){-1===r?(a[s]||(g&&_xeUtils.default.set(l,g,!0),a[s]=l),i[s]&&delete i[s]):_xeUtils.default.eachTree([l],e=>{var t=(0,_util.getRowid)(ue,e);(ue.eqRow(e,l)||o||!v||v({row:e}))&&(r?i[t]=e:i[t]&&delete i[t],g&&_xeUtils.default.set(l,g,!1),delete a[(0,_util.getRowid)(ue,e)],b(l,r))},{children:u});f=_xeUtils.default.findTree(n,e=>ue.eqRow(e,l),{children:u});if(f&&f.parent){let e;const x=[],_={};if(!o&&v?f.items.forEach(e=>{var t;v({row:e})&&(t=(0,_util.getRowid)(ue,e),_[t]=e,x.push(e))}):f.items.forEach(e=>{var t=(0,_util.getRowid)(ue,e);_[t]=e,x.push(e)}),_xeUtils.default.find(f.items,e=>!!a[(0,_util.getRowid)(ue,e)]))e=-1;else{const w=[];f.items.forEach(e=>{var t=(0,_util.getRowid)(ue,e);i[t]&&w.push(e)}),e=w.filter(e=>_[(0,_util.getRowid)(ue,e)]).length===x.length||!(!w.length&&-1!==r)&&-1}return W.selectCheckboxMaps=i,Y.handleSelectRow({row:f.parent},e,o)}}else!o&&v&&!v({row:l})||(r?i[s]||(i[s]=l):i[s]&&delete i[s],b(l,r));W.selectCheckboxMaps=i,Y.checkSelectionStatus()},triggerHeaderTitleEvent(t,e,l){var r=e.content||e.message;if(r){var o=W["tooltipStore"],l=l["column"];const a=(0,_utils.getFuncText)(r);St(!0),o.row=null,o.column=l,o.visible=!0,o.currOpts=e,(0,_vue.nextTick)(()=>{var e=G.value;e&&e.open&&e.open(t.currentTarget,a)})}},triggerHeaderTooltipEvent(e,t){var l=W["tooltipStore"],r=t["column"],e=e.currentTarget;St(!0),l.column===r&&l.visible||Dt(0,e,e,null,t)},triggerBodyTooltipEvent(l,r){var e=H["editConfig"],t=W["editStore"],o=W["tooltipStore"],a=oe.value,t=t["actived"],{row:i,column:n}=r,l=l.currentTarget;if(St(o.column!==n||o.row!==i),n.editRender&&(0,_utils.isEnableConf)(e)){if("row"===a.mode&&t.row===i)return;if(t.row===i&&t.column===n)return}if(o.column!==n||o.row!==i||!o.visible){let e,t;n.treeNode?(e=l.querySelector(".vxe-tree-cell"),"html"===n.type&&(t=l.querySelector(".vxe-cell--html"))):t=l.querySelector("html"===n.type?".vxe-cell--html":".vxe-cell--label"),Dt(0,l,e||l.children[0],t,r)}},triggerFooterTooltipEvent(e,t){var l=t["column"],r=W["tooltipStore"],e=e.currentTarget;St(r.column!==l||!!r.row),r.column===l&&r.visible||Dt(0,e,e.querySelector(".vxe-cell--item")||e.children[0],null,t)},handleTargetLeaveEvent(){var e=c.value;let t=G.value;t&&t.setActived&&t.setActived(!1),e.enterable?K.tooltipTimeout=setTimeout(()=>{(t=G.value)&&t.isActived&&!t.isActived()&&B.closeTooltip()},e.leaveDelay):B.closeTooltip()},triggerHeaderCellClickEvent(e,t){var l=K["_lastResizeTime"],r=w.value,o=te.value,a=t["column"],i=e.currentTarget,l=l&&l>Date.now()-300,n=(0,_dom.getEventTargetNode)(e,i,"vxe-cell--sort").flag,u=(0,_dom.getEventTargetNode)(e,i,"vxe-cell--filter").flag;"cell"!==r.trigger||l||n||u||Y.triggerSortEvent(e,a,Ie(a)),B.dispatchEvent("header-cell-click",Object.assign({triggerResizable:l,triggerSort:n,triggerFilter:u,cell:i},t),e),(o.isCurrent||H.highlightCurrentColumn)&&Y.triggerCurrentColumnEvent(e,t)},triggerHeaderCellDblclickEvent(e,t){B.dispatchEvent("header-cell-dblclick",Object.assign({cell:e.currentTarget},t),e)},triggerCellClickEvent(e,t){var{highlightCurrentRow:l,editConfig:r}=H,o=W["editStore"],a=T.value,i=oe.value,n=ne.value,u=R.value,s=re.value,d=ie.value,c=le.value,{actived:o,focused:v}=o,{row:g,column:f}=t,{type:h,treeNode:m}=f,p="radio"===h,x="checkbox"===h,h="expand"===h,_=e.currentTarget,w=p&&(0,_dom.getEventTargetNode)(e,_,"vxe-cell--radio").flag,C=x&&(0,_dom.getEventTargetNode)(e,_,"vxe-cell--checkbox").flag,b=m&&(0,_dom.getEventTargetNode)(e,_,"vxe-tree--btn-wrapper").flag,E=h&&(0,_dom.getEventTargetNode)(e,_,"vxe-table--expanded").flag;t=Object.assign({cell:_,triggerRadio:w,triggerCheckbox:C,triggerTreeNode:b,triggerExpandNode:E},t),!C&&!w&&(!E&&("row"===a.trigger||h&&"cell"===a.trigger)&&Y.triggerRowExpandEvent(e,t),"row"===n.trigger||m&&"cell"===n.trigger)&&Y.triggerTreeExpandEvent(e,t),b||(E||(!c.isCurrent&&!l||C||w||Y.triggerCurrentRowEvent(e,t),!w&&("row"===u.trigger||p&&"cell"===u.trigger)&&Y.triggerRadioRowEvent(e,t),!C&&("row"===s.trigger||x&&"cell"===s.trigger)&&Y.handleToggleCheckRowEvent(e,t)),(0,_utils.isEnableConf)(r)&&(d.arrowCursorLock&&e&&"cell"===i.mode&&e.target&&/^input|textarea$/i.test(e.target.tagName)&&(v.column=f,v.row=g),"manual"===i.trigger?o.args&&o.row===g&&f!==o.column&&Ge(e,t):o.args&&g===o.row&&f===o.column||("click"===i.trigger||"dblclick"===i.trigger&&"row"===i.mode&&o.row===g)&&Ge(e,t))),B.dispatchEvent("cell-click",t,e)},triggerCellDblclickEvent(e,t){var l=H["editConfig"],r=W["editStore"],o=oe.value,r=r["actived"],a=e.currentTarget;t=Object.assign({cell:a},t),!(0,_utils.isEnableConf)(l)||"dblclick"!==o.trigger||r.args&&e.currentTarget===r.args.cell||("row"===o.mode?Xe("blur").catch(e=>e).then(()=>{ue.handleActived(t,e).then(()=>Xe("change")).catch(e=>e)}):"cell"===o.mode&&ue.handleActived(t,e).then(()=>Xe("change")).catch(e=>e)),B.dispatchEvent("cell-dblclick",t,e)},handleToggleCheckRowEvent(t,l){var r=W["selectCheckboxMaps"],{checkField:o,trigger:e}=re.value,a=l["row"];if("manual"!==e){let e=!1;e=o?!_xeUtils.default.get(a,o):!r[(0,_util.getRowid)(ue,a)],t?Y.triggerCheckRowEvent(t,l,e):Y.handleSelectRow(l,e)}},triggerCheckRowEvent(e,t,l){var r=re.value,o=t["row"],a=K["afterFullData"],{checkMethod:i,trigger:n}=r;if("manual"!==n){if(e.stopPropagation(),r.isShiftKey&&e.shiftKey&&!H.treeConfig){n=B.getCheckboxRecords();if(n.length){r=n[0],n=B.getVTRowIndex(o),r=B.getVTRowIndex(r);if(n!==r)return B.setAllCheckboxRow(!1),a=n<r?a.slice(n,r+1):a.slice(r,n+1),E(a,!0,!1),void B.dispatchEvent("checkbox-range-select",Object.assign({rangeRecords:a},t),e)}}i&&!i({row:o})||(Y.handleSelectRow(t,l),B.dispatchEvent("checkbox-change",Object.assign({records:B.getCheckboxRecords(),reserves:B.getCheckboxReserveRecords(),indeterminates:B.getCheckboxIndeterminateRecords(),checked:l},t),e))}},triggerCheckAllEvent(e,t){var l=re.value["trigger"];"manual"!==l&&(e&&e.stopPropagation(),ft(e,t))},triggerRadioRowEvent(l,r){var o=W["selectRadioRow"],a=r["row"],i=R.value,e=i["trigger"];if("manual"!==e){l.stopPropagation();let e=a,t=o!==e;t?Ze(e):i.strict||(t=o===e)&&(e=null,B.clearRadioRow()),t&&B.dispatchEvent("radio-change",Object.assign({oldValue:o,newValue:e},r),l)}},triggerCurrentColumnEvent(e,t){var l=te.value["currentMethod"],t=t["column"];l&&!l({column:t})||B.setCurrentColumn(t)},triggerCurrentRowEvent(e,t){var l=W["currentRow"],r=le.value["currentMethod"],o=t["row"],a=l!==o;r&&!r({row:o})||(B.setCurrentRow(o),a&&B.dispatchEvent("current-change",Object.assign({oldValue:l,newValue:o},t),e))},triggerRowExpandEvent(e,t){var{rowExpandLazyLoadedMaps:l,expandColumn:r}=W,t=t["row"],{lazy:o,trigger:a}=T.value;"manual"===a||(e.stopPropagation(),a=(0,_util.getRowid)(ue,t),o&&l[a])||(o=!B.isRowExpandByRow(t),l=B.getColumnIndex(r),a=B.getVMColumnIndex(r),B.setRowExpand(t,o),B.dispatchEvent("toggle-row-expand",{expanded:o,column:r,columnIndex:l,$columnIndex:a,row:t,rowIndex:B.getRowIndex(t),$rowIndex:B.getVMRowIndex(t)},e))},triggerTreeExpandEvent(e,t){var l=W["treeExpandLazyLoadedMaps"],{row:t,column:r}=t,{lazy:o,trigger:a}=ne.value;"manual"===a||(e.stopPropagation(),a=(0,_util.getRowid)(ue,t),o&&l[a])||(o=!B.isTreeExpandByRow(t),l=B.getColumnIndex(r),a=B.getVMColumnIndex(r),B.setTreeExpand(t,o),B.dispatchEvent("toggle-tree-expand",{expanded:o,column:r,columnIndex:l,$columnIndex:a,row:t},e))},triggerSortEvent(e,t,l){var r=H["mouseConfig"],o=w.value,a=ae.value,{field:i,sortable:n}=t;n&&(l&&t.order!==l?B.sort({field:i,order:l}):B.clearSort(o.multiple?t:null),n={$table:ue,$event:e,column:t,field:i,property:i,order:t.order,sortList:B.getSortColumns(),sortTime:t.sortTime},r&&a.area&&ue.handleSortEvent&&ue.handleSortEvent(e,n),B.dispatchEvent("sort-change",n,e))},triggerScrollXEvent(){ut()},triggerScrollYEvent(e){var t=K["scrollYStore"],{adaptive:t,offsetSize:l,visibleSize:r}=t;(isWebkit&&t&&2*l+r<=40?ht:mt)(e)},scrollToTreeRow(t){var e=H["treeConfig"],l=K["tableFullData"];const r=[];if(e){e=ne.value,e=e.children||e.childrenField,l=_xeUtils.default.findTree(l,e=>ue.eqRow(e,t),{children:e});if(l){const o=l.nodes;o.forEach((e,t)=>{t<o.length-1&&!B.isTreeExpandByRow(e)&&r.push(B.setTreeExpand(e,!0))})}}return Promise.all(r).then(()=>(0,_util.rowToVisible)(ue,t))},updateScrollYStatus:vt,updateScrollXSpace(){const{isGroup:t,scrollXLoad:r,scrollbarWidth:o}=W,{visibleColumn:l,scrollXStore:a,elemStore:i,tableWidth:n}=K;var u=Z.value,s=J.value,d=Q.value,s=s?s.$el:null;if(s){var u=u?u.$el:null,d=d?d.$el:null,u=u?u.querySelector(".vxe-table--header"):null,s=s.querySelector(".vxe-table--body"),d=d?d.querySelector(".vxe-table--footer"):null,c=l.slice(0,a.startIndex).reduce((e,t)=>e+t.renderWidth,0);let e="";r&&(e=c+"px"),u&&(u.style.marginLeft=t?"":e),s.style.marginLeft=e,d&&(d.style.marginLeft=e),["main"].forEach(l=>{["header","body","footer"].forEach(e=>{var t=i[l+`-${e}-xSpace`],t=t?t.value:null;t&&(t.style.width=r?n+("header"===e?o:0)+"px":"")})}),(0,_vue.nextTick)(C)}},updateScrollYSpace(){var e=W["scrollYLoad"];const{scrollYStore:t,elemStore:l,afterFullData:r}=K;var{startIndex:o,rowHeight:a}=t,i=r.length*a,o=Math.max(0,o*a);let n="",u="";e&&(n=o+"px",u=i+"px"),["main","left","right"].forEach(t=>{var e=l[t+"-body-table"],e=e?e.value:null;e&&(e.style.marginTop=n),["header","body","footer"].forEach(e=>{e=l[t+`-${e}-ySpace`],e=e?e.value:null;e&&(e.style.height=u)})}),(0,_vue.nextTick)(C)},updateScrollXData(){(0,_vue.nextTick)(()=>{nt(),Y.updateScrollXSpace()})},updateScrollYData(){(0,_vue.nextTick)(()=>{Y.handleTableData(),Y.updateScrollYSpace()})},checkScrolling(){var e=$.value,t=z.value,l=J.value,l=l?l.$el:null;l&&(e&&(0<l.scrollLeft?(0,_dom.addClass):(0,_dom.removeClass))(e,"scrolling--middle"),t)&&(l.clientWidth<l.scrollWidth-Math.ceil(l.scrollLeft)?(0,_dom.addClass):(0,_dom.removeClass))(t,"scrolling--middle")},updateZindex(){H.zIndex?K.tZindex=H.zIndex:K.tZindex<(0,_utils.getLastZIndex)()&&(K.tZindex=(0,_utils.nextZIndex)())},handleCheckedCheckboxRow:E,triggerHoverEvent(e,{row:t}){Y.setHoverRow(t)},setHoverRow(e){var t=(0,_util.getRowid)(ue,e),l=X.value;Y.clearHoverRow(),l&&_xeUtils.default.arrayEach(l.querySelectorAll(`[rowid="${t}"]`),e=>(0,_dom.addClass)(e,"row--hover")),K.hoverRow=e},clearHoverRow(){var e=X.value;e&&_xeUtils.default.arrayEach(e.querySelectorAll(".vxe-body--row.row--hover"),e=>(0,_dom.removeClass)(e,"row--hover")),K.hoverRow=null},getCell(e,t){return B.getCellElement(e,t)},findRowIndexOf(e,t){return t?_xeUtils.default.findIndexOf(e,e=>ue.eqRow(e,t)):-1},eqRow(e,t){return!(!e||!t||e!==t&&(0,_util.getRowid)(ue,e)!==(0,_util.getRowid)(ue,t))}},"development"===process.env.NODE_ENV&&("openExport,openPrint,exportData,openImport,importData,saveFile,readFile,importByFile,print".split(",").forEach(e=>{ue[e]=function(){(0,_log.errLog)("vxe.error.reqModule",["VxeTableExportModule"])}}),"clearValidate,fullValidate,validate".split(",").forEach(e=>{ue[e]=function(){(0,_log.errLog)("vxe.error.reqModule",["VxeTableValidatorModule"])}})),Object.assign(ue,B,Y),e=>{var{showHeader:t,showFooter:l}=H,{tableData:r,tableColumn:o,tableGroupColumn:a,columnStore:i,footerTableData:n}=W,u="left"===e,i=u?i.leftList:i.rightList;return(0,_vue.h)("div",{ref:u?$:z,class:`vxe-table--fixed-${e}-wrapper`},[t?(0,_vue.h)(_header.default,{ref:u?s:f,fixedType:e,tableData:r,tableColumn:o,tableGroupColumn:a,fixedColumn:i}):(0,_vue.createCommentVNode)(),(0,_vue.h)(_body.default,{ref:u?v:d,fixedType:e,tableData:r,tableColumn:o,fixedColumn:i}),l?(0,_vue.h)(_footer.default,{ref:u?g:p,footerTableData:n,tableColumn:o,fixedColumn:i,fixedType:e}):(0,_vue.createCommentVNode)()])});function Lt(){var e=X.value;e&&e.clientWidth&&e.clientHeight&&B.recalculate()}const kt=(0,_vue.ref)(0),It=((0,_vue.watch)(()=>H.data?H.data.length:-1,()=>{kt.value++}),(0,_vue.watch)(()=>H.data,()=>{kt.value++}),(0,_vue.watch)(kt,()=>{const{inited:r,initStatus:o}=K;ot(H.data||[]).then(()=>{var{scrollXLoad:e,scrollYLoad:t,expandColumn:l}=W;K.inited=!0,K.initStatus=!0,o||at(),r||it(),"development"===process.env.NODE_ENV&&(e||t)&&l&&(0,_log.warnLog)("vxe.error.scrollErrProp",["column.type=expand"]),B.recalculate()})}),(0,_vue.ref)(0)),Ft=((0,_vue.watch)(()=>W.staticColumns.length,()=>{It.value++}),(0,_vue.watch)(()=>W.staticColumns,()=>{It.value++}),(0,_vue.watch)(It,()=>{ct(W.staticColumns)}),(0,_vue.ref)(0)),Ut=((0,_vue.watch)(()=>W.tableColumn.length,()=>{Ft.value++}),(0,_vue.watch)(()=>W.tableColumn,()=>{Ft.value++}),(0,_vue.watch)(Ft,()=>{Y.analyColumnWidth()}),(0,_vue.watch)(()=>W.upDataFlag,()=>{(0,_vue.nextTick)(()=>{B.updateData()})}),(0,_vue.watch)(()=>W.reColumnFlag,()=>{(0,_vue.nextTick)(()=>{B.refreshColumn()})}),(0,_vue.watch)(()=>H.showHeader,()=>{(0,_vue.nextTick)(()=>{B.recalculate(!0).then(()=>B.refreshScroll())})}),(0,_vue.watch)(()=>H.showFooter,()=>{(0,_vue.nextTick)(()=>{B.recalculate(!0).then(()=>B.refreshScroll())})}),(0,_vue.ref)(0)),Ot=((0,_vue.watch)(()=>H.footerData?H.footerData.length:-1,()=>{Ut.value++}),(0,_vue.watch)(()=>H.footerData,()=>{Ut.value++}),(0,_vue.watch)(Ut,()=>{B.updateFooter()}),(0,_vue.watch)(()=>H.height,()=>{(0,_vue.nextTick)(()=>B.recalculate(!0))}),(0,_vue.watch)(()=>H.maxHeight,()=>{(0,_vue.nextTick)(()=>B.recalculate(!0))}),(0,_vue.watch)(()=>H.syncResize,e=>{e&&(Lt(),(0,_vue.nextTick)(()=>{Lt(),setTimeout(()=>Lt())}))}),(0,_vue.ref)(0)),At=((0,_vue.watch)(()=>H.mergeCells?H.mergeCells.length:-1,()=>{Ot.value++}),(0,_vue.watch)(()=>H.mergeCells,()=>{Ot.value++}),(0,_vue.watch)(Ot,()=>{B.clearMergeCells(),(0,_vue.nextTick)(()=>{H.mergeCells&&B.setMergeCells(H.mergeCells)})}),(0,_vue.ref)(0));(0,_vue.watch)(()=>H.mergeFooterItems?H.mergeFooterItems.length:-1,()=>{At.value++}),(0,_vue.watch)(()=>H.mergeFooterItems,()=>{At.value++}),(0,_vue.watch)(At,()=>{B.clearMergeFooterItems(),(0,_vue.nextTick)(()=>{H.mergeFooterItems&&B.setMergeFooterItems(H.mergeFooterItems)})}),a&&(0,_vue.watch)(()=>a?a.reactData.resizeFlag:null,()=>{yt()}),hooks.forEach(e=>{var e=e["setupTable"];e&&(e=e(ue))&&_xeUtils.default.isObject(e)&&Object.assign(ue,e)}),Y.preventEvent(null,"created",{$table:ue});let Nt;(0,_vue.onActivated)(()=>{B.recalculate().then(()=>B.refreshScroll()),Y.preventEvent(null,"activated",{$table:ue})}),(0,_vue.onDeactivated)(()=>{K.isActivated=!1,Y.preventEvent(null,"deactivated",{$table:ue})}),(0,_vue.onMounted)(()=>{(0,_vue.nextTick)(()=>{const{data:e,treeConfig:t,showOverflow:l}=H;var{scrollXStore:r,scrollYStore:o}=K,a=_.value,i=oe.value,n=ne.value,u=R.value,s=re.value,d=T.value;const c=le.value;if("development"===process.env.NODE_ENV){H.rowId&&(0,_log.warnLog)("vxe.error.delProp",["row-id","row-config.keyField"]),H.rowKey&&(0,_log.warnLog)("vxe.error.delProp",["row-key","row-config.useKey"]),H.columnKey&&(0,_log.warnLog)("vxe.error.delProp",["column-id","column-config.useKey"]),H.rowId||c.keyField||!(s.reserve||s.checkRowKeys||u.reserve||u.checkRowKey||d.expandRowKeys||n.expandRowKeys)||(0,_log.warnLog)("vxe.error.reqProp",["row-config.keyField"]),H.editConfig&&(i.showStatus||i.showUpdateStatus||i.showInsertStatus)&&!H.keepSource&&(0,_log.warnLog)("vxe.error.reqProp",["keep-source"]),!t||!n.showLine&&!n.line||(H.rowKey||c.useKey)&&l||(0,_log.warnLog)("vxe.error.reqProp",["row-config.useKey | show-overflow"]),t&&H.stripe&&(0,_log.warnLog)("vxe.error.noTree",["stripe"]),!H.showFooter||H.footerMethod||H.footerData||(0,_log.warnLog)("vxe.error.reqProp",["footer-data | footer-method"]);var{exportConfig:u,importConfig:d}=H;const v=F.value,g=U.value;d&&g.types&&!g.importMethod&&!_xeUtils.default.includeArrays(_xeUtils.default.keys(g._typeMaps),g.types)&&(0,_log.warnLog)("vxe.error.errProp",["export-config.types="+g.types.join(","),g.types.filter(e=>_xeUtils.default.includes(_xeUtils.default.keys(g._typeMaps),e)).join(",")||_xeUtils.default.keys(g._typeMaps).join(",")]),u&&v.types&&!v.exportMethod&&!_xeUtils.default.includeArrays(_xeUtils.default.keys(v._typeMaps),v.types)&&(0,_log.warnLog)("vxe.error.errProp",["export-config.types="+v.types.join(","),v.types.filter(e=>_xeUtils.default.includes(_xeUtils.default.keys(v._typeMaps),e)).join(",")||_xeUtils.default.keys(v._typeMaps).join(",")])}if("development"===process.env.NODE_ENV){d=h.value,u=ae.value;const c=le.value;if(!H.id&&H.customConfig&&(!0===d.storage||d.storage&&d.storage.resizable||d.storage&&d.storage.visible)&&(0,_log.errLog)("vxe.error.reqProp",["id"]),H.treeConfig&&s.range&&(0,_log.errLog)("vxe.error.noTree",["checkbox-config.range"]),c.height&&!H.showOverflow&&(0,_log.warnLog)("vxe.error.notProp",["table.show-overflow"]),!ue.handleUpdateCellAreas&&(H.clipConfig&&(0,_log.warnLog)("vxe.error.notProp",["clip-config"]),H.fnrConfig&&(0,_log.warnLog)("vxe.error.notProp",["fnr-config"]),u.area))return void(0,_log.errLog)("vxe.error.notProp",["mouse-config.area"]);H.treeConfig&&n.children&&(0,_log.warnLog)("vxe.error.delProp",["tree-config.children","tree-config.childrenField"]),H.treeConfig&&n.line&&(0,_log.warnLog)("vxe.error.delProp",["tree-config.line","tree-config.showLine"]),u.area&&u.selected&&(0,_log.warnLog)("vxe.error.errConflicts",["mouse-config.area","mouse-config.selected"]),H.treeConfig&&u.area&&(0,_log.errLog)("vxe.error.noTree",["mouse-config.area"]),H.editConfig&&i.activeMethod&&(0,_log.warnLog)("vxe.error.delProp",["edit-config.activeMethod","edit-config.beforeEditMethod"]),H.treeConfig&&s.isShiftKey&&(0,_log.errLog)("vxe.error.errConflicts",["tree-config","checkbox-config.isShiftKey"]),s.halfField&&(0,_log.warnLog)("vxe.error.delProp",["checkbox-config.halfField","checkbox-config.indeterminateField"])}if("development"===process.env.NODE_ENV&&(H.editConfig&&!ue.insert&&(0,_log.errLog)("vxe.error.reqModule",["Edit"]),H.editRules&&!ue.validate&&(0,_log.errLog)("vxe.error.reqModule",["Validator"]),(s.range||H.keyboardConfig||H.mouseConfig)&&!ue.triggerCellMousedownEvent&&(0,_log.errLog)("vxe.error.reqModule",["Keyboard"]),H.printConfig||H.importConfig||H.exportConfig)&&!ue.exportData&&(0,_log.errLog)("vxe.error.reqModule",["Export"]),Object.assign(o,{startIndex:0,endIndex:0,visibleSize:0,adaptive:!1!==a.adaptive}),Object.assign(r,{startIndex:0,endIndex:0,visibleSize:0}),ot(e||[]).then(()=>{e&&e.length&&(K.inited=!0,K.initStatus=!0,at(),it()),C()}),H.autoResize){d=x.value["refreshDelay"],n=X.value,u=Y.getParentElem();const f=d?_xeUtils.default.throttle(()=>B.recalculate(!0),d,{leading:!0,trailing:!0}):null;Nt=globalResize.create(f?()=>{H.autoResize&&requestAnimationFrame(f)}:()=>{H.autoResize&&B.recalculate(!0)}),n&&Nt.observe(n),u&&Nt.observe(u)}}),globalEvents.on(ue,"paste",Et),globalEvents.on(ue,"copy",Rt),globalEvents.on(ue,"cut",Tt),globalEvents.on(ue,"mousedown",xt),globalEvents.on(ue,"blur",_t),globalEvents.on(ue,"mousewheel",wt),globalEvents.on(ue,"keydown",bt),globalEvents.on(ue,"resize",yt),ue.handleGlobalContextmenuEvent&&globalEvents.on(ue,"contextmenu",ue.handleGlobalContextmenuEvent),Y.preventEvent(null,"mounted",{$table:ue})}),(0,_vue.onBeforeUnmount)(()=>{Nt&&Nt.disconnect(),B.closeFilter(),ue.closeMenu&&ue.closeMenu(),Y.preventEvent(null,"beforeUnmount",{$table:ue})}),(0,_vue.onUnmounted)(()=>{globalEvents.off(ue,"paste"),globalEvents.off(ue,"copy"),globalEvents.off(ue,"cut"),globalEvents.off(ue,"mousedown"),globalEvents.off(ue,"blur"),globalEvents.off(ue,"mousewheel"),globalEvents.off(ue,"keydown"),globalEvents.off(ue,"resize"),globalEvents.off(ue,"contextmenu"),Y.preventEvent(null,"unmounted",{$table:ue})});return ue.renderVN=()=>{var{loading:e,stripe:t,showHeader:l,height:r,treeConfig:o,mouseConfig:a,showFooter:i,highlightCell:n,highlightHoverRow:u,highlightHoverColumn:s,editConfig:d,editRules:c}=H,{isCalcColumn:v,isGroup:g,overflowX:f,overflowY:h,scrollXLoad:m,scrollYLoad:p,scrollbarHeight:x,tableData:_,tableColumn:w,tableGroupColumn:C,footerTableData:b,initStore:E,columnStore:R,filterStore:T,customStore:y,tooltipStore:S}=W,{leftList:R,rightList:D}=R;const M=P.loading;var A=we.value,L=_e.value,N=re.value,k=ne.value,V=le.value,q=te.value,I=ce.value,F=De.value,U=ae.value,$=Ce.value,O=ye.value,z=Ee.value,e=W._isLoading||e;return(0,_vue.h)("div",{ref:X,class:["vxe-table","vxe-table--render-default","tid_"+se,"border--"+F,{["size--"+I]:I,["valid-msg--"+L.msgMode]:!!c,"vxe-editable":!!d,"old-cell-valid":c&&"obsolete"===getConfig().cellVaildMode,"cell--highlight":n,"cell--selected":a&&U.selected,"cell--area":a&&U.area,"row--highlight":V.isHover||u,"column--highlight":q.isHover||s,"checkbox--range":N.range,"column--calc":v,"is--header":l,"is--footer":i,"is--group":g,"is--tree-line":o&&(k.showLine||k.line),"is--fixed-left":R.length,"is--fixed-right":D.length,"is--animat":!!H.animat,"is--round":H.round,"is--stripe":!o&&t,"is--loading":e,"is--empty":!e&&!_.length,"is--scroll-y":h,"is--scroll-x":f,"is--virtual-x":m,"is--virtual-y":p}],spellcheck:!1,onKeydown:Ct},[(0,_vue.h)("div",{class:"vxe-table-slots"},P.default?P.default({}):[]),(0,_vue.h)("div",{class:"vxe-table--render-wrapper"},[(0,_vue.h)("div",{class:"vxe-table--main-wrapper"},[l?(0,_vue.h)(_header.default,{ref:Z,tableData:_,tableColumn:w,tableGroupColumn:C}):(0,_vue.createCommentVNode)(),(0,_vue.h)(_body.default,{ref:J,tableData:_,tableColumn:w}),i?(0,_vue.h)(_footer.default,{ref:Q,footerTableData:b,tableColumn:w}):(0,_vue.createCommentVNode)()]),(0,_vue.h)("div",{class:"vxe-table--fixed-wrapper"},[R&&R.length&&f?Mt("left"):(0,_vue.createCommentVNode)(),D&&D.length&&f?Mt("right"):(0,_vue.createCommentVNode)()])]),(0,_vue.h)("div",{ref:xe,class:"vxe-table--empty-placeholder"},[(0,_vue.h)("div",{class:"vxe-table--empty-content"},(F=Te.value,I={$table:ue},P.empty?P.empty(I):(d=(d=F.name?renderer.get(F.name):null)?d.renderTableEmpty||d.renderTableEmptyView||d.renderEmpty:null)?(0,_vn.getSlotVNs)(d(F,I)):(0,_utils.getFuncText)(H.emptyText)||getI18n("vxe.table.emptyText")))]),(0,_vue.h)("div",{class:"vxe-table--border-line"}),(0,_vue.h)("div",{ref:pe,class:"vxe-table--resizable-bar",style:f?{"padding-bottom":x+"px"}:null}),de?(0,_vue.h)(de,{class:"vxe-table--loading",modelValue:e,icon:O.icon,text:O.text},M?{default:()=>M({$table:ue,$grid:ee})}:{}):(0,_vue.createCommentVNode)(),E.custom?(0,_vue.h)(_panel.default,{ref:me,customStore:y}):(0,_vue.createCommentVNode)(),E.filter?(0,_vue.h)(_panel2.default,{ref:he,filterStore:T}):(0,_vue.createCommentVNode)(),E.import&&H.importConfig?(0,_vue.h)(_importPanel.default,{defaultOptions:W.importParams,storeData:W.importStore}):(0,_vue.createCommentVNode)(),E.export&&(H.exportConfig||H.printConfig)?(0,_vue.h)(_exportPanel.default,{defaultOptions:W.exportParams,storeData:W.exportStore}):(0,_vue.createCommentVNode)(),z?(0,_vue.h)(_panel3.default,{ref:fe}):(0,_vue.createCommentVNode)(),j?(0,_vue.h)("div",{},[(0,_vue.h)(j,{ref:ve,isArrow:!1,enterable:!1}),(0,_vue.h)(j,Object.assign({ref:G},A,S.currOpts)),H.editRules&&L.showMessage&&("default"===L.message?!r:"tooltip"===L.message)?(0,_vue.h)(j,Object.assign({ref:ge,class:[{"old-cell-valid":c&&"obsolete"===getConfig().cellVaildMode},"vxe-table--valid-error"]},"tooltip"===L.message||1===_.length?$:{})):(0,_vue.createCommentVNode)()]):(0,_vue.createCommentVNode)()])},"development"===process.env.NODE_ENV&&(0,_vue.nextTick)(()=>{H.loading&&!de&&(0,_log.errLog)("vxe.error.reqComp",["vxe-loading"]),!0!==H.showOverflow&&"tooltip"!==H.showOverflow&&!0!==H.showHeaderOverflow&&"tooltip"!==H.showHeaderOverflow&&!0!==H.showFooterOverflow&&"tooltip"!==H.showFooterOverflow&&!H.tooltipConfig&&!H.editRules||j||(0,_log.errLog)("vxe.error.reqComp",["vxe-tooltip"])}),(0,_vue.provide)("$xeColgroup",null),(0,_vue.provide)("$xeTable",ue),ue},render(){return this.renderVN()}});