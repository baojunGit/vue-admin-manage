"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _vue=require("vue"),_xeUtils=_interopRequireDefault(require("xe-utils")),_conf=_interopRequireDefault(require("../../v-x-e-table/src/conf")),_modal=_interopRequireDefault(require("../../modal/src/modal")),_group=_interopRequireDefault(require("../../radio/src/group")),_radio=_interopRequireDefault(require("../../radio/src/radio")),_button=_interopRequireDefault(require("../../button/src/button")),_utils=require("../../tools/utils");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default=exports.default=(0,_vue.defineComponent)({name:"VxeTableImportPanel",props:{defaultOptions:Object,storeData:Object},setup(u){const l=(0,_vue.inject)("$xetable",{}),o=l.getComputeMaps()["computeImportOpts"],i=(0,_vue.reactive)({loading:!1}),r=(0,_vue.ref)(),n=(0,_vue.computed)(()=>{var e=u["storeData"];return e.filename+"."+e.type}),s=(0,_vue.computed)(()=>{var e=u["storeData"];return e.file&&e.type}),d=(0,_vue.computed)(()=>{var e=u["storeData"];const{type:t,typeList:a}=e;return t?(e=_xeUtils.default.find(a,e=>t===e.value))?_conf.default.i18n(e.label):"*.*":"*."+a.map(e=>e.value).join(", *.")}),p=()=>{var e=u["storeData"];Object.assign(e,{filename:"",sheetName:"",type:""})},v=()=>{const{storeData:t,defaultOptions:e}=u;l.readFile(e).then(e=>{e=e.file;Object.assign(t,(0,_utils.parseFile)(e),{file:e})}).catch(e=>e)},_=()=>{(0,_vue.nextTick)(()=>{var e=r.value;e&&e.focus()})},c=()=>{var e=u["storeData"];e.visible=!1},f=()=>{const{storeData:e,defaultOptions:t}=u;var a=o.value;i.loading=!0,l.importByFile(e.file,Object.assign({},a,t)).then(()=>{i.loading=!1,e.visible=!1}).catch(()=>{i.loading=!1})};return()=>{const{defaultOptions:t,storeData:a}=u,e=n.value,l=s.value,o=d.value;return(0,_vue.h)(_modal.default,{modelValue:a.visible,title:_conf.default.i18n("vxe.import.impTitle"),className:"vxe-table-import-popup-wrapper",width:440,mask:!0,lockView:!0,showFooter:!1,escClosable:!0,maskClosable:!0,loading:i.loading,"onUpdate:modelValue"(e){a.visible=e},onShow:_},{default:()=>(0,_vue.h)("div",{class:"vxe-export--panel"},[(0,_vue.h)("table",{cellspacing:0,cellpadding:0,border:0},[(0,_vue.h)("tbody",[(0,_vue.h)("tr",[(0,_vue.h)("td",_conf.default.i18n("vxe.import.impFile")),(0,_vue.h)("td",[l?(0,_vue.h)("div",{class:"vxe-import-selected--file",title:e},[(0,_vue.h)("span",e),(0,_vue.h)("i",{class:_conf.default.icon.INPUT_CLEAR,onClick:p})]):(0,_vue.h)("button",{ref:r,class:"vxe-import-select--file",onClick:v},_conf.default.i18n("vxe.import.impSelect"))])]),(0,_vue.h)("tr",[(0,_vue.h)("td",_conf.default.i18n("vxe.import.impType")),(0,_vue.h)("td",o)]),(0,_vue.h)("tr",[(0,_vue.h)("td",_conf.default.i18n("vxe.import.impOpts")),(0,_vue.h)("td",[(0,_vue.h)(_group.default,{modelValue:t.mode,"onUpdate:modelValue"(e){t.mode=e}},{default:()=>a.modeList.map(e=>(0,_vue.h)(_radio.default,{label:e.value,content:_conf.default.i18n(e.label)}))})])])])]),(0,_vue.h)("div",{class:"vxe-export--panel-btns"},[(0,_vue.h)(_button.default,{content:_conf.default.i18n("vxe.import.impCancel"),onClick:c}),(0,_vue.h)(_button.default,{status:"primary",disabled:!l,content:_conf.default.i18n("vxe.import.impConfirm"),onClick:f})])])})}}});