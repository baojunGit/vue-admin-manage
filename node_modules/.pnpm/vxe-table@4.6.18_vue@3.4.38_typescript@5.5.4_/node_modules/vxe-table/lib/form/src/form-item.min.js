"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.formItemProps=exports.default=void 0;var _vue=require("vue"),_xeUtils=_interopRequireDefault(require("xe-utils")),_conf=_interopRequireDefault(require("../../v-x-e-table/src/conf")),_vXETable=require("../../v-x-e-table"),_utils=require("../../tools/utils"),_vn=require("../../tools/vn"),_util=require("./util"),_render=require("./render");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const formItemProps=exports.formItemProps={title:String,field:String,span:[String,Number],align:String,titleAlign:{type:String,default:null},titleWidth:{type:[String,Number],default:null},titleColon:{type:Boolean,default:null},titleAsterisk:{type:Boolean,default:null},showTitle:{type:Boolean,default:!0},vertical:{type:Boolean,default:null},className:[String,Function],contentClassName:[String,Function],contentStyle:[Object,Function],titleClassName:[String,Function],titleStyle:[Object,Function],titleOverflow:{type:[Boolean,String],default:null},titlePrefix:Object,titleSuffix:Object,resetValue:{default:null},visibleMethod:Function,visible:{type:Boolean,default:null},folding:Boolean,collapseNode:Boolean,itemRender:Object,rules:Array};var _default=exports.default=(0,_vue.defineComponent)({name:"VxeFormItem",props:formItemProps,setup(e,{slots:t}){const P=(0,_vue.ref)(),W=(0,_vue.inject)("$xeform",{}),l=(0,_vue.inject)("$xeformgather",null),L=(0,_vue.reactive)((0,_util.createItem)(W,e));var i={formItem:L},n={itemConfig:L};L.slots=t,(0,_vue.provide)("$xeformiteminfo",n),(0,_vue.provide)("$xeformitem",i),(0,_vue.provide)("$xeformgather",null),(0,_util.watchItem)(e,L),(0,_vue.onMounted)(()=>{(0,_util.assemItem)(W,P.value,L,l)}),(0,_vue.onUnmounted)(()=>{(0,_util.destroyItem)(W,L)});return{renderVN:()=>{var l=W?W.props:null;if(l&&l.customLayout){var i=W,l=L,{props:n,reactData:s}=i,{data:r,rules:o,titleAlign:u,titleWidth:a,titleColon:d,titleAsterisk:f,titleOverflow:m,vertical:c}=n,s=s["collapseAll"],v=(v=i.getComputeMaps()["computeValidOpts"]).value,{slots:_,title:p,visible:x,folding:V,field:g,collapseNode:$,itemRender:h,showError:k,errRule:N,className:U,titleOverflow:y,vertical:F,showTitle:D,contentClassName:C,contentStyle:b,titleClassName:S,titleStyle:q}=l,O=(0,_utils.isEnableConf)(h)?_vXETable.VXETable.renderer.get(h.name):null,I=O?O.itemClassName:"",T=O?O.itemStyle:null,j=O?O.itemContentClassName:"",A=O?O.itemContentStyle:null,w=O?O.itemTitleClassName:"",M=O?O.itemTitleStyle:null,B=_?_.default:null,_=_?_.title:null,E=l.span||n.span,n=l.align||n.align,u=_xeUtils.default.eqNull(l.titleAlign)?u:l.titleAlign,a=_xeUtils.default.eqNull(l.titleWidth)?a:l.titleWidth,d=_xeUtils.default.eqNull(l.titleColon)?d:l.titleColon,f=_xeUtils.default.eqNull(l.titleAsterisk)?f:l.titleAsterisk,m=_xeUtils.default.isUndefined(y)||_xeUtils.default.isNull(y)?m:y,y=_xeUtils.default.isUndefined(F)||_xeUtils.default.isNull(F)?c:F,F=!0===m||"tooltip"===m,m=(c="title"===m)||F||"ellipsis"===m;const R={data:r,field:g,property:g,item:l,$form:i,$grid:i.xegrid};let e=!1;if(!1===x)return(0,_vue.createCommentVNode)();o&&(x=o[g])&&(e=x.some(e=>e.required));let t=[];return B?t=i.callSlot(B,R):O&&O.renderItemContent?t=(0,_vn.getSlotVNs)(O.renderItemContent(h,R)):g&&(t=[""+_xeUtils.default.get(r,g)]),$&&t.push((0,_vue.h)("div",{class:"vxe-form--item-trigger-node",onClick:i.toggleCollapseEvent},[(0,_vue.h)("span",{class:"vxe-form--item-trigger-text"},s?_conf.default.i18n("vxe.form.unfolding"):_conf.default.i18n("vxe.form.folding")),(0,_vue.h)("i",{class:["vxe-form--item-trigger-icon",s?_conf.default.icon.FORM_FOLDING:_conf.default.icon.FORM_UNFOLDING]})])),N&&v.showMessage&&t.push((0,_vue.h)("div",{class:"vxe-form--item-valid",style:N.maxWidth?{width:N.maxWidth+"px"}:null},N.message)),o=F?{onMouseenter(e){i.triggerTitleTipEvent(e,R)},onMouseleave:i.handleTitleTipLeaveEvent}:{},(0,_vue.h)("div",{ref:P,class:["vxe-form--item",l.id,E?`vxe-form--item-col--${E} is--span`:"",U?_xeUtils.default.isFunction(U)?U(R):U:"",I?_xeUtils.default.isFunction(I)?I(R):I:"",{"is--title":p,"is--colon":d,"is--vertical":y,"is--asterisk":f,"is--required":e,"is--hidden":V&&s,"is--active":(0,_util.isActivetem)(i,l),"is--error":k}],style:_xeUtils.default.isFunction(T)?T(R):T},[(0,_vue.h)("div",{class:"vxe-form--item-inner"},[!1!==D&&(p||_)?(0,_vue.h)("div",Object.assign({class:["vxe-form--item-title",u?"align--"+u:"",m?"is--ellipsis":"",w?_xeUtils.default.isFunction(w)?w(R):w:"",S?_xeUtils.default.isFunction(S)?S(R):S:""],style:Object.assign({},_xeUtils.default.isFunction(M)?M(R):M,_xeUtils.default.isFunction(q)?q(R):q,a?{width:isNaN(a)?a:a+"px"}:null),title:c?(0,_utils.getFuncText)(p):null},o),(0,_render.renderTitle)(i,l)):null,(0,_vue.h)("div",{class:["vxe-form--item-content",n?"align--"+n:"",j?_xeUtils.default.isFunction(j)?j(R):j:"",C?_xeUtils.default.isFunction(C)?C(R):C:""],style:Object.assign({},_xeUtils.default.isFunction(A)?A(R):A,_xeUtils.default.isFunction(b)?b(R):b)},t)])])}return(0,_vue.h)("div",{ref:P})}}},render(){return this.renderVN()}});