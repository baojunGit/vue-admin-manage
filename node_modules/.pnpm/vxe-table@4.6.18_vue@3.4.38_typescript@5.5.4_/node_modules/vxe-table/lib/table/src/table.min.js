"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _vue=require("vue"),_xeUtils=_interopRequireDefault(require("xe-utils")),_dom=require("../../tools/dom"),_utils=require("../../tools/utils"),_log=require("../../tools/log"),_resize=require("../../tools/resize"),_event=require("../../tools/event"),_size=require("../../hooks/size"),_vXETable=require("../../v-x-e-table"),_conf=_interopRequireDefault(require("../../v-x-e-table/src/conf")),_cell=_interopRequireDefault(require("./cell")),_body=_interopRequireDefault(require("./body")),_header=_interopRequireDefault(require("./header")),_footer=_interopRequireDefault(require("./footer")),_props=_interopRequireDefault(require("./props")),_emits=_interopRequireDefault(require("./emits")),_index=_interopRequireDefault(require("../../loading/index")),_util=require("./util"),_vn=require("../../tools/vn");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const isWebkit=_dom.browse["-webkit"]&&!_dom.browse.edge,resizableStorageKey="VXE_TABLE_CUSTOM_COLUMN_WIDTH",visibleStorageKey="VXE_TABLE_CUSTOM_COLUMN_VISIBLE",fixedStorageKey="VXE_TABLE_CUSTOM_COLUMN_FIXED",sortStorageKey="VXE_TABLE_CUSTOM_COLUMN_SORT";var _default=exports.default=(0,_vue.defineComponent)({name:"VxeTable",props:_props.default,emits:_emits.default,setup(j,l){const{slots:z,emit:r}=l,oe=_vXETable.VXETable.tooltip,ae=_xeUtils.default.uniqueId(),ne=(0,_size.useSize)(j);var a=(0,_vue.getCurrentInstance)();const H=(0,_vue.reactive)({staticColumns:[],tableGroupColumn:[],tableColumn:[],tableData:[],scrollXLoad:!1,scrollYLoad:!1,overflowY:!0,overflowX:!1,scrollbarWidth:0,scrollbarHeight:0,lastScrollTime:0,rowHeight:0,parentHeight:0,isGroup:!1,isAllOverflow:!1,isAllSelected:!1,isIndeterminate:!1,selectCheckboxMaps:{},currentRow:null,currentColumn:null,selectRadioRow:null,footerTableData:[],expandColumn:null,treeNodeColumn:null,hasFixedColumn:!1,rowExpandedMaps:{},rowExpandLazyLoadedMaps:{},treeExpandedMaps:{},treeExpandLazyLoadedMaps:{},treeIndeterminateMaps:{},mergeList:[],mergeFooterList:[],upDataFlag:0,reColumnFlag:0,pendingRowMaps:{},pendingRowList:[],initStore:{filter:!1,import:!1,export:!1,custom:!1},customStore:{btnEl:null,isAll:!1,isIndeterminate:!1,activeBtn:!1,activeWrapper:!1,visible:!1,maxHeight:0},customColumnList:[],filterStore:{isAllSelected:!1,isIndeterminate:!1,style:null,options:[],column:null,multiple:!1,visible:!1,maxHeight:null},columnStore:{leftList:[],centerList:[],rightList:[],resizeList:[],pxList:[],pxMinList:[],scaleList:[],scaleMinList:[],autoList:[]},ctxMenuStore:{selected:null,visible:!1,showChild:!1,selectChild:null,list:[],style:null},editStore:{indexs:{columns:[]},titles:{columns:[]},selected:{row:null,column:null},copyed:{cut:!1,rows:[],columns:[]},actived:{row:null,column:null},focused:{row:null,column:null},insertMaps:{},removeMaps:{}},tooltipStore:{row:null,column:null,content:null,visible:!1},validStore:{visible:!1},validErrorMaps:{},importStore:{inited:!1,file:null,type:"",modeList:[],typeList:[],filename:"",visible:!1},importParams:{mode:"",types:null,message:!0},exportStore:{inited:!1,name:"",modeList:[],typeList:[],columns:[],isPrint:!1,hasFooter:!1,hasMerge:!1,hasTree:!1,hasColgroup:!1,visible:!1},exportParams:{filename:"",sheetName:"",mode:"",type:"",isColgroup:!1,isMerge:!1,isAllExpand:!1,useStyle:!1,original:!1,message:!0,isHeader:!1,isFooter:!1},scrollVMLoading:!1,_isResize:!1}),K={tZindex:0,elemStore:{},scrollXStore:{offsetSize:0,visibleSize:0,startIndex:0,endIndex:0},scrollYStore:{rowHeight:0,offsetSize:0,visibleSize:0,startIndex:0,endIndex:0},tableWidth:0,tableHeight:0,headerHeight:0,footerHeight:0,customHeight:0,customMinHeight:0,customMaxHeight:0,hoverRow:null,lastScrollLeft:0,lastScrollTop:0,radioReserveRow:null,checkboxReserveRowMap:{},rowExpandedReserveRowMap:{},treeExpandedReserveRowMap:{},treeIndeterminateRowMaps:{},tableFullData:[],afterFullData:[],afterTreeFullData:[],afterFullRowMaps:{},tableFullTreeData:[],tableSynchData:[],tableSourceData:[],collectColumn:[],tableFullColumn:[],visibleColumn:[],fullAllDataRowIdData:{},sourceDataRowIdData:{},fullDataRowIdData:{},fullColumnIdData:{},fullColumnFieldData:{},inited:!1,tooltipTimeout:null,initStatus:!1,isActivated:!1};let P={},X={};const q=(0,_vue.ref)(),$=(0,_vue.ref)(),ie=(0,_vue.ref)(),ue=(0,_vue.ref)(),se=(0,_vue.ref)(),de=(0,_vue.ref)(),ce=(0,_vue.ref)(),W=(0,_vue.ref)(),B=(0,_vue.ref)(),Y=(0,_vue.ref)(),s=(0,_vue.ref)(),g=(0,_vue.ref)(),f=(0,_vue.ref)(),p=(0,_vue.ref)(),d=(0,_vue.ref)(),x=(0,_vue.ref)(),ve=(0,_vue.ref)(),ge=(0,_vue.ref)(),fe=(0,_vue.ref)(),he=(0,_vue.ref)(),G=(0,_vue.inject)("$xegrid",null);let h;const me=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.validConfig,j.validConfig)),S=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.scrollX,j.scrollX)),_=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.scrollY,j.scrollY)),n=(0,_vue.computed)(()=>({default:48,medium:44,small:40,mini:36})),Z=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.columnConfig,j.columnConfig)),J=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.rowConfig,j.rowConfig)),D=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.resizeConfig,j.resizeConfig));var e=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.resizableConfig,j.resizableConfig)),t=(0,_vue.computed)(()=>Object.assign({startIndex:0},_conf.default.table.seqConfig,j.seqConfig));const R=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.radioConfig,j.radioConfig)),T=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.checkboxConfig,j.checkboxConfig));(0,_vue.ref)();let c;c=(0,_vue.computed)(()=>Object.assign({},_conf.default.tooltip,_conf.default.table.tooltipConfig,j.tooltipConfig));const pe=(0,_vue.computed)(()=>{var e=c.value;return Object.assign({},e)}),xe=(0,_vue.computed)(()=>{var e=c.value;return Object.assign({isArrow:!1},e)}),Q=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.editConfig,j.editConfig)),w=(0,_vue.computed)(()=>Object.assign({orders:["asc","desc",null]},_conf.default.table.sortConfig,j.sortConfig)),M=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.filterConfig,j.filterConfig)),ee=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.mouseConfig,j.mouseConfig)),k=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.areaConfig,j.areaConfig)),te=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.keyboardConfig,j.keyboardConfig));var u=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.clipConfig,j.clipConfig)),I=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.fnrConfig,j.fnrConfig));const o=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.menuConfig,j.menuConfig)),L=(0,_vue.computed)(()=>{var e=o.value.header;return e&&e.options?e.options:[]}),_e=(0,_vue.computed)(()=>{var e=o.value.body;return e&&e.options?e.options:[]}),F=(0,_vue.computed)(()=>{var e=o.value.footer;return e&&e.options?e.options:[]}),we=(0,_vue.computed)(()=>{var e=o.value,t=L.value,l=_e.value,r=F.value;return!!(j.menuConfig&&(0,_utils.isEnableConf)(e)&&(t.length||l.length||r.length))}),be=(0,_vue.computed)(()=>{var e=H["ctxMenuStore"];const t=[];return e.list.forEach(e=>{e.forEach(e=>{t.push(e)})}),t}),U=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.exportConfig,j.exportConfig)),O=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.importConfig,j.importConfig));var N=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.printConfig,j.printConfig));const y=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.expandConfig,j.expandConfig)),le=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.treeConfig,j.treeConfig)),Ce=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.emptyRender,j.emptyRender)),Ee=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.loadingConfig,j.loadingConfig)),Re=(0,_vue.computed)(()=>j.border?Math.max(2,Math.ceil(H.scrollbarWidth/H.tableColumn.length)):1),m=(0,_vue.computed)(()=>Object.assign({},_conf.default.table.customConfig,j.customConfig)),A=(0,_vue.computed)(()=>{var e=K["collectColumn"];let t=0;return e.forEach(e=>{e.fixed&&t++}),t}),V=(0,_vue.computed)(()=>{var e=A.value,t=Z.value["maxFixedSize"];return!!t&&t<=e}),Te=(0,_vue.computed)(()=>{var e=j["border"];return!0===e?"full":e||"default"});var ye=(0,_vue.computed)(()=>{var{}=j,e=H["tableData"],t=K["tableFullData"];const{strict:l,checkMethod:r}=T.value;return!!l&&(!e.length&&!t.length||!!r&&t.every(e=>!r({row:e})))});const Se={refElem:q,refTooltip:$,refValidTooltip:ue,refTableFilter:de,refTableCustom:ce,refTableMenu:se,refTableHeader:W,refTableBody:B,refTableFooter:Y,refTableLeftHeader:s,refTableLeftBody:g,refTableLeftFooter:f,refTableRightHeader:p,refTableRightBody:d,refTableRightFooter:x,refLeftContainer:ve,refRightContainer:ge,refCellResizeBar:fe},De={computeSize:ne,computeValidOpts:me,computeSXOpts:S,computeSYOpts:_,computeColumnOpts:Z,computeRowOpts:J,computeResizeleOpts:D,computeResizableOpts:e,computeSeqOpts:t,computeRadioOpts:R,computeCheckboxOpts:T,computeTooltipOpts:c,computeEditOpts:Q,computeSortOpts:w,computeFilterOpts:M,computeMouseOpts:ee,computeAreaOpts:k,computeKeyboardOpts:te,computeClipOpts:u,computeFNROpts:I,computeHeaderMenu:L,computeBodyMenu:_e,computeFooterMenu:F,computeIsMenu:we,computeMenuOpts:o,computeExportOpts:U,computeImportOpts:O,computePrintOpts:N,computeExpandOpts:y,computeTreeOpts:le,computeEmptyOpts:Ce,computeLoadingOpts:Ee,computeCustomOpts:m,computeFixedColumnSize:A,computeIsMaxFixedColumn:V,computeIsAllCheckboxDisabled:ye},re={xID:ae,props:j,context:l,instance:a,reactData:H,internalData:K,getRefMaps:()=>Se,getComputeMaps:()=>De,xegrid:G},Me=(e,t,l)=>{e=_xeUtils.default.get(e,l),t=_xeUtils.default.get(t,l);return!(!(0,_utils.eqEmptyValue)(e)||!(0,_utils.eqEmptyValue)(t))||(_xeUtils.default.isString(e)||_xeUtils.default.isNumber(e)?""+e==""+t:_xeUtils.default.isEqual(e,t))},ke=e=>{var t=w.value["orders"],e=e.order||null,e=t.indexOf(e)+1;return t[e<t.length?e:0]},v=e=>{var t=_conf.default.version,e=_xeUtils.default.toStringJSON(localStorage.getItem(e)||"");return e&&e._v===t?e:{_v:t}},Ie=e=>{const l=K["fullAllDataRowIdData"],r={};return _xeUtils.default.each(e,(e,t)=>{l[t]&&(r[t]=e)}),r},Le=e=>{const l=K["fullDataRowIdData"],r=[];return _xeUtils.default.each(e,(e,t)=>{l[t]&&-1===re.findRowIndexOf(r,l[t].row)&&r.push(l[t].row)}),r},Fe=()=>{var a=K["visibleColumn"],e=B.value,e=e?e.$el:null;if(e){var{scrollLeft:n,clientWidth:e}=e,i=n+e;let l=-1,r=0,o=0;for(let e=0,t=a.length;e<t&&(r+=a[e].renderWidth,!(0<=(l=-1===l&&n<r?e:l)&&(o++,r>i)));e++);return{toVisibleIndex:Math.max(0,l),visibleSize:Math.max(8,o)}}return{toVisibleIndex:0,visibleSize:8}},Ue=()=>{var l=W.value,r=B.value,r=r?r.$el:null,o=ne.value,a=n.value;if(r){l=l?l.$el:null;let e=0,t;!(t=r.querySelector("tr"))&&l&&(t=l.querySelector("tr")),e=(e=t?t.clientHeight:e)||a[o||"default"];l=Math.max(8,Math.ceil(r.clientHeight/e)+2);return{rowHeight:e,visibleSize:l}}return{rowHeight:0,visibleSize:8}},Oe=(l,r,o)=>{for(let e=0,t=l.length;e<t;e++){var a=l[e],{startIndex:n,endIndex:i}=r,u=a[o],a=u+a[o+"span"];u<n&&n<a&&(r.startIndex=u),u<i&&i<a&&(r.endIndex=a),r.startIndex===n&&r.endIndex===i||(e=-1)}},Ne=(e,n,i)=>{if(e){var t=j["treeConfig"];const u=K["visibleColumn"];_xeUtils.default.isArray(e)||(e=[e]),t&&e.length&&(0,_log.errLog)("vxe.error.noTree",["merge-cells | merge-footer-items"]),e.forEach(e=>{let{row:t,col:l,rowspan:r,colspan:o}=e;var a;i&&_xeUtils.default.isNumber(t)&&(t=i[t]),_xeUtils.default.isNumber(l)&&(l=u[l]),(i?t:_xeUtils.default.isNumber(t))&&l&&(r||o)&&(r=_xeUtils.default.toNumber(r)||1,o=_xeUtils.default.toNumber(o)||1,1<r||1<o)&&(e=_xeUtils.default.findIndexOf(n,e=>!(e._row!==t&&(0,_util.getRowid)(re,e._row)!==(0,_util.getRowid)(re,t)||e._col.id!==l&&e._col.id!==l.id)),(e=n[e])?(e.rowspan=r,e.colspan=o,e._rowspan=r,e._colspan=o):(e=i?re.findRowIndexOf(i,t):t,a=P.getVTColumnIndex(l),n.push({row:e,col:a,rowspan:r,colspan:o,_row:t,_col:l,_rowspan:r,_colspan:o})))})}},Ae=(e,r,o)=>{const a=[];if(e){var t=j["treeConfig"];const n=K["visibleColumn"];_xeUtils.default.isArray(e)||(e=[e]),t&&e.length&&(0,_log.errLog)("vxe.error.noTree",["merge-cells | merge-footer-items"]),e.forEach(e=>{let{row:t,col:l}=e;o&&_xeUtils.default.isNumber(t)&&(t=o[t]),_xeUtils.default.isNumber(l)&&(l=n[l]);var e=_xeUtils.default.findIndexOf(r,e=>!(e._row!==t&&(0,_util.getRowid)(re,e._row)!==(0,_util.getRowid)(re,t)||e._col.id!==l&&e._col.id!==l.id));-1<e&&(e=r.splice(e,1),a.push(e[0]))})}return a},Ve=()=>{var e=K["tableFullColumn"];e.forEach(e=>{e.order=null})},ze=e=>{var t,l=H["parentHeight"],e=j[e];let r=0;return r=e?"auto"===e?l:(t=re.getExcludeHeight(),r=(0,_dom.isScale)(e)?Math.floor((_xeUtils.default.toInteger(e)||1)/100*l):_xeUtils.default.toNumber(e),Math.max(40,r-t)):r},qe=()=>{var{tableFullColumn:e,collectColumn:t}=K;const d=K.fullColumnIdData={},c=K.fullColumnFieldData={};var l=ee.value,r=Z.value,o=J.value,a=t.some(_utils.hasChildrenList);let v=!!j.showOverflow,g,f,h,m,p,x;const n=(e,t,l,r,o)=>{var{id:a,field:n,fixed:i,type:u,treeNode:s}=e,t={column:e,colid:a,index:t,items:l,parent:o};n&&("development"===process.env.NODE_ENV&&c[n]&&(0,_log.warnLog)("vxe.error.colRepet",["field",n]),c[n]=t),!x&&i&&(x=i),p||"html"!==u||(p=e),s?("development"===process.env.NODE_ENV&&f&&(0,_log.warnLog)("vxe.error.colRepet",["tree-node",s]),f=f||e):"expand"===u&&("development"===process.env.NODE_ENV&&g&&(0,_log.warnLog)("vxe.error.colRepet",["type",u]),g=g||e),"development"===process.env.NODE_ENV&&("checkbox"===u?(h&&(0,_log.warnLog)("vxe.error.colRepet",["type",u]),h=h||e):"radio"===u&&(m&&(0,_log.warnLog)("vxe.error.colRepet",["type",u]),m=m||e)),v&&!1===e.showOverflow&&(v=!1),d[a]&&(0,_log.errLog)("vxe.error.colRepet",["colId",a]),d[a]=t};a?_xeUtils.default.eachTree(t,(e,t,l,r,o,a)=>{e.level=a.length,n(e,t,l,0,o)}):e.forEach(n),"development"===process.env.NODE_ENV&&g&&l.area&&(0,_log.errLog)("vxe.error.errConflicts",["mouse-config.area","column.type=expand"]),"development"===process.env.NODE_ENV&&p&&(r.useKey||(0,_log.errLog)("vxe.error.reqProp",["column-config.useKey","column.type=html"]),o.useKey||(0,_log.errLog)("vxe.error.reqProp",["row-config.useKey","column.type=html"])),H.isGroup=a,H.treeNodeColumn=f,H.expandColumn=g,H.isAllOverflow=v},$e=()=>{K.customHeight=ze("height"),K.customMinHeight=ze("minHeight"),K.customMaxHeight=ze("maxHeight")},je=()=>{var i=W.value,u=B.value,s=Y.value;const d=u?u.$el:null,c=i?i.$el:null;u=s?s.$el:null;if(d){let l=0;i=d.clientWidth-1,s=i;let r=s/100;var v=j["fit"],g=H["columnStore"],{resizeList:g,pxMinList:f,pxList:h,scaleList:m,scaleMinList:p,autoList:x}=g;if(f.forEach(e=>{var t=_xeUtils.default.toInteger(e.minWidth);l+=t,e.renderWidth=t}),p.forEach(e=>{var t=Math.floor(_xeUtils.default.toInteger(e.minWidth)*r);l+=t,e.renderWidth=t}),m.forEach(e=>{var t=Math.floor(_xeUtils.default.toInteger(e.width)*r);l+=t,e.renderWidth=t}),h.forEach(e=>{var t=_xeUtils.default.toInteger(e.width);l+=t,e.renderWidth=t}),g.forEach(e=>{var t=_xeUtils.default.toInteger(e.resizeWidth);l+=t,e.renderWidth=t}),s-=l,r=0<s?Math.floor(s/(p.length+f.length+x.length)):0,v?0<s&&p.concat(f).forEach(e=>{l+=r,e.renderWidth+=r}):r=40,x.forEach(e=>{var t=Math.max(r,40);e.renderWidth=t,l+=t}),v){var _=m.concat(p).concat(f).concat(x);let t=_.length-1;if(0<t){let e=i-l;if(0<e){for(;0<e&&0<=t;)e--,_[t--].renderWidth++;l=i}}}h=d.offsetHeight,g=d.scrollHeight>d.clientHeight;let e=0,t=(g&&(e=Math.max(d.offsetWidth-d.clientWidth,0)),H.scrollbarWidth=e,H.overflowY=g,K.tableWidth=l,K.tableHeight=h,0),o=(c&&(t=c.clientHeight,(0,_vue.nextTick)(()=>{c&&d&&c.scrollLeft!==d.scrollLeft&&(c.scrollLeft=d.scrollLeft)})),K.headerHeight=t,!1),a=0,n=0;u?(a=u.offsetHeight,(o=l>u.clientWidth)&&(n=Math.max(a-u.clientHeight,0))):(o=l>i)&&(n=Math.max(h-d.clientHeight,0)),K.footerHeight=a,H.overflowX=o,H.scrollbarHeight=n,$e(),H.parentHeight=Math.max(K.headerHeight+a+20,X.getParentHeight()),o&&X.checkScrolling()}},He=l=>{const{sortBy:r,sortType:o}=l;return e=>{let t;return t=r?_xeUtils.default.isFunction(r)?r({row:e,column:l}):_xeUtils.default.get(e,r):X.getCellLabel(e,l),o&&"auto"!==o?"number"===o?_xeUtils.default.toNumber(t):"string"===o?_xeUtils.default.toValueString(t):t:isNaN(t)?t:_xeUtils.default.toNumber(t)}},Ke=()=>{var e=j["treeConfig"];const{afterFullData:t,fullDataRowIdData:n,fullAllDataRowIdData:i}=K;var l=K["afterTreeFullData"],r=le.value,o=r.children||r.childrenField;const u={};e?_xeUtils.default.eachTree(l,(e,t,l,r)=>{var o=(0,_util.getRowid)(re,e),a=i[o],r=r.map((e,t)=>t%2==0?Number(e)+1:".").join("");a?(a.seq=r,a._index=t):(a={row:e,rowid:o,seq:r,index:-1,$index:-1,_index:t,items:[],parent:null,level:0},i[o]=a,n[o]=a),u[o]=e},{children:r.transform?r.mapChildrenField:o}):t.forEach((e,t)=>{var l=(0,_util.getRowid)(re,e),r=i[l],o=t+1;r?(r.seq=o,r._index=t):(r={row:e,rowid:l,seq:o,index:-1,$index:-1,_index:t,items:[],parent:null,level:0},i[l]=r,n[l]=r),u[l]=e}),K.afterFullRowMaps=u},i=()=>{var e=j["treeConfig"];const i=H["treeExpandedMaps"];var t=le.value;if(e&&t.transform){const u=[],s={};return _xeUtils.default.eachTree(K.afterTreeFullData,(e,t,l,r,o)=>{var a=(0,_util.getRowid)(re,e),n=(0,_util.getRowid)(re,o);(!o||s[n]&&i[n])&&(s[a]=1,u.push(e))},{children:t.mapChildrenField}),K.afterFullData=u,ut(u),u}return K.afterFullData},b=()=>{const{border:c,showFooter:v,showOverflow:g,showHeaderOverflow:f,showFooterOverflow:h,mouseConfig:e,spanMethod:m,footerSpanMethod:p,keyboardConfig:x}=j,{isGroup:_,currentRow:t,tableColumn:w,scrollXLoad:b,scrollYLoad:C,scrollbarWidth:E,scrollbarHeight:R,columnStore:l,editStore:r,mergeList:T,mergeFooterList:y,isAllOverflow:S}=H;let{visibleColumn:D,fullColumnIdData:M,tableHeight:k,tableWidth:I,headerHeight:L,footerHeight:F,elemStore:U,customHeight:O,customMinHeight:N,customMaxHeight:A}=K;var o=he.value;const V=Re.value;var a=ee.value;const z=te.value;var n=U["main-body-wrapper"],n=n?n.value:null;return o&&(o.style.top=L+"px",o.style.height=n?n.offsetHeight-R+"px":""),0<O&&v&&(O+=R),["main","left","right"].forEach((u,e)=>{const a=0<e?u:"";const n="left"===a;let s=[],d;a&&(s=n?l.leftList:l.rightList,d=(n?ve:ge).value),["header","body","footer"].forEach(i=>{var l=U[u+`-${i}-wrapper`],l=l?l.value:null,t=U[u+`-${i}-table`],t=t?t.value:null;if("header"===i){I;let e=w;_?e=D:a&&(b||f)&&(e=s),r=e.reduce((e,t)=>e+t.renderWidth,0),t&&(t.style.width=r?r+E+"px":"");var r=U[u+`-${i}-repair`],r=r?r.value:null,r=(r&&(r.style.width=I+"px"),U[u+`-${i}-list`]),r=r?r.value:null;_&&r&&_xeUtils.default.arrayEach(r.querySelectorAll(".col--group"),e=>{var r=P.getColumnNode(e);if(r){const o=r.item;r=o["showHeaderOverflow"],r=_xeUtils.default.isBoolean(r)?r:f,r="title"===r||(!0===r||"tooltip"===r)||"ellipsis"===r;let t=0,l=0;r&&_xeUtils.default.eachTree(o.children,e=>{e.children&&o.children.length||l++,t+=e.renderWidth},{children:"children"}),e.style.width=r?t-l-(c?2:0)+"px":""}})}else if("body"===i){r=U[u+`-${i}-emptyBlock`],r=r?r.value:null;if((0,_dom.isNodeElement)(l)){let t=0;var o=N-L-F;if(A&&(t=A-L-F,a&&(t-=v?0:R),t=Math.max(o,t),l.style.maxHeight=t+"px"),O){let e=O-L-F;a&&(e-=v?0:R),t&&(e=Math.min(t,e)),l.style.height=Math.max(o,e)+"px"}else l.style.height="";l.style.minHeight=o+"px"}d&&((0,_dom.isNodeElement)(l)&&(l.style.top=L+"px"),d.style.height=(0<O?O-L-F:k)+L+F-R*(v?2:1)+"px",d.style.width=s.reduce((e,t)=>e+t.renderWidth,n?0:E)+"px");I;let e=w;o=(e=a?H.expandColumn||!(C||g&&S)||T.length||m||x&&z.isMerge?D:s:e).reduce((e,t)=>e+t.renderWidth,0),t&&(t.style.width=o?o+"px":"",t.style.paddingRight=E&&a&&(_dom.browse["-moz"]||_dom.browse.safari)?E+"px":""),r&&(r.style.width=o?o+"px":"")}else if("footer"===i){I;let e=w;r=(e=a?H.expandColumn||!b&&!h||y.length&&p?D:s:e).reduce((e,t)=>e+t.renderWidth,0),(0,_dom.isNodeElement)(l)&&(d&&(l.style.top=`${0<O?O-F:k+L}px`),l.style.marginTop=-Math.max(1,R)+"px"),t&&(t.style.width=r?r+E+"px":"")}o=U[u+`-${i}-colgroup`],l=o?o.value:null;l&&_xeUtils.default.arrayEach(l.children,t=>{var l=t.getAttribute("name");if("col_gutter"===l&&(t.style.width=E+"px"),M[l]){const n=M[l].column;var{showHeaderOverflow:l,showFooterOverflow:r,showOverflow:o}=n;let e;t.style.width=n.renderWidth+"px";t="ellipsis"===(e="header"===i?_xeUtils.default.isUndefined(l)||_xeUtils.default.isNull(l)?f:l:"footer"===i?_xeUtils.default.isUndefined(r)||_xeUtils.default.isNull(r)?h:r:_xeUtils.default.isUndefined(o)||_xeUtils.default.isNull(o)?g:o),l="title"===e,r=!0===e||"tooltip"===e;let a=l||r||t;o=U[u+`-${i}-list`],l=o?o.value:null;C&&!a&&(a=!0),l&&_xeUtils.default.arrayEach(l.querySelectorAll("."+n.id),e=>{var t=parseInt(e.getAttribute("colspan")||1),e=e.querySelector(".vxe-cell");let l=n.renderWidth;if(e){if(1<t){var r=P.getColumnIndex(n);for(let e=1;e<t;e++){var o=P.getColumns(r+e);o&&(l+=o.renderWidth)}}e.style.width=a?l-V*t+"px":""}})}})})}),t&&P.setCurrentRow(t),e&&a.selected&&r.selected.row&&r.selected.column&&re.addCellSelectedClass(),(0,_vue.nextTick)()},Pe=e=>re.triggerValidate?re.triggerValidate(e):(0,_vue.nextTick)(),Xe=(e,t)=>{Pe("blur").catch(e=>e).then(()=>{re.handleActived(t,e).then(()=>Pe("change")).catch(e=>e)})},C=(e,t)=>{var l,r=K["checkboxReserveRowMap"];T.value.reserve&&(l=(0,_util.getRowid)(re,e),t?r[l]=e:r[l]&&delete r[l])},We=(e,t)=>{var l=R.value["checkMethod"];return e&&(t||!l||l({row:e}))&&(H.selectRadioRow=e,t=e,R.value.reserve)&&(K.radioReserveRow=t),(0,_vue.nextTick)()},E=(e,t,l)=>((e=e&&!_xeUtils.default.isArray(e)?[e]:e).forEach(e=>X.handleSelectRow({row:e},!!t,l)),(0,_vue.nextTick)()),Be=(t,l)=>{const r=j["treeConfig"],o=H["selectCheckboxMaps"],{afterFullData:e,afterFullRowMaps:a,checkboxReserveRowMap:n}=K;var i=le.value,i=i.children||i.childrenField,u=T.value;const{checkField:s,reserve:d,checkStrictly:c,checkMethod:v}=u,g=u.indeterminateField||u.halfField,f={};return r||_xeUtils.default.each(o,(e,t)=>{a[t]||(f[t]=e)}),c?H.isAllSelected=t:(s?(u=e=>{!l&&v&&!v({row:e})||(t&&(f[(0,_util.getRowid)(re,e)]=e),_xeUtils.default.set(e,s,t)),r&&g&&_xeUtils.default.set(e,g,!1)},r?_xeUtils.default.eachTree(e,u,{children:i}):e.forEach(u)):r?t?_xeUtils.default.eachTree(e,e=>{!l&&v&&!v({row:e})||(f[(0,_util.getRowid)(re,e)]=e)},{children:i}):!l&&v&&_xeUtils.default.eachTree(e,e=>{var t=(0,_util.getRowid)(re,e);!v({row:e})&&o[t]&&(f[t]=e)},{children:i}):t?!l&&v?e.forEach(e=>{var t=(0,_util.getRowid)(re,e);(o[t]||v({row:e}))&&(f[t]=e)}):e.forEach(e=>{f[(0,_util.getRowid)(re,e)]=e}):!l&&v&&e.forEach(e=>{var t=(0,_util.getRowid)(re,e);!v({row:e})&&o[t]&&(f[t]=e)}),d&&(t?_xeUtils.default.each(f,(e,t)=>{n[t]=e}):e.forEach(e=>C(e,!1))),H.selectCheckboxMaps=s?{}:f),H.treeIndeterminateMaps={},K.treeIndeterminateRowMaps={},X.checkSelectionStatus(),(0,_vue.nextTick)()},Ye=a=>{var e=le.value,t=T.value;const{transform:n,loadMethod:i}=e,u=t["checkStrictly"];return new Promise(e=>{if(i){const l=H["treeExpandLazyLoadedMaps"];var t=K["fullAllDataRowIdData"];const r=(0,_util.getRowid)(re,a),o=t[r];l[r]=a,i({$table:re,row:a}).then(e=>{if(o.treeLoaded=!0,l[r]&&delete l[r],e=_xeUtils.default.isArray(e)?e:[])return P.loadTreeChildren(a,e).then(e=>{var t=H["treeExpandedMaps"];return e.length&&!t[r]&&(t[r]=a),!u&&P.isCheckedByCheckboxRow(a)&&E(e,!0),(0,_vue.nextTick)().then(()=>{if(n)return X.handleTableData()})})}).catch(()=>{var e=H["treeExpandLazyLoadedMaps"];o.treeLoaded=!1,e[r]&&delete e[r]}).finally(()=>{(0,_vue.nextTick)().then(()=>P.recalculate()).then(()=>e())})}else e()})},Ge=(e,t)=>{var l,r=K["treeExpandedReserveRowMap"];le.value.reserve&&(l=(0,_util.getRowid)(re,e),t?r[l]=e:r[l]&&delete r[l])},Ze=n=>new Promise(t=>{var e=y.value["loadMethod"];if(e){var l=K["fullAllDataRowIdData"],r=H["rowExpandLazyLoadedMaps"];const o=(0,_util.getRowid)(re,n),a=l[o];r[o]=n,e({$table:re,row:n,rowIndex:P.getRowIndex(n),$rowIndex:P.getVMRowIndex(n)}).then(()=>{var e=H["rowExpandedMaps"];a.expandLoaded=!0,e[o]=n}).catch(()=>{a.expandLoaded=!1}).finally(()=>{var e=H["rowExpandLazyLoadedMaps"];e[o]&&delete e[o],(0,_vue.nextTick)().then(()=>P.recalculate()).then(()=>t())})}else t()}),Je=(e,t)=>{var l,r=K["rowExpandedReserveRowMap"];y.value.reserve&&(l=(0,_util.getRowid)(re,e),t?r[l]=e:r[l]&&delete r[l])},Qe=()=>(0,_vue.nextTick)().then(()=>{var{scrollXLoad:e,scrollYLoad:t}=H,{scrollXStore:l,scrollYStore:r}=K,o=_.value,a=S.value,{rowHeight:e,visibleSize:a}=(e?(e=Fe()["visibleSize"],a=a.oSize?_xeUtils.default.toNumber(a.oSize):_dom.browse.edge?5:0,l.offsetSize=a,l.visibleSize=e,l.endIndex=Math.max(l.startIndex+l.visibleSize+a,l.endIndex),X.updateScrollXData()):X.updateScrollXSpace(),Ue());r.rowHeight=e,t?(l=o.oSize?_xeUtils.default.toNumber(o.oSize):_dom.browse.edge?10:0,r.offsetSize=l,r.visibleSize=a,r.endIndex=Math.max(r.startIndex+a+l,r.endIndex),X.updateScrollYData()):X.updateScrollYSpace(),H.rowHeight=e,(0,_vue.nextTick)(b)}),et=e=>{var{keepSource:t,treeConfig:l}=j;const{editStore:r,scrollYLoad:f}=H,{scrollYStore:h,scrollXStore:o,lastScrollLeft:m,lastScrollTop:p}=K;var a=le.value,n=a["transform"],i=a.children||a.childrenField;let u=[],s=(0,_vue.reactive)(e?e.slice(0):[]);l&&(n?("development"===process.env.NODE_ENV&&(a.rowField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.rowField"]),a.parentField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.parentField"]),i||(0,_log.errLog)("vxe.error.reqProp",["tree-config.childrenField"]),a.mapChildrenField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.mapChildrenField"]),i===a.mapChildrenField)&&(0,_log.errLog)("vxe.error.errConflicts",["tree-config.childrenField","tree-config.mapChildrenField"]),u=_xeUtils.default.toArrayTree(s,{key:a.rowField,parentKey:a.parentField,children:i,mapChildren:a.mapChildrenField}),s=u.slice(0)):u=s.slice(0)),h.startIndex=0,h.endIndex=1,o.startIndex=0,o.endIndex=1,H.scrollVMLoading=!1,r.insertMaps={},r.removeMaps={};const x=ut(s);return H.scrollYLoad=x,K.tableFullData=s,K.tableFullTreeData=u,X.cacheRowMap(!0),K.tableSynchData=e,t&&X.cacheSourceMap(s),"development"===process.env.NODE_ENV&&x&&(j.height||j.maxHeight||(0,_log.errLog)("vxe.error.reqProp",["table.height | table.max-height | table.scroll-y={enabled: false}"]),j.showOverflow||(0,_log.warnLog)("vxe.error.reqProp",["table.show-overflow"]),j.spanMethod)&&(0,_log.warnLog)("vxe.error.scrollErrProp",["table.span-method"]),re.clearCellAreas&&j.mouseConfig&&(re.clearCellAreas(),re.clearCopyCellArea()),P.clearMergeCells(),P.clearMergeFooterItems(),X.handleTableData(!0),P.updateFooter(),(0,_vue.nextTick)().then(()=>{$e(),b()}).then(()=>{Qe()}).then(()=>{x&&(h.endIndex=h.visibleSize);var e=j["treeConfig"],{expandColumn:t,currentRow:l,selectCheckboxMaps:r,selectRadioRow:o,rowExpandedMaps:a,treeExpandedMaps:n}=H,{fullDataRowIdData:i,fullAllDataRowIdData:u,radioReserveRow:s}=K,d=y.value,c=le.value,v=R.value,g=T.value;return o&&!u[(0,_util.getRowid)(re,o)]&&(H.selectRadioRow=null),v.reserve&&s&&i[o=(0,_util.getRowid)(re,s)]&&We(i[o].row,!0),H.selectCheckboxMaps=Ie(r),g.reserve&&E(Le(K.checkboxReserveRowMap),!0,!0),l&&!u[(0,_util.getRowid)(re,l)]&&(H.currentRow=null),H.rowExpandedMaps=t?Ie(a):{},t&&d.reserve&&P.setRowExpand(Le(K.rowExpandedReserveRowMap),!0),H.treeExpandedMaps=e?Ie(n):{},e&&c.reserve&&P.setTreeExpand(Le(K.treeExpandedReserveRowMap),!0),X.checkSelectionStatus(),new Promise(o=>{(0,_vue.nextTick)().then(()=>P.recalculate()).then(()=>{let e=m,t=p;var l=S.value,r=_.value;l.scrollToLeftOnChange&&(e=0),r.scrollToTopOnChange&&(t=0),f===x?(0,_util.restoreScrollLocation)(re,e,t).then(o):setTimeout(()=>(0,_util.restoreScrollLocation)(re,e,t).then(o))})})})},tt=()=>{if(e=j["checkboxConfig"]){const a=K["fullDataRowIdData"];var{checkAll:e,checkRowKeys:t}=T.value;if(e)Be(!0,!0);else if(t){const n=[];t.forEach(e=>{a[e]&&n.push(a[e].row)}),E(n,!0,!0)}}if((e=j.radioConfig)&&(e=K["fullDataRowIdData"],{checkRowKey:t,reserve:l}=R.value,t)&&(e[t]&&We(e[t].row,!0),l)&&(e=(0,_util.getRowkey)(re),K.radioReserveRow={[e]:t}),l=j["expandConfig"]){const i=K["fullDataRowIdData"];var{expandAll:l,expandRowKeys:e}=y.value;if(l)P.setAllRowExpand(!0);else if(e){const u=[];e.forEach(e=>{i[e]&&u.push(i[e].row)}),P.setRowExpand(u,!0)}}if(e=j["treeConfig"]){const s=K["tableFullData"];var e=le.value,{expandAll:r,expandRowKeys:o}=e;const d=e.children||e.childrenField;if(r)P.setAllTreeExpand(!0);else if(o){const c=[],v=(0,_util.getRowkey)(re);o.forEach(t=>{var e=_xeUtils.default.findTree(s,e=>t===_xeUtils.default.get(e,v),{children:d});e&&c.push(e.item)}),P.setTreeExpand(c,!0)}}(e=j.mergeCells)&&P.setMergeCells(e),(r=j.mergeFooterItems)&&P.setMergeFooterItems(r),(0,_vue.nextTick)(()=>setTimeout(()=>P.recalculate()))},lt=()=>{var t=j["sortConfig"];if(t){var l=w.value;let e=l["defaultSort"];e&&(e=_xeUtils.default.isArray(e)?e:[e]).length&&((t.multiple?e:e.slice(0,1)).forEach((e,t)=>{var{field:e,order:l}=e;e&&l&&(e=P.getColumnByField(e))&&e.sortable&&(e.order=l,e.sortTime=Date.now()+t)}),l.remote||X.handleTableData(!0).then(b))}},rt=()=>{var e=H["scrollXLoad"];const{visibleColumn:t,scrollXStore:l,fullColumnIdData:r}=K;e=e?t.slice(l.startIndex,l.endIndex):t.slice(0);e.forEach((e,t)=>{e=e.id,e=r[e];e&&(e.$index=t)}),H.tableColumn=e},ot=()=>{var{mergeList:e,mergeFooterList:t}=H,l=K["scrollXStore"],{startIndex:r,endIndex:o,offsetSize:a}=l,{toVisibleIndex:n,visibleSize:i}=Fe(),a={startIndex:Math.max(0,n-1-a),endIndex:n+i+a},{startIndex:e,endIndex:t}=(Oe(e.concat(t),a,"col"),a);!(n<=r||o-i-1<=n)||r===e&&o===t||(l.startIndex=e,l.endIndex=t,X.updateScrollXData()),P.closeTooltip()},at=e=>{const t=[];return e.forEach(e=>{t.push(...e.children&&e.children.length?at(e.children):[e])}),t},nt=()=>{const n=[],i=[],u=[];var{isGroup:e,columnStore:t}=H,l=S.value;const{collectColumn:r,tableFullColumn:o,scrollXStore:a,fullColumnIdData:s}=K;if(e){const c=[],v=[],g=[];_xeUtils.default.eachTree(r,(e,t,l,r,o)=>{var a=(0,_utils.hasChildrenList)(e);o&&o.fixed&&(e.fixed=o.fixed),o&&e.fixed!==o.fixed&&(0,_log.errLog)("vxe.error.groupFixed"),a?e.visible=!!_xeUtils.default.findTree(e.children,e=>!(0,_utils.hasChildrenList)(e)&&e.visible):e.visible&&("left"===e.fixed?n:"right"===e.fixed?u:i).push(e)}),r.forEach(e=>{e.visible&&("left"===e.fixed?c:"right"===e.fixed?g:v).push(e)}),H.tableGroupColumn=c.concat(v).concat(g)}else o.forEach(e=>{e.visible&&("left"===e.fixed?n:"right"===e.fixed?u:i).push(e)});const d=n.concat(i).concat(u);e=!!l.enabled&&-1<l.gt&&(0===l.gt||l.gt<o.length);return H.hasFixedColumn=0<n.length||0<u.length,Object.assign(t,{leftList:n,centerList:i,rightList:u}),e&&("development"===process.env.NODE_ENV&&(j.spanMethod&&(0,_log.warnLog)("vxe.error.scrollErrProp",["span-method"]),j.footerSpanMethod)&&(0,_log.warnLog)("vxe.error.scrollErrProp",["footer-span-method"]),l=Fe()["visibleSize"],a.startIndex=0,a.endIndex=l,a.visibleSize=l),d.length===K.visibleColumn.length&&K.visibleColumn.every((e,t)=>e===d[t])||(P.clearMergeCells(),P.clearMergeFooterItems()),H.scrollXLoad=e,d.forEach((e,t)=>{e=e.id,e=s[e];e&&(e._index=t)}),K.visibleColumn=d,rt(),P.updateFooter().then(()=>P.recalculate()).then(()=>(P.updateCellAreas(),P.recalculate()))},it=e=>{K.collectColumn=e;var t=at(e),{id:t,customConfig:r}=(K.tableFullColumn=t,K.collectColumn.forEach((e,t)=>{t+=1;e.sortNumber=t,e.renderSortNumber=t}),j),o=m.value["storage"],o=(u=!0===o)?{}:Object.assign({},o||{}),a=u||o.resizable,n=u||o.visible,i=u||o.fixed,u=u||o.sort;if(r&&(a||n||i||u)){const s={};if(t){a&&(o=v(resizableStorageKey)[t])&&_xeUtils.default.each(o,(e,t)=>{s[t]={resizeWidth:e}}),i&&(r=v(fixedStorageKey)[t])&&r.split(",").forEach(e=>{var[e,t]=e.split("|");s[e]?s[e].fixed=t:s[e]={fixed:t}});let l=!1;u&&(a=v(sortStorageKey)[t])&&_xeUtils.default.each(a,(e,t)=>{s[t]?s[t].renderSortNumber=e:s[t]={renderSortNumber:e},l=l||!0}),n&&(o=v(visibleStorageKey)[t])&&(r=(i=o.split("|"))[0]?i[0].split(","):[],u=i[1]?i[1].split(","):[],r.forEach(e=>{s[e]?s[e].visible=!1:s[e]={visible:!1}}),u.forEach(e=>{s[e]?s[e].visible=!0:s[e]={visible:!0}}));a=K["collectColumn"];const d={};_xeUtils.default.eachTree(a,e=>{var t=e.getKey();t&&(d[t]=e)}),_xeUtils.default.each(s,({visible:e,resizeWidth:t,fixed:l,renderSortNumber:r},o)=>{o=d[o];o&&(_xeUtils.default.isNumber(t)&&(o.resizeWidth=t),_xeUtils.default.isBoolean(e)&&(o.visible=e),l&&(o.fixed=l),r)&&(o.renderSortNumber=Number(r))}),l&&(a=_xeUtils.default.orderBy(a,"renderSortNumber"),K.collectColumn=a,K.tableFullColumn=at(a))}else(0,_log.errLog)("vxe.error.reqProp",["id"])}return qe(),nt().then(()=>{H.scrollXLoad&&ot()}),P.clearMergeCells(),P.clearMergeFooterItems(),X.handleTableData(!0),"development"===process.env.NODE_ENV&&(H.scrollXLoad||H.scrollYLoad)&&H.expandColumn&&(0,_log.warnLog)("vxe.error.scrollErrProp",["column.type=expand"]),(0,_vue.nextTick)().then(()=>(h&&h.syncUpdate({collectColumn:e,$table:re}),P.recalculate()))},ut=e=>{var t=j["treeConfig"],l=_.value,r=le.value["transform"],e=e||K.tableFullData,r=(r||!t)&&!!l.enabled&&-1<l.gt&&(0===l.gt||l.gt<e.length);return H.scrollYLoad=r},st=(e,t)=>{const{treeExpandedMaps:l,treeExpandLazyLoadedMaps:r,treeNodeColumn:o}=H,a=Object.assign({},l),{fullAllDataRowIdData:n,tableFullData:i}=K;var u=le.value;const{reserve:s,lazy:d,accordion:c,toggleMethod:v}=u,g=u.children||u.childrenField,f=u.hasChild||u.hasChildField,h=[],m=P.getColumnIndex(o),p=P.getVMColumnIndex(o);let x=v?e.filter(e=>v({$table:re,expanded:t,column:o,columnIndex:m,$columnIndex:p,row:e})):e;return c&&(x=x.length?[x[x.length-1]]:[],u=_xeUtils.default.findTree(i,e=>e===x[0],{children:g}))&&u.items.forEach(e=>{e=(0,_util.getRowid)(re,e);a[e]&&delete a[e]}),t?x.forEach(e=>{var t,l=(0,_util.getRowid)(re,e);a[l]||(t=n[l],d&&e[f]&&!t.treeLoaded&&!r[l]?h.push(Ye(e)):e[g]&&e[g].length&&(a[l]=e))}):x.forEach(e=>{e=(0,_util.getRowid)(re,e);a[e]&&delete a[e]}),s&&x.forEach(e=>Ge(e,t)),H.treeExpandedMaps=a,Promise.all(h).then(()=>P.recalculate())},dt=e=>{var t=H["mergeList"],l=K["scrollYStore"],{startIndex:r,endIndex:o,visibleSize:a,offsetSize:n,rowHeight:i}=l,e=(e.currentTarget||e.target).scrollTop,e=Math.floor(e/i),i={startIndex:Math.max(0,e-1-n),endIndex:e+a+n},{startIndex:n,endIndex:t}=(Oe(t,i,"row"),i);!(e<=r||o-a-1<=e)||r===n&&o===t||(l.startIndex=n,l.endIndex=t,X.updateScrollYData())};e=l=>function(e){var t=K["fullAllDataRowIdData"];if(e){t=t[(0,_util.getRowid)(re,e)];if(t)return t[l]}return-1},t=l=>function(e){var t=K["fullColumnIdData"];if(e){t=t[e.id];if(t)return t[l]}return-1};const ct=_xeUtils.default.debounce(function(e){dt(e)},20,{leading:!1,trailing:!0});let vt;P={dispatchEvent(e,t,l){r(e,Object.assign({$table:re,$grid:G,$event:l},t))},clearAll(){return(0,_util.clearTableAllStatus)(re)},syncData(){return(0,_log.warnLog)("vxe.error.delFunc",["syncData","getData"]),(0,_vue.nextTick)().then(()=>(H.tableData=[],r("update:data",K.tableFullData),(0,_vue.nextTick)()))},updateData(){const{scrollXLoad:e,scrollYLoad:t}=H;return X.handleTableData(!0).then(()=>{if(P.updateFooter(),e||t)return e&&X.updateScrollXSpace(),t&&X.updateScrollYSpace(),P.refreshScroll()}).then(()=>(P.updateCellAreas(),P.recalculate(!0))).then(()=>{setTimeout(()=>re.recalculate(),50)})},loadData(e){const{inited:t,initStatus:l}=K;return et(e).then(()=>(K.inited=!0,K.initStatus=!0,l||tt(),t||lt(),P.recalculate()))},reloadData(e){const t=K["inited"];return P.clearAll().then(()=>(K.inited=!0,K.initStatus=!0,et(e))).then(()=>(tt(),t||lt(),P.recalculate()))},setRow(t,l){if(l){let e=t;(e=_xeUtils.default.isArray(t)?e:[t]).forEach(e=>Object.assign(e,l))}return(0,_vue.nextTick)()},reloadRow(e,t,l){var r=j["keepSource"],o=H["tableData"],a=K["tableSourceData"];return r?((r=a[P.getRowIndex(e)])&&e&&(l?(a=_xeUtils.default.get(t||e,l),_xeUtils.default.set(e,l,a),_xeUtils.default.set(r,l,a)):(l=_xeUtils.default.clone(Object.assign({},t),!0),_xeUtils.default.destructuring(r,Object.assign(e,l)))),H.tableData=o.slice(0)):"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.reqProp",["keep-source"]),(0,_vue.nextTick)()},loadTreeChildren(r,e){const o=j["keepSource"],{tableSourceData:a,fullDataRowIdData:i,fullAllDataRowIdData:u,sourceDataRowIdData:n}=K;var t=le.value;const{transform:s,mapChildrenField:d}=t,c=t.children||t.childrenField,v=u[(0,_util.getRowid)(re,r)],g=v?v.level:0;return P.createData(e).then(e=>{if(o){const l=(0,_util.getRowid)(re,r);var t=_xeUtils.default.findTree(a,e=>l===(0,_util.getRowid)(re,e),{children:c});t&&(t.item[c]=_xeUtils.default.clone(e,!0)),e.forEach(e=>{var t=(0,_util.getRowid)(re,e);n[t]=_xeUtils.default.clone(e,!0)})}return _xeUtils.default.eachTree(e,(e,t,l,r,o,a)=>{var n=(0,_util.getRowid)(re,e),e={row:e,rowid:n,seq:-1,index:t,_index:-1,$index:-1,items:l,parent:o||v.row,level:g+a.length};i[n]=e,u[n]=e},{children:c}),r[c]=e,s&&(r[d]=e),Ke(),e})},loadColumn(e){e=_xeUtils.default.mapTree(e,e=>(0,_vue.reactive)(_cell.default.createColumn(re,e)));return it(e)},reloadColumn(e){return P.clearAll().then(()=>P.loadColumn(e))},getRowNode(e){if(e){var t=K["fullAllDataRowIdData"],e=e.getAttribute("rowid");if(e){t=t[e];if(t)return{rowid:t.rowid,item:t.row,index:t.index,items:t.items,parent:t.parent}}}return null},getColumnNode(e){if(e){var t=K["fullColumnIdData"],e=e.getAttribute("colid");if(e){t=t[e];if(t)return{colid:t.colid,item:t.column,index:t.index,items:t.items,parent:t.parent}}}return null},getRowSeq:e("seq"),getRowIndex:e("index"),getVTRowIndex:e("_index"),getVMRowIndex:e("$index"),getColumnIndex:t("index"),getVTColumnIndex:t("_index"),getVMColumnIndex:t("$index"),createData(e){return(0,_vue.nextTick)().then(()=>(0,_vue.reactive)(X.defineField(e)))},createRow(e){const t=_xeUtils.default.isArray(e);return t||(e=[e||{}]),P.createData(e).then(e=>t?e:e[0])},revertData(e,l){var t=j["keepSource"];const{tableSourceData:r,sourceDataRowIdData:o}=K;if(!t)return"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.reqProp",["keep-source"]),(0,_vue.nextTick)();let a=e;return e?_xeUtils.default.isArray(e)||(a=[e]):a=_xeUtils.default.toArray(re.getUpdateRecords()),a.length&&a.forEach(e=>{var t;P.isInsertByRow(e)||(t=(0,_util.getRowid)(re,e),(t=o[t])&&e&&(l?_xeUtils.default.set(e,l,_xeUtils.default.clone(_xeUtils.default.get(t,l),!0)):_xeUtils.default.destructuring(e,_xeUtils.default.clone(t,!0))))}),e?(0,_vue.nextTick)():P.reloadData(r)},clearData(e,t){const{tableFullData:l,visibleColumn:r}=K;return arguments.length?e&&!_xeUtils.default.isArray(e)&&(e=[e]):e=l,t?e.forEach(e=>_xeUtils.default.set(e,t,null)):e.forEach(t=>{r.forEach(e=>{e.field&&(0,_util.setCellValue)(t,e,null)})}),(0,_vue.nextTick)()},isInsertByRow(e){var t=H["editStore"],e=(0,_util.getRowid)(re,e);return t.insertMaps[e]},removeInsertRow(){var e=H["editStore"];return e.insertMaps={},re.remove(re.getInsertRecords())},isUpdateByRow(l,e){var t=j["keepSource"],{tableFullColumn:r,fullDataRowIdData:o,sourceDataRowIdData:a}=K;if(t){t=(0,_util.getRowid)(re,l);if(!o[t])return!1;var n=a[t];if(n){if(1<arguments.length)return!Me(n,l,e);for(let e=0,t=r.length;e<t;e++){var i=r[e].field;if(i&&!Me(n,l,i))return!0}}}return!1},getColumns(e){var t=K.visibleColumn;return _xeUtils.default.isUndefined(e)?t.slice(0):t[e]},getColumnById(e){var t=K.fullColumnIdData;return e&&t[e]?t[e].column:null},getColumnByField(e){var t=K.fullColumnFieldData;return e&&t[e]?t[e].column:null},getTableColumn(){return{collectColumn:K.collectColumn.slice(0),fullColumn:K.tableFullColumn.slice(0),visibleColumn:K.visibleColumn.slice(0),tableColumn:H.tableColumn.slice(0)}},getData(e){var t=j.data||K.tableSynchData;return _xeUtils.default.isUndefined(e)?t.slice(0):t[e]},getCheckboxRecords(l){var e=j["treeConfig"];const{tableFullData:t,afterFullData:r,afterTreeFullData:o,tableFullTreeData:a,fullDataRowIdData:n,afterFullRowMaps:i}=K;var u=le.value,{transform:s,mapChildrenField:d}=u;const c=T.value["checkField"];u=u.children||u.childrenField;let v=[];var g=l?s?a:t:s?o:r;return c?v=e?_xeUtils.default.filterTree(g,e=>_xeUtils.default.get(e,c),{children:s?d:u}):g.filter(e=>_xeUtils.default.get(e,c)):(e=H["selectCheckboxMaps"],_xeUtils.default.each(e,(e,t)=>{l?n[t]&&v.push(n[t].row):i[t]&&v.push(i[t])})),v},getParentRow(t){var l=j["treeConfig"],r=K["fullDataRowIdData"];if(t&&l){let e;if(e=_xeUtils.default.isString(t)?t:(0,_util.getRowid)(re,t))return(l=r[e])?l.parent:null}return null},getRowById(e){var t=K["fullDataRowIdData"],e=_xeUtils.default.eqNull(e)?"":encodeURIComponent(e||"");return t[e]?t[e].row:null},getRowid(e){return(0,_util.getRowid)(re,e)},getTableData(){var{tableData:e,footerTableData:t}=H,{tableFullData:l,afterFullData:r,tableFullTreeData:o}=K;return{fullData:(j.treeConfig?o:l).slice(0),visibleData:r.slice(0),tableData:e.slice(0),footerData:t.slice(0)}},setColumnFixed(e,t){var e=(0,_util.handleFieldOrColumn)(re,e),e=(0,_util.getRootColumn)(re,e),l=V.value,r=Z.value["maxFixedSize"];return e&&e.fixed!==t?!e.fixed&&l?(_vXETable.VXETable.modal&&_vXETable.VXETable.modal.message({status:"error",content:_conf.default.i18n("vxe.table.maxFixedCol",[r])}),(0,_vue.nextTick)()):(_xeUtils.default.eachTree([e],e=>{e.fixed=t}),X.saveCustomFixed(),P.refreshColumn()):(0,_vue.nextTick)()},clearColumnFixed(e){e=(0,_util.handleFieldOrColumn)(re,e),e=(0,_util.getRootColumn)(re,e);return e&&e.fixed?(_xeUtils.default.eachTree([e],e=>{e.fixed=null}),X.saveCustomFixed(),P.refreshColumn()):(0,_vue.nextTick)()},hideColumn(e){e=(0,_util.handleFieldOrColumn)(re,e);return e&&e.visible?(e.visible=!1,X.handleCustom()):(0,_vue.nextTick)()},showColumn(e){e=(0,_util.handleFieldOrColumn)(re,e);return e&&!e.visible?(e.visible=!0,X.handleCustom()):(0,_vue.nextTick)()},setColumnWidth(t,l){t=(0,_util.handleFieldOrColumn)(re,t);if(t){var r=_xeUtils.default.toInteger(l);let e=r;(0,_dom.isScale)(l)&&(l=(l=(l=B.value)?l.$el:null)?l.clientWidth-1:0,e=Math.floor(r*l)),t.renderWidth=e}return(0,_vue.nextTick)()},getColumnWidth(e){e=(0,_util.handleFieldOrColumn)(re,e);return e?e.renderWidth:0},resetColumn(e){var t=K["collectColumn"];const l=m.value["checkMethod"],r=Object.assign({visible:!0,resizable:!0===e,fixed:!0===e,sort:!0===e},e);return _xeUtils.default.eachTree(t,e=>{r.resizable&&(e.resizeWidth=0),r.fixed&&(e.fixed=e.defaultFixed),r.sort&&(e.renderSortNumber=e.sortNumber),l&&!l({column:e})||(e.visible=e.defaultVisible)}),r.resizable&&X.saveCustomResizable(!0),r.sort&&X.saveCustomSort(!0),r.fixed&&X.saveCustomFixed(),X.handleCustom()},refreshColumn(e){return e&&(e=_xeUtils.default.orderBy(K.collectColumn,"renderSortNumber"),K.collectColumn=e,e=at(e),K.tableFullColumn=e,qe()),nt().then(()=>P.refreshScroll()).then(()=>P.recalculate())},refreshScroll(){const{lastScrollLeft:t,lastScrollTop:l}=K;var e=B.value,r=Y.value,o=g.value,a=d.value;const n=e?e.$el:null,i=o?o.$el:null,u=a?a.$el:null,s=r?r.$el:null;return new Promise(e=>{if(t||l)return(0,_util.restoreScrollLocation)(re,t,l).then().then(()=>{setTimeout(e,30)});(0,_dom.setScrollTop)(n,l),(0,_dom.setScrollTop)(i,l),(0,_dom.setScrollTop)(u,l),(0,_dom.setScrollLeft)(s,t),setTimeout(e,30)})},recalculate(e){return je(),!0===e?Qe().then(()=>(je(),Qe())):Qe()},openTooltip(e,t){var l=ie.value;return l?l.open(e,t):(0,_vue.nextTick)()},closeTooltip(){var e=H["tooltipStore"],t=$.value,l=ie.value;return e.visible&&(Object.assign(e,{row:null,column:null,content:null,visible:!1}),t)&&t.close(),l&&l.close(),(0,_vue.nextTick)()},isAllCheckboxChecked(){return H.isAllSelected},isAllCheckboxIndeterminate(){return!H.isAllSelected&&H.isIndeterminate},getCheckboxIndeterminateRecords(e){var t=j["treeConfig"];const l=K["fullDataRowIdData"];var r=H["treeIndeterminateMaps"];if(t){const o=[],a=[];return _xeUtils.default.each(r,(e,t)=>{e&&(o.push(e),l[t])&&a.push(e)}),e?o:a}return[]},setCheckboxRow(e,t){return E(e,t,!0)},isCheckedByCheckboxRow(e){var t=H["selectCheckboxMaps"],l=T.value["checkField"];return l?_xeUtils.default.get(e,l):!!t[(0,_util.getRowid)(re,e)]},isIndeterminateByCheckboxRow(e){var t=H["treeIndeterminateMaps"];return!!t[(0,_util.getRowid)(re,e)]&&!P.isCheckedByCheckboxRow(e)},toggleCheckboxRow(e){var t=H["selectCheckboxMaps"],l=T.value["checkField"],l=l?!_xeUtils.default.get(e,l):!t[(0,_util.getRowid)(re,e)];return X.handleSelectRow({row:e},l,!0),(0,_vue.nextTick)()},setAllCheckboxRow(e){return Be(e,!0)},getRadioReserveRecord(e){var t=j["treeConfig"],{fullDataRowIdData:l,radioReserveRow:r,afterFullData:o}=K,a=R.value,n=le.value,n=n.children||n.childrenField;if(a.reserve&&r){const i=(0,_util.getRowid)(re,r);if(e){if(!l[i])return r}else{const u=(0,_util.getRowkey)(re);if(t){if(_xeUtils.default.findTree(o,e=>i===_xeUtils.default.get(e,u),{children:n}))return r}else if(!o.some(e=>i===_xeUtils.default.get(e,u)))return r}}return null},clearRadioReserve(){return(K.radioReserveRow=null,_vue.nextTick)()},getCheckboxReserveRecords(l){var e=j["treeConfig"];const{afterFullData:t,fullDataRowIdData:r,checkboxReserveRowMap:o}=K;var a=T.value,n=le.value,n=n.children||n.childrenField;const i=[];if(a.reserve){const u={};e?_xeUtils.default.eachTree(t,e=>{u[(0,_util.getRowid)(re,e)]=1},{children:n}):t.forEach(e=>{u[(0,_util.getRowid)(re,e)]=1}),_xeUtils.default.each(o,(e,t)=>{e&&(l?r[t]||i.push(e):u[t]||i.push(e))})}return i},clearCheckboxReserve(){return K.checkboxReserveRowMap={},(0,_vue.nextTick)()},toggleAllCheckboxRow(){return X.triggerCheckAllEvent(null,!H.isAllSelected),(0,_vue.nextTick)()},clearCheckboxRow(){const t=j["treeConfig"];var e=K["tableFullData"],l=le.value,l=l.children||l.childrenField,r=T.value;const{checkField:o,reserve:a}=r,n=r.indeterminateField||r.halfField;return o&&(r=e=>{t&&n&&_xeUtils.default.set(e,n,!1),_xeUtils.default.set(e,o,!1)},t?_xeUtils.default.eachTree(e,r,{children:l}):e.forEach(r)),a&&e.forEach(e=>C(e,!1)),H.isAllSelected=!1,H.isIndeterminate=!1,H.selectCheckboxMaps={},H.treeIndeterminateMaps={},(0,_vue.nextTick)()},setCurrentRow(e){var t=J.value,l=q.value;return P.clearCurrentRow(),H.currentRow=e,(t.isCurrent||j.highlightCurrentRow)&&l&&_xeUtils.default.arrayEach(l.querySelectorAll(`[rowid="${(0,_util.getRowid)(re,e)}"]`),e=>(0,_dom.addClass)(e,"row--current")),(0,_vue.nextTick)()},isCheckedByRadioRow(e){return re.eqRow(H.selectRadioRow,e)},setRadioRow(e){return We(e,!0)},clearCurrentRow(){var e=q.value;return H.currentRow=null,K.hoverRow=null,e&&_xeUtils.default.arrayEach(e.querySelectorAll(".row--current"),e=>(0,_dom.removeClass)(e,"row--current")),(0,_vue.nextTick)()},clearRadioRow(){return(H.selectRadioRow=null,_vue.nextTick)()},getCurrentRecord(){return J.value.isCurrent||j.highlightCurrentRow?H.currentRow:null},getRadioRecord(e){var{fullDataRowIdData:t,afterFullRowMaps:l}=K,r=H["selectRadioRow"];if(r){var o=(0,_util.getRowid)(re,r);if(e){if(t[o])return r}else if(l[o])return r}return null},getCurrentColumn(){return Z.value.isCurrent||j.highlightCurrentColumn?H.currentColumn:null},setCurrentColumn(e){e=(0,_util.handleFieldOrColumn)(re,e);return e&&(P.clearCurrentColumn(),H.currentColumn=e),(0,_vue.nextTick)()},clearCurrentColumn(){return(H.currentColumn=null,_vue.nextTick)()},setPendingRow(e,t){const l=Object.assign({},H.pendingRowMaps),r=[...H.pendingRowList];return e&&!_xeUtils.default.isArray(e)&&(e=[e]),t?e.forEach(e=>{var t=(0,_util.getRowid)(re,e);t&&!l[t]&&(r.push(e),l[t]=e)}):e.forEach(e=>{var t=(0,_util.getRowid)(re,e);t&&l[t]&&(-1<(e=re.findRowIndexOf(r,e))&&r.splice(e,1),delete l[t])}),H.pendingRowMaps=l,H.pendingRowList=r,(0,_vue.nextTick)()},togglePendingRow(e){const r=Object.assign({},H.pendingRowMaps),o=[...H.pendingRowList];return(e=e&&!_xeUtils.default.isArray(e)?[e]:e).forEach(e=>{var t,l=(0,_util.getRowid)(re,e);l&&(r[l]?(-1<(t=re.findRowIndexOf(o,e))&&o.splice(t,1),delete r[l]):(o.push(e),r[l]=e))}),H.pendingRowMaps=r,H.pendingRowList=o,(0,_vue.nextTick)()},hasPendingByRow(e){var t=H["pendingRowMaps"];return!!t[(0,_util.getRowid)(re,e)]},getPendingRecords(){var e=H["pendingRowList"];return e.slice(0)},clearPendingRow(){return H.pendingRowMaps={},H.pendingRowList=[],(0,_vue.nextTick)()},sort(e,t){const{multiple:l,remote:r,orders:a}=w.value;return e&&_xeUtils.default.isString(e)&&(e=[{field:e,order:t}]),(e=_xeUtils.default.isArray(e)?e:[e]).length?(l||Ve(),(l?e:[e[0]]).forEach((e,t)=>{let{field:l,order:r}=e,o=l;(o=_xeUtils.default.isString(l)?P.getColumnByField(l):o)&&o.sortable&&(-1===a.indexOf(r)&&(r=ke(o)),o.order!==r&&(o.order=r),o.sortTime=Date.now()+t)}),r||X.handleTableData(!0),(0,_vue.nextTick)().then(()=>(P.updateCellAreas(),b()))):(0,_vue.nextTick)()},clearSort(e){var t=w.value;return e?(e=(0,_util.handleFieldOrColumn)(re,e))&&(e.order=null):Ve(),t.remote||X.handleTableData(!0),(0,_vue.nextTick)().then(b)},isSort(e){return e?!!(e=(0,_util.handleFieldOrColumn)(re,e))&&e.sortable&&!!e.order:0<P.getSortColumns().length},getSortColumns(){var{multiple:e,chronological:t}=w.value;const r=[];var l=K["tableFullColumn"];return l.forEach(e=>{var{field:t,order:l}=e;e.sortable&&l&&r.push({column:e,field:t,property:t,order:l,sortTime:e.sortTime})}),e&&t&&1<r.length?_xeUtils.default.orderBy(r,"sortTime"):r},closeFilter(){var e=H["filterStore"],{column:t,visible:l}=e;return Object.assign(e,{isAllSelected:!1,isIndeterminate:!1,options:[],visible:!1}),l&&re.dispatchEvent("filter-visible",{column:t,property:t.field,field:t.field,filterList:re.getCheckedFilters(),visible:!1},null),(0,_vue.nextTick)()},isActiveFilterByColumn(e){e=(0,_util.handleFieldOrColumn)(re,e);return e?e.filters&&e.filters.some(e=>e.checked):0<re.getCheckedFilters().length},isFilter(e){return P.isActiveFilterByColumn(e)},isRowExpandLoaded(e){var t=K["fullAllDataRowIdData"],t=t[(0,_util.getRowid)(re,e)];return t&&!!t.expandLoaded},clearRowExpandLoaded(e){var t=H["rowExpandLazyLoadedMaps"],l=K["fullAllDataRowIdData"],r=y.value["lazy"],e=(0,_util.getRowid)(re,e),l=l[e];return r&&l&&(l.expandLoaded=!1,delete t[e]),(0,_vue.nextTick)()},reloadRowExpand(e){var t=H["rowExpandLazyLoadedMaps"],l=y.value["lazy"],r=(0,_util.getRowid)(re,e);return l&&!t[r]&&P.clearRowExpandLoaded(e).then(()=>Ze(e)),(0,_vue.nextTick)()},reloadExpandContent(e){return"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.delFunc",["reloadExpandContent","reloadRowExpand"]),P.reloadRowExpand(e)},toggleRowExpand(e){return P.setRowExpand(e,!P.isRowExpandByRow(e))},setAllRowExpand(e){var t=le.value,{tableFullData:l,tableFullTreeData:r}=K,t=t.children||t.childrenField;let o=[];return j.treeConfig?_xeUtils.default.eachTree(r,e=>{o.push(e)},{children:t}):o=l,P.setRowExpand(o,e)},setRowExpand(e,t){const{rowExpandedMaps:l,rowExpandLazyLoadedMaps:r,expandColumn:o}=H,a=K["fullAllDataRowIdData"];let n=Object.assign({},l);const{reserve:i,lazy:u,accordion:s,toggleMethod:d}=y.value,c=[],v=P.getColumnIndex(o),g=P.getVMColumnIndex(o);return e&&(_xeUtils.default.isArray(e)||(e=[e]),s&&(n={},e=e.slice(e.length-1,e.length)),e=d?e.filter(e=>d({$table:re,expanded:t,column:o,columnIndex:v,$columnIndex:g,row:e,rowIndex:P.getRowIndex(e),$rowIndex:P.getVMRowIndex(e)})):e,t?e.forEach(e=>{var t,l=(0,_util.getRowid)(re,e);n[l]||(t=a[l],u&&!t.expandLoaded&&!r[l]?c.push(Ze(e)):n[l]=e)}):e.forEach(e=>{e=(0,_util.getRowid)(re,e);n[e]&&delete n[e]}),i)&&e.forEach(e=>Je(e,t)),H.rowExpandedMaps=n,Promise.all(c).then(()=>P.recalculate())},isRowExpandByRow(e){var t=H["rowExpandedMaps"];return!!t[(0,_util.getRowid)(re,e)]},isExpandByRow(e){return"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.delFunc",["isExpandByRow","isRowExpandByRow"]),P.isRowExpandByRow(e)},clearRowExpand(){var e=K["tableFullData"],t=y.value["reserve"];const l=P.getRowExpandRecords();return H.rowExpandedMaps={},t&&e.forEach(e=>Je(e,!1)),(0,_vue.nextTick)().then(()=>{l.length&&P.recalculate()})},clearRowExpandReserve(){return K.rowExpandedReserveRowMap={},(0,_vue.nextTick)()},getRowExpandRecords(){const t=[];return _xeUtils.default.each(H.rowExpandedMaps,e=>{e&&t.push(e)}),t},getTreeExpandRecords(){const t=[];return _xeUtils.default.each(H.treeExpandedMaps,e=>{e&&t.push(e)}),t},isTreeExpandLoaded(e){var t=K["fullAllDataRowIdData"],t=t[(0,_util.getRowid)(re,e)];return t&&!!t.treeLoaded},clearTreeExpandLoaded(e){var t=H["treeExpandedMaps"],l=K["fullAllDataRowIdData"],{transform:r,lazy:o}=le.value,e=(0,_util.getRowid)(re,e),l=l[e];return o&&l&&(l.treeLoaded=!1,t[e])&&delete t[e],r?(i(),X.handleTableData()):(0,_vue.nextTick)()},reloadTreeExpand(e){var t=H["treeExpandLazyLoadedMaps"],l=le.value,r=l.hasChild||l.hasChildField;const{transform:o,lazy:a}=l;l=(0,_util.getRowid)(re,e);return a&&e[r]&&!t[l]&&P.clearTreeExpandLoaded(e).then(()=>Ye(e)).then(()=>{if(o)return i(),X.handleTableData()}).then(()=>P.recalculate()),(0,_vue.nextTick)()},reloadTreeChilds(e){return"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.delFunc",["reloadTreeChilds","reloadTreeExpand"]),P.reloadTreeExpand(e)},toggleTreeExpand(e){return P.setTreeExpand(e,!P.isTreeExpandByRow(e))},setAllTreeExpand(e){var t=K["tableFullData"],l=le.value;const{transform:r,lazy:o}=l,a=l.children||l.childrenField,n=[];return _xeUtils.default.eachTree(t,e=>{var t=e[a];(o||t&&t.length)&&n.push(e)},{children:a}),P.setTreeExpand(n,e).then(()=>{if(r)return i(),P.recalculate()})},setTreeExpand(e,t){var l,r=le.value["transform"];return e&&(e=_xeUtils.default.isArray(e)?e:[e]).length?r?(r=e,l=t,st(r,l).then(()=>(i(),X.handleTableData())).then(()=>P.recalculate())):st(e,t):(0,_vue.nextTick)()},isTreeExpandByRow(e){var t=H["treeExpandedMaps"];return!!t[(0,_util.getRowid)(re,e)]},clearTreeExpand(){var e=K["tableFullTreeData"],t=le.value,l=t.children||t.childrenField;const{transform:r,reserve:o}=t,a=P.getTreeExpandRecords();return H.treeExpandedMaps={},o&&_xeUtils.default.eachTree(e,e=>Ge(e,!1),{children:l}),X.handleTableData().then(()=>{if(r)return i(),X.handleTableData()}).then(()=>{if(a.length)return P.recalculate()})},clearTreeExpandReserve(){return K.treeExpandedReserveRowMap={},(0,_vue.nextTick)()},getScroll(){var{scrollXLoad:e,scrollYLoad:t}=H,l=B.value.$el;return{virtualX:e,virtualY:t,scrollTop:l.scrollTop,scrollLeft:l.scrollLeft}},scrollTo(e,t){var l=B.value,r=Y.value,o=d.value,l=l?l.$el:null,o=o?o.$el:null,r=r?r.$el:null;return _xeUtils.default.isNumber(e)&&(0,_dom.setScrollLeft)(r||l,e),_xeUtils.default.isNumber(t)&&(0,_dom.setScrollTop)(o||l,t),H.scrollXLoad||H.scrollYLoad?new Promise(e=>{setTimeout(()=>{(0,_vue.nextTick)(()=>{e()})},50)}):(0,_vue.nextTick)()},scrollToRow(e,t){var l=[];return e&&(j.treeConfig?l.push(X.scrollToTreeRow(e)):l.push((0,_util.rowToVisible)(re,e))),t&&l.push(P.scrollToColumn(t)),Promise.all(l)},scrollToColumn(e){var t=K["fullColumnIdData"],e=(0,_util.handleFieldOrColumn)(re,e);return e&&t[e.id]?(0,_util.colToVisible)(re,e):(0,_vue.nextTick)()},clearScroll(){var{scrollXStore:e,scrollYStore:t}=K,l=B.value,r=Y.value,o=d.value,l=l?l.$el:null,o=o?o.$el:null,r=r?r.$el:null;return o&&((0,_util.restoreScrollListener)(o),o.scrollTop=0),r&&(r.scrollLeft=0),l&&((0,_util.restoreScrollListener)(l),l.scrollTop=0,l.scrollLeft=0),e.startIndex=0,(t.startIndex=0,_vue.nextTick)()},updateFooter(){var{showFooter:e,footerData:t,footerMethod:l}=j,{visibleColumn:r,afterFullData:o}=K;let a=[];return e&&t&&t.length?a=t.slice(0):e&&l&&(a=r.length?l({columns:r,data:o,$table:re,$grid:G}):[]),H.footerTableData=a,(0,_vue.nextTick)()},updateStatus(n,i){const u=!_xeUtils.default.isUndefined(i);return(0,_vue.nextTick)().then(()=>{var e=j["editRules"];const t=H["validStore"];var l=B.value;if(n&&l&&e){const{row:r,column:o}=n;if(re.hasCellRules&&re.hasCellRules("change",r,o)){const a=X.getCell(r,o);if(a)return re.validCellRules("change",r,o,i).then(()=>{u&&t.visible&&(0,_util.setCellValue)(r,o,i),re.clearValidate(r,o)}).catch(({rule:e})=>{u&&(0,_util.setCellValue)(r,o,i),re.showValidTooltip({rule:e,row:r,column:o,cell:a})})}}})},setMergeCells(e){return j.spanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-cells","span-method"]),Ne(e,H.mergeList,K.afterFullData),(0,_vue.nextTick)().then(()=>(P.updateCellAreas(),b()))},removeMergeCells(e){j.spanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-cells","span-method"]);const t=Ae(e,H.mergeList,K.afterFullData);return(0,_vue.nextTick)().then(()=>(P.updateCellAreas(),b(),t))},getMergeCells(){return H.mergeList.slice(0)},clearMergeCells(){return H.mergeList=[],(0,_vue.nextTick)().then(()=>b())},setMergeFooterItems(e){return j.footerSpanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-footer-items","footer-span-method"]),Ne(e,H.mergeFooterList),(0,_vue.nextTick)().then(()=>(P.updateCellAreas(),b()))},removeMergeFooterItems(e){j.footerSpanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-footer-items","footer-span-method"]);const t=Ae(e,H.mergeFooterList);return(0,_vue.nextTick)().then(()=>(P.updateCellAreas(),b(),t))},getMergeFooterItems(){return H.mergeFooterList.slice(0)},clearMergeFooterItems(){return H.mergeFooterList=[],(0,_vue.nextTick)().then(()=>b())},updateCellAreas(){var e=j["mouseConfig"],t=ee.value;return e&&t.area&&re.handleUpdateCellAreas?re.handleUpdateCellAreas():(0,_vue.nextTick)()},focus(){return K.isActivated=!0,(0,_vue.nextTick)()},blur(){return(K.isActivated=!1,_vue.nextTick)()},connect(e){return e?(h=e).syncUpdate({collectColumn:K.collectColumn,$table:re}):(0,_log.errLog)("vxe.error.barUnableLink"),(0,_vue.nextTick)()}};const gt=l=>{var{editStore:e,ctxMenuStore:t,filterStore:r,customStore:o}=H,{mouseConfig:a,editRules:n}=j;const i=q.value,u=Q.value;var s=me.value,d=k.value;const c=e["actived"];var e=ue.value,v=de.value,g=ce.value,f=se.value,r=(!v||(0,_dom.getEventTargetNode)(l,i,"vxe-cell--filter").flag||(0,_dom.getEventTargetNode)(l,v.$el).flag||(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-clear").flag||X.preventEvent(l,"event.clearFilter",r.args,P.closeFilter),!g||o.btnEl===l.target||(0,_dom.getEventTargetNode)(l,document.body,"vxe-toolbar-custom-target").flag||(0,_dom.getEventTargetNode)(l,g.$el).flag||(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-clear").flag||X.preventEvent(l,"event.clearCustom",{},()=>{re.closeCustom&&re.closeCustom()}),c.row?!1===u.autoClear||(v=c.args.cell)&&(0,_dom.getEventTargetNode)(l,v).flag||e&&(0,_dom.getEventTargetNode)(l,e.$el).flag||K._lastCallTime&&!(K._lastCallTime+50<Date.now())||(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-clear").flag||X.preventEvent(l,"event.clearEdit",c.args,()=>{let e;var t;(e=(e=(e="row"===u.mode?!!(t=(t=(0,_dom.getEventTargetNode)(l,i,"vxe-body--row")).flag?P.getRowNode(t.targetElem):null)&&!re.eqRow(t.item,c.args.row):!(0,_dom.getEventTargetNode)(l,i,"col--edit").flag)||(0,_dom.getEventTargetNode)(l,i,"vxe-header--row").flag)||(0,_dom.getEventTargetNode)(l,i,"vxe-footer--row").flag)||!j.height||H.overflowY||(t=l.target,(0,_dom.hasClass)(t,"vxe-table--body-wrapper")&&(e=l.offsetY<t.clientHeight)),!e&&(0,_dom.getEventTargetNode)(l,i).flag||setTimeout(()=>re.clearEdit(l))}):!a||(0,_dom.getEventTargetNode)(l,i).flag||G&&(0,_dom.getEventTargetNode)(l,G.getRefMaps().refElem.value).flag||f&&(0,_dom.getEventTargetNode)(l,f.getRefMaps().refElem.value).flag||h&&(0,_dom.getEventTargetNode)(l,h.getRefMaps().refElem.value).flag||(re.clearSelected&&re.clearSelected(),!d.autoClear)||re.clearCellAreas&&!(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-areas-clear").flag&&X.preventEvent(l,"event.clearAreas",{},()=>{re.clearCellAreas(),re.clearCopyCellArea()}),re.closeMenu&&t.visible&&f&&!(0,_dom.getEventTargetNode)(l,f.getRefMaps().refElem.value).flag&&re.closeMenu(),(0,_dom.getEventTargetNode)(l,G?G.getRefMaps().refElem.value:i).flag);!r&&n&&s.autoClear&&(H.validErrorMaps={}),K.isActivated=r},ft=()=>{P.closeFilter(),re.closeMenu&&re.closeMenu()},ht=()=>{P.closeTooltip(),re.closeMenu&&re.closeMenu()},mt=t=>{const{mouseConfig:l,keyboardConfig:r}=j,{filterStore:o,ctxMenuStore:a,editStore:e}=H,n=ee.value,i=te.value,u=e["actived"];(0,_event.hasEventKey)(t,_event.EVENT_KEYS.ESCAPE)&&X.preventEvent(t,"event.keydown",null,()=>{if(P.dispatchEvent("keydown-start",{},t),r&&l&&n.area&&re.handleKeyboardEvent)re.handleKeyboardEvent(t);else if((u.row||o.visible||a.visible)&&(t.stopPropagation(),re.closeMenu&&re.closeMenu(),P.closeFilter(),r)&&i.isEsc&&u.row){const e=u.args;re.clearEdit(t),n.selected&&(0,_vue.nextTick)(()=>re.handleSelected(e,t))}P.dispatchEvent("keydown",{},t),P.dispatchEvent("keydown-end",{},t)})},pt=$=>{K.isActivated&&X.preventEvent($,"event.keydown",null,()=>{var{mouseConfig:e,keyboardConfig:t,treeConfig:l,editConfig:r,highlightCurrentRow:o}=j;const{ctxMenuStore:a,editStore:N,currentRow:n}=H;var i=we.value,u=_e.value,s=te.value,d=ee.value,c=Q.value,v=le.value,g=be.value,f=J.value;const{selected:h,actived:m}=N;var v=v.children||v.childrenField,p=$.keyCode,x=(0,_event.hasEventKey)($,_event.EVENT_KEYS.ESCAPE),_=(0,_event.hasEventKey)($,_event.EVENT_KEYS.BACKSPACE),A=(0,_event.hasEventKey)($,_event.EVENT_KEYS.TAB),w=(0,_event.hasEventKey)($,_event.EVENT_KEYS.ENTER),b=(0,_event.hasEventKey)($,_event.EVENT_KEYS.SPACEBAR),C=(0,_event.hasEventKey)($,_event.EVENT_KEYS.ARROW_LEFT),E=(0,_event.hasEventKey)($,_event.EVENT_KEYS.ARROW_UP),R=(0,_event.hasEventKey)($,_event.EVENT_KEYS.ARROW_RIGHT),T=(0,_event.hasEventKey)($,_event.EVENT_KEYS.ARROW_DOWN),y=(0,_event.hasEventKey)($,_event.EVENT_KEYS.DELETE),S=(0,_event.hasEventKey)($,_event.EVENT_KEYS.F2),D=(0,_event.hasEventKey)($,_event.EVENT_KEYS.CONTEXT_MENU),V=$.metaKey,M=$.ctrlKey,k=$.shiftKey,z=$.altKey,q=C||E||R||T,i=i&&a.visible&&(w||b||q),I=(0,_utils.isEnableConf)(r)&&m.column&&m.row;let L;if(i)$.preventDefault(),a.showChild&&(0,_utils.hasChildrenList)(a.selected)?re.moveCtxMenu($,a,"selectChild",C,!1,a.selected.children):re.moveCtxMenu($,a,"selected",R,!0,g);else if(t&&e&&d.area&&re.handleKeyboardEvent)re.handleKeyboardEvent($);else if(x){if(re.closeMenu&&re.closeMenu(),P.closeFilter(),t&&s.isEsc&&m.row){const L=m.args;re.clearEdit($),d.selected&&(0,_vue.nextTick)(()=>re.handleSelected(L,$))}}else if(b&&t&&s.isChecked&&h.row&&h.column&&("checkbox"===h.column.type||"radio"===h.column.type))$.preventDefault(),"checkbox"===h.column.type?X.handleToggleCheckRowEvent($,h.args):X.triggerRadioRowEvent($,h.args);else if(S&&(0,_utils.isEnableConf)(r))I||h.row&&h.column&&($.preventDefault(),re.handleActived(h.args,$));else if(D)K._keyCtx=h.row&&h.column&&u.length,clearTimeout(vt),vt=setTimeout(()=>{K._keyCtx=!1},1e3);else if(w&&!z&&t&&s.isEnter&&(h.row||m.row||l&&(f.isCurrent||o)&&n)){if(M)m.row&&(L=m.args,re.clearEdit($),d.selected)&&(0,_vue.nextTick)(()=>re.handleSelected(L,$));else if(h.row||m.row){i=(h.row?h:m).args;k?s.enterToTab?re.moveTabSelected(i,k,$):re.moveSelected(i,C,!0,R,!1,$):s.enterToTab?re.moveTabSelected(i,k,$):re.moveSelected(i,C,!1,R,!0,$)}else if(l&&(f.isCurrent||o)&&n){g=n[v];if(g&&g.length){$.preventDefault();const F=g[0];L={$table:re,row:F,rowIndex:P.getRowIndex(F),$rowIndex:P.getVMRowIndex(F)},P.setTreeExpand(n,!0).then(()=>P.scrollToRow(F)).then(()=>X.triggerCurrentRowEvent($,L))}}}else if(q&&t&&s.isArrow)I||(h.row&&h.column?re.moveSelected(h.args,C,E,R,T,$):(E||T)&&(f.isCurrent||o)&&re.moveCurrentRow(E,T,$));else if(A&&t&&s.isTab)h.row||h.column?re.moveTabSelected(h.args,k,$):(m.row||m.column)&&re.moveTabSelected(m.args,k,$);else if(t&&(0,_utils.isEnableConf)(r)&&(y||(l&&(f.isCurrent||o)&&n?_&&s.isArrow:_))){if(!I){var{delMethod:e,backMethod:x}=s;if(s.isDel&&(h.row||h.column)){S={row:h.row,rowIndex:P.getRowIndex(h.row),column:h.column,columnIndex:P.getColumnIndex(h.column),$table:re};e?e(S):(0,_util.setCellValue)(h.row,h.column,null),_?x?x({row:h.row,rowIndex:P.getRowIndex(h.row),column:h.column,columnIndex:P.getColumnIndex(h.column),$table:re}):re.handleActived(h.args,$):y&&P.updateFooter(),re.dispatchEvent("cell-delete-value",S,$)}else if(_&&s.isArrow&&l&&(f.isCurrent||o)&&n){const U=_xeUtils.default.findTree(K.afterFullData,e=>e===n,{children:v})["parent"];U&&($.preventDefault(),L={$table:re,row:U,rowIndex:P.getRowIndex(U),$rowIndex:P.getVMRowIndex(U)},P.setTreeExpand(U,!1).then(()=>P.scrollToRow(U)).then(()=>X.triggerCurrentRowEvent($,L)))}}}else if(t&&(0,_utils.isEnableConf)(r)&&s.isEdit&&!M&&!V&&(b||48<=p&&p<=57||65<=p&&p<=90||96<=p&&p<=111||186<=p&&p<=192||219<=p&&p<=222)){D=s["editMethod"];if(h.column&&h.row&&(0,_utils.isEnableConf)(h.column.editRender)){u=c.beforeEditMethod||c.activeMethod;if(!u||u(Object.assign(Object.assign({},h.args),{$table:re,$grid:G}))){D?D({row:h.row,rowIndex:P.getRowIndex(h.row),column:h.column,columnIndex:P.getColumnIndex(h.column),$table:re,$grid:G}):((0,_util.setCellValue)(h.row,h.column,null),re.handleActived(h.args,$));const O=c.afterEditMethod;O&&(0,_vue.nextTick)(()=>{O({row:h.row,rowIndex:P.getRowIndex(h.row),column:h.column,columnIndex:P.getColumnIndex(h.column),$table:re,$grid:G})})}}}P.dispatchEvent("keydown",{},$)})},xt=e=>{var{keyboardConfig:t,mouseConfig:l}=j,{editStore:r,filterStore:o}=H,a=K["isActivated"],n=ee.value,i=te.value,r=r["actived"];a&&!o.visible&&(r.row||r.column||t&&i.isClip&&l&&n.area&&re.handlePasteCellAreaEvent&&re.handlePasteCellAreaEvent(e),P.dispatchEvent("paste",{},e))},_t=e=>{var{keyboardConfig:t,mouseConfig:l}=j,{editStore:r,filterStore:o}=H,a=K["isActivated"],n=ee.value,i=te.value,r=r["actived"];a&&!o.visible&&(r.row||r.column||t&&i.isClip&&l&&n.area&&re.handleCopyCellAreaEvent&&re.handleCopyCellAreaEvent(e),P.dispatchEvent("copy",{},e))},wt=e=>{var{keyboardConfig:t,mouseConfig:l}=j,{editStore:r,filterStore:o}=H,a=K["isActivated"],n=ee.value,i=te.value,r=r["actived"];a&&!o.visible&&(r.row||r.column||t&&i.isClip&&l&&n.area&&re.handleCutCellAreaEvent&&re.handleCutCellAreaEvent(e),P.dispatchEvent("cut",{},e))},bt=()=>{re.closeMenu&&re.closeMenu(),P.updateCellAreas(),P.recalculate(!0)},Ct=e=>{var t=$.value;clearTimeout(K.tooltipTimeout),e?P.closeTooltip():t&&t.setActived(!0)},Et=(e,t,l,r,o)=>{o.cell=t;var t=H["tooltipStore"],{column:a,row:n}=o,{showAll:i,contentMethod:u}=c.value,o=u?u(o):null,u=u&&!_xeUtils.default.eqNull(o);const s=u?o:_xeUtils.default.toString("html"===a.type?l.innerText:l.textContent).trim(),d=l.scrollWidth>l.clientWidth;return s&&(i||u||d)&&(Object.assign(t,{row:n,column:a,visible:!0}),(0,_vue.nextTick)(()=>{var e=$.value;e&&e.open(!d&&r||l,(0,_utils.formatText)(s))})),(0,_vue.nextTick)()},Rt=(X={getSetupOptions(){return _conf.default},updateAfterDataIndex:Ke,callSlot(e,t){if(e){if(G)return G.callSlot(e,t);if(_xeUtils.default.isFunction(e))return(0,_vn.getSlotVNs)(e(t))}return[]},getParentElem(){var e,t=q.value;return G?(e=G.getRefMaps().refElem.value)?e.parentNode:null:t?t.parentNode:null},getParentHeight(){var e=j["height"],t=q.value;return t?(t=t.parentNode,e="auto"===e?(0,_dom.getPaddingTopBottomSize)(t):0,Math.floor(G?G.getParentHeight():_xeUtils.default.toNumber(getComputedStyle(t).height)-e)):0},getExcludeHeight(){return G?G.getExcludeHeight():0},defineField(e){const t=j["treeConfig"],l=y.value,r=le.value,a=R.value,n=T.value,i=r.children||r.childrenField,u=(0,_util.getRowkey)(re);return(e=_xeUtils.default.isArray(e)?e:[e]).map(o=>{return K.tableFullColumn.forEach(t=>{var{field:l,editRender:r}=t;if(l&&!_xeUtils.default.has(o,l)&&!o[l]){let e=null;r&&(r=r["defaultValue"],_xeUtils.default.isFunction(r)?e=r({column:t}):_xeUtils.default.isUndefined(r)||(e=r)),_xeUtils.default.set(o,l,e)}}),[a.labelField,n.checkField,n.labelField,l.labelField].forEach(e=>{e&&(0,_utils.eqEmptyValue)(_xeUtils.default.get(o,e))&&_xeUtils.default.set(o,e,null)}),t&&r.lazy&&_xeUtils.default.isUndefined(o[i])&&(o[i]=null),(0,_utils.eqEmptyValue)(_xeUtils.default.get(o,u))&&_xeUtils.default.set(o,u,(0,_util.getRowUniqueId)()),o})},handleTableData(l){var e=H["scrollYLoad"];const{scrollYStore:t,fullDataRowIdData:r}=K;let o=K.afterFullData;if(l){{var l=j["treeConfig"],{tableFullColumn:a,tableFullData:n,tableFullTreeData:u}=K,s=M.value,d=w.value,c=le.value,v=c["transform"];const{remote:g,filterMethod:f}=s,{remote:h,sortMethod:m,multiple:p,chronological:x}=d;let e=[],t=[];if(g&&h)l&&v?(t=_xeUtils.default.searchTree(u,()=>!0,Object.assign(Object.assign({},c),{original:!0})),e=t):(e=(l?u:n).slice(0),t=e);else{const _=[];let i=[];a.forEach(e=>{var{field:t,sortable:l,order:r,filters:o}=e;if(!g&&o&&o.length){const a=[],n=[];o.forEach(e=>{e.checked&&(n.push(e),a.push(e.value))}),n.length&&_.push({column:e,valueList:a,itemList:n})}!h&&l&&r&&i.push({column:e,field:t,property:t,order:r,sortTime:e.sortTime})}),p&&x&&1<i.length&&(i=_xeUtils.default.orderBy(i,"sortTime")),!g&&_.length?(s=s=>_.every(({column:t,valueList:e,itemList:l})=>{const{filterMethod:r,filterRender:o}=t;var a=o?_vXETable.VXETable.renderer.get(o.name):null;const n=a?a.filterMethod:null,i=a?a.defaultFilterMethod:null,u=(0,_util.getCellValue)(s,t);return r?l.some(e=>r({value:e.value,option:e,cellValue:u,row:s,column:t,$table:re})):n?l.some(e=>n({value:e.value,option:e,cellValue:u,row:s,column:t,$table:re})):f?f({options:l,values:e,cellValue:u,row:s,column:t}):i?l.some(e=>i({value:e.value,option:e,cellValue:u,row:s,column:t,$table:re})):-1<e.indexOf(_xeUtils.default.get(s,t.field))}),l&&v?(t=_xeUtils.default.searchTree(u,s,Object.assign(Object.assign({},c),{original:!0})),e=t):(e=(l?u:n).filter(s),t=e)):l&&v?(t=_xeUtils.default.searchTree(u,()=>!0,Object.assign(Object.assign({},c),{original:!0})),e=t):(e=(l?u:n).slice(0),t=e),!h&&i.length&&(l&&v?(t=m?(d=m({data:t,sortList:i,$table:re}),_xeUtils.default.isArray(d)?d:t):_xeUtils.default.orderBy(t,i.map(({column:e,order:t})=>[He(e),t])),e=t):(e=m?(a=m({data:e,sortList:i,$table:re}),_xeUtils.default.isArray(a)?a:e):_xeUtils.default.orderBy(e,i.map(({column:e,order:t})=>[He(e),t])),t=e))}K.afterFullData=e,K.afterTreeFullData=t,Ke()}o=i()}s=e?o.slice(t.startIndex,t.endIndex):o.slice(0);return s.forEach((e,t)=>{e=(0,_util.getRowid)(re,e),e=r[e];e&&(e.$index=t)}),H.tableData=s,(0,_vue.nextTick)()},cacheRowMap(i){const u=j["treeConfig"];var e=le.value;let{fullDataRowIdData:s,fullAllDataRowIdData:d,tableFullData:t,tableFullTreeData:l}=K;const c=e.children||e.childrenField,v=e.hasChild||e.hasChildField,g=(0,_util.getRowkey)(re),f=u&&e.lazy;e=(e,t,l,r,o,a)=>{let n=(0,_util.getRowid)(re,e);r=u&&r?(0,_util.toTreePathSeq)(r):t+1,a=a?a.length-1:0,(0,_utils.eqEmptyValue)(n)&&(n=(0,_util.getRowUniqueId)(),_xeUtils.default.set(e,g,n)),f&&e[v]&&_xeUtils.default.isUndefined(e[c])&&(e[c]=null),e={row:e,rowid:n,seq:r,index:u&&o?-1:t,_index:-1,$index:-1,items:l,parent:o,level:a};i&&(s[n]=e),d[n]=e};i&&(s=K.fullDataRowIdData={}),d=K.fullAllDataRowIdData={},u?_xeUtils.default.eachTree(l,e,{children:c}):t.forEach(e)},cacheSourceMap(e){var t=j["treeConfig"],l=le.value;let r=K["sourceDataRowIdData"];e=_xeUtils.default.clone(e,!0);const o=(0,_util.getRowkey)(re);r=K.sourceDataRowIdData={};var a=e=>{let t=(0,_util.getRowid)(re,e);(0,_utils.eqEmptyValue)(t)&&(t=(0,_util.getRowUniqueId)(),_xeUtils.default.set(e,o,t)),r[t]=e};t?(t=l.children||l.childrenField,_xeUtils.default.eachTree(e,a,{children:l.transform?l.mapChildrenField:t})):e.forEach(a),K.tableSourceData=e},analyColumnWidth(){var e=K["tableFullColumn"];const{width:t,minWidth:l}=Z.value,r=[],o=[],a=[],n=[],i=[],u=[];e.forEach(e=>{t&&!e.width&&(e.width=t),l&&!e.minWidth&&(e.minWidth=l),e.visible&&(e.resizeWidth?r:(0,_dom.isPx)(e.width)?o:(0,_dom.isScale)(e.width)?n:(0,_dom.isPx)(e.minWidth)?a:(0,_dom.isScale)(e.minWidth)?i:u).push(e)}),Object.assign(H.columnStore,{resizeList:r,pxList:o,pxMinList:a,scaleList:n,scaleMinList:i,autoList:u})},saveCustomResizable(e){var{id:t,customConfig:l}=j,r=m.value,o=K["collectColumn"],r=r["storage"],a=!0===r,r=a?{}:Object.assign({},r||{}),a=a||r.resizable;if(l&&a){r=v(resizableStorageKey);let l;t?(e||(l=_xeUtils.default.isPlainObject(r[t])?r[t]:{},_xeUtils.default.eachTree(o,e=>{var t;e.resizeWidth&&(t=e.getKey())&&(l[t]=e.renderWidth)})),r[t]=_xeUtils.default.isEmpty(l)?void 0:l,localStorage.setItem(resizableStorageKey,_xeUtils.default.toJSONString(r))):(0,_log.errLog)("vxe.error.reqProp",["id"])}},saveCustomSort(e){var{id:t,customConfig:l}=j,r=m.value,o=K["collectColumn"],r=r["storage"],a=!0===r,r=a?{}:Object.assign({},r||{}),a=a||r.sort;if(l&&a){r=v(sortStorageKey);let l;t?(e||(l=_xeUtils.default.isPlainObject(r[t])?r[t]:{},o.forEach(e=>{var t;e.sortNumber!==e.renderSortNumber&&(t=e.getKey())&&(l[t]=e.renderSortNumber)})),r[t]=_xeUtils.default.isEmpty(l)?void 0:l,localStorage.setItem(sortStorageKey,_xeUtils.default.toJSONString(r))):(0,_log.errLog)("vxe.error.reqProp",["id"])}},saveCustomFixed(){var{id:e,customConfig:t}=j,l=K["collectColumn"],r=m.value["storage"],o=!0===r,r=o?{}:Object.assign({},r||{}),o=o||r.fixed;if(t&&o){r=v(fixedStorageKey);const a=[];e?(_xeUtils.default.eachTree(l,e=>{var t;e.fixed&&e.fixed!==e.defaultFixed&&(t=e.getKey())&&a.push(t+"|"+e.fixed)}),r[e]=a.join(",")||void 0,localStorage.setItem(fixedStorageKey,_xeUtils.default.toJSONString(r))):(0,_log.errLog)("vxe.error.reqProp",["id"])}},saveCustomVisible(){var{id:e,customConfig:t}=j,l=K["collectColumn"];const{checkMethod:r,storage:o}=m.value;var a=!0===o,n=a?{}:Object.assign({},o||{}),a=a||n.visible;if(t&&a){n=v(visibleStorageKey);const i=[],u=[];e?(_xeUtils.default.eachTree(l,e=>{var t;r&&!r({column:e})||(!e.visible&&e.defaultVisible?(t=e.getKey())&&i.push(t):e.visible&&!e.defaultVisible&&(t=e.getKey())&&u.push(t))}),n[e]=[i.join(",")].concat(u.length?[u.join(",")]:[]).join("|")||void 0,localStorage.setItem(visibleStorageKey,_xeUtils.default.toJSONString(n))):(0,_log.errLog)("vxe.error.reqProp",["id"])}},handleCustom(){var e=j["mouseConfig"];return e&&(re.clearSelected&&re.clearSelected(),re.clearCellAreas)&&(re.clearCellAreas(),re.clearCopyCellArea()),X.saveCustomVisible(),X.saveCustomSort(),X.analyColumnWidth(),P.refreshColumn(!0)},handleUpdateDataQueue(){H.upDataFlag++},handleRefreshColumnQueue(){H.reColumnFlag++},preventEvent(t,e,l,r,o){let a=_vXETable.VXETable.interceptor.get(e);a.length||"event.clearEdit"!==e||(a=_vXETable.VXETable.interceptor.get("event.clearActived"),"development"===process.env.NODE_ENV&&a.length&&(0,_log.warnLog)("vxe.error.delEvent",["event.clearActived","event.clearEdit"]));let n;return a.some(e=>!1===e(Object.assign({$grid:G,$table:re,$event:t},l)))||r&&(n=r()),o&&o(),n},checkSelectionStatus(){var r=j["treeConfig"];const{selectCheckboxMaps:o,treeIndeterminateMaps:a}=H;var n=K["afterFullData"],e=T.value;const{checkField:i,checkStrictly:t,checkMethod:u}=e,s=e.indeterminateField||e.halfField;if(!t){const d=[],c=[];let e=!1,t=!1,l=!1;l=i?(e=n.every(u?e=>u({row:e})?!!_xeUtils.default.get(e,i)&&(c.push(e),!0):(d.push(e),!0):e=>_xeUtils.default.get(e,i)),t=e&&n.length!==d.length,r?s?!t&&n.some(e=>_xeUtils.default.get(e,i)||_xeUtils.default.get(e,s)||!!a[(0,_util.getRowid)(re,e)]):!t&&n.some(e=>_xeUtils.default.get(e,i)||!!a[(0,_util.getRowid)(re,e)]):s?!t&&n.some(e=>_xeUtils.default.get(e,i)||_xeUtils.default.get(e,s)):!t&&n.some(e=>_xeUtils.default.get(e,i))):(e=n.every(u?e=>u({row:e})?!!o[(0,_util.getRowid)(re,e)]&&(c.push(e),!0):(d.push(e),!0):e=>o[(0,_util.getRowid)(re,e)]),t=e&&n.length!==d.length,r?!t&&n.some(e=>{e=(0,_util.getRowid)(re,e);return a[e]||o[e]}):!t&&n.some(e=>o[(0,_util.getRowid)(re,e)])),H.isAllSelected=t,H.isIndeterminate=l}},handleSelectRow({row:l},r,o){var e=j["treeConfig"];const{selectCheckboxMaps:t,treeIndeterminateMaps:a}=H,n=Object.assign({},t);var i=K["afterFullData"],u=le.value,u=u.children||u.childrenField,s=T.value;const{checkField:d,checkStrictly:c,checkMethod:v}=s,g=s.indeterminateField||s.halfField;s=(0,_util.getRowid)(re,l);if(d)if(e&&!c){-1===r?(a[s]||(g&&_xeUtils.default.set(l,g,!0),a[s]=l),_xeUtils.default.set(l,d,!1)):_xeUtils.default.eachTree([l],e=>{(re.eqRow(e,l)||o||!v||v({row:e}))&&(_xeUtils.default.set(e,d,r),g&&_xeUtils.default.set(l,g,!1),delete a[(0,_util.getRowid)(re,e)],C(l,r))},{children:u});var f=_xeUtils.default.findTree(i,e=>re.eqRow(e,l),{children:u});if(f&&f.parent){let e;const h=[],m={};if(!o&&v?f.items.forEach(e=>{var t;v({row:e})&&(t=(0,_util.getRowid)(re,e),m[t]=e,h.push(e))}):f.items.forEach(e=>{var t=(0,_util.getRowid)(re,e);m[t]=e,h.push(e)}),_xeUtils.default.find(f.items,e=>!!a[(0,_util.getRowid)(re,e)]))e=-1;else{const p=[];f.items.forEach(e=>{_xeUtils.default.get(e,d)&&p.push(e)}),e=p.filter(e=>m[(0,_util.getRowid)(re,e)]).length===h.length||!(!p.length&&-1!==r)&&-1}return H.selectCheckboxMaps=n,X.handleSelectRow({row:f.parent},e,o)}}else!o&&v&&!v({row:l})||(_xeUtils.default.set(l,d,r),C(l,r));else if(e&&!c){-1===r?(a[s]||(g&&_xeUtils.default.set(l,g,!0),a[s]=l),n[s]&&delete n[s]):_xeUtils.default.eachTree([l],e=>{var t=(0,_util.getRowid)(re,e);(re.eqRow(e,l)||o||!v||v({row:e}))&&(r?n[t]=e:n[t]&&delete n[t],g&&_xeUtils.default.set(l,g,!1),delete a[(0,_util.getRowid)(re,e)],C(l,r))},{children:u});f=_xeUtils.default.findTree(i,e=>re.eqRow(e,l),{children:u});if(f&&f.parent){let e;const x=[],_={};if(!o&&v?f.items.forEach(e=>{var t;v({row:e})&&(t=(0,_util.getRowid)(re,e),_[t]=e,x.push(e))}):f.items.forEach(e=>{var t=(0,_util.getRowid)(re,e);_[t]=e,x.push(e)}),_xeUtils.default.find(f.items,e=>!!a[(0,_util.getRowid)(re,e)]))e=-1;else{const w=[];f.items.forEach(e=>{var t=(0,_util.getRowid)(re,e);n[t]&&w.push(e)}),e=w.filter(e=>_[(0,_util.getRowid)(re,e)]).length===x.length||!(!w.length&&-1!==r)&&-1}return H.selectCheckboxMaps=n,X.handleSelectRow({row:f.parent},e,o)}}else!o&&v&&!v({row:l})||(r?n[s]||(n[s]=l):n[s]&&delete n[s],C(l,r));H.selectCheckboxMaps=n,X.checkSelectionStatus()},triggerHeaderTitleEvent(t,e,l){e=e.content||e.message;if(e){var r=H["tooltipStore"],l=l["column"];const o=(0,_utils.getFuncText)(e);Ct(!0),r.row=null,r.column=l,r.visible=!0,(0,_vue.nextTick)(()=>{var e=$.value;e&&e.open(t.currentTarget,o)})}},triggerHeaderTooltipEvent(e,t){var l=H["tooltipStore"],r=t["column"],e=e.currentTarget;Ct(!0),l.column===r&&l.visible||Et(0,e,e,null,t)},triggerBodyTooltipEvent(l,r){var e=j["editConfig"],t=H["editStore"],o=H["tooltipStore"],a=Q.value,t=t["actived"],{row:n,column:i}=r,l=l.currentTarget;if(Ct(o.column!==i||o.row!==n),i.editRender&&(0,_utils.isEnableConf)(e)){if("row"===a.mode&&t.row===n)return;if(t.row===n&&t.column===i)return}if(o.column!==i||o.row!==n||!o.visible){let e,t;i.treeNode?(e=l.querySelector(".vxe-tree-cell"),"html"===i.type&&(t=l.querySelector(".vxe-cell--html"))):t=l.querySelector("html"===i.type?".vxe-cell--html":".vxe-cell--label"),Et(0,l,e||l.children[0],t,r)}},triggerFooterTooltipEvent(e,t){var l=t["column"],r=H["tooltipStore"],e=e.currentTarget;Ct(r.column!==l||!!r.row),r.column===l&&r.visible||Et(0,e,e.querySelector(".vxe-cell--item")||e.children[0],null,t)},handleTargetLeaveEvent(){var e=c.value;let t=$.value;t&&t.setActived(!1),e.enterable?K.tooltipTimeout=setTimeout(()=>{(t=$.value)&&!t.isActived()&&P.closeTooltip()},e.leaveDelay):P.closeTooltip()},triggerHeaderCellClickEvent(e,t){var l=K["_lastResizeTime"],r=w.value,o=Z.value,a=t["column"],n=e.currentTarget,l=l&&l>Date.now()-300,i=(0,_dom.getEventTargetNode)(e,n,"vxe-cell--sort").flag,u=(0,_dom.getEventTargetNode)(e,n,"vxe-cell--filter").flag;"cell"!==r.trigger||l||i||u||X.triggerSortEvent(e,a,ke(a)),P.dispatchEvent("header-cell-click",Object.assign({triggerResizable:l,triggerSort:i,triggerFilter:u,cell:n},t),e),(o.isCurrent||j.highlightCurrentColumn)&&P.setCurrentColumn(a)},triggerHeaderCellDblclickEvent(e,t){P.dispatchEvent("header-cell-dblclick",Object.assign({cell:e.currentTarget},t),e)},triggerCellClickEvent(e,t){var{highlightCurrentRow:l,editConfig:r}=j,o=H["editStore"],a=y.value,n=Q.value,i=le.value,u=R.value,s=T.value,d=te.value,c=J.value,{actived:o,focused:v}=o,{row:g,column:f}=t,{type:h,treeNode:m}=f,p="radio"===h,x="checkbox"===h,h="expand"===h,_=e.currentTarget,w=p&&(0,_dom.getEventTargetNode)(e,_,"vxe-cell--radio").flag,b=x&&(0,_dom.getEventTargetNode)(e,_,"vxe-cell--checkbox").flag,C=m&&(0,_dom.getEventTargetNode)(e,_,"vxe-tree--btn-wrapper").flag,E=h&&(0,_dom.getEventTargetNode)(e,_,"vxe-table--expanded").flag;t=Object.assign({cell:_,triggerRadio:w,triggerCheckbox:b,triggerTreeNode:C,triggerExpandNode:E},t),!b&&!w&&(!E&&("row"===a.trigger||h&&"cell"===a.trigger)&&X.triggerRowExpandEvent(e,t),"row"===i.trigger||m&&"cell"===i.trigger)&&X.triggerTreeExpandEvent(e,t),C||(E||(!c.isCurrent&&!l||b||w||X.triggerCurrentRowEvent(e,t),!w&&("row"===u.trigger||p&&"cell"===u.trigger)&&X.triggerRadioRowEvent(e,t),!b&&("row"===s.trigger||x&&"cell"===s.trigger)&&X.handleToggleCheckRowEvent(e,t)),(0,_utils.isEnableConf)(r)&&(d.arrowCursorLock&&e&&"cell"===n.mode&&e.target&&/^input|textarea$/i.test(e.target.tagName)&&(v.column=f,v.row=g),"manual"===n.trigger?o.args&&o.row===g&&f!==o.column&&Xe(e,t):o.args&&g===o.row&&f===o.column||("click"===n.trigger||"dblclick"===n.trigger&&"row"===n.mode&&o.row===g)&&Xe(e,t))),P.dispatchEvent("cell-click",t,e)},triggerCellDblclickEvent(e,t){var l=j["editConfig"],r=H["editStore"],o=Q.value,r=r["actived"],a=e.currentTarget;t=Object.assign({cell:a},t),!(0,_utils.isEnableConf)(l)||"dblclick"!==o.trigger||r.args&&e.currentTarget===r.args.cell||("row"===o.mode?Pe("blur").catch(e=>e).then(()=>{re.handleActived(t,e).then(()=>Pe("change")).catch(e=>e)}):"cell"===o.mode&&re.handleActived(t,e).then(()=>Pe("change")).catch(e=>e)),P.dispatchEvent("cell-dblclick",t,e)},handleToggleCheckRowEvent(e,t){var l=H["selectCheckboxMaps"],r=T.value["checkField"],o=t["row"];let a=!1;a=r?!_xeUtils.default.get(o,r):!l[(0,_util.getRowid)(re,o)],e?X.triggerCheckRowEvent(e,t,a):X.handleSelectRow(t,a)},triggerCheckRowEvent(e,t,l){var r=T.value,o=t["row"],a=K["afterFullData"],n=r["checkMethod"];if(r.isShiftKey&&e.shiftKey&&!j.treeConfig){r=P.getCheckboxRecords();if(r.length){var r=r[0],i=P.getVTRowIndex(o),r=P.getVTRowIndex(r);if(i!==r)return P.setAllCheckboxRow(!1),a=i<r?a.slice(i,r+1):a.slice(r,i+1),E(a,!0,!1),void P.dispatchEvent("checkbox-range-select",Object.assign({rangeRecords:a},t),e)}}n&&!n({row:o})||(X.handleSelectRow(t,l),P.dispatchEvent("checkbox-change",Object.assign({records:P.getCheckboxRecords(),reserves:P.getCheckboxReserveRecords(),indeterminates:P.getCheckboxIndeterminateRecords(),checked:l},t),e))},triggerCheckAllEvent(e,t){Be(t),e&&P.dispatchEvent("checkbox-all",{records:P.getCheckboxRecords(),reserves:P.getCheckboxReserveRecords(),indeterminates:P.getCheckboxIndeterminateRecords(),checked:t},e)},triggerRadioRowEvent(e,t){var l=H["selectRadioRow"],r=t["row"],o=R.value;let a=r,n=l!==a;n?We(a):o.strict||(n=l===a)&&(a=null,P.clearRadioRow()),n&&P.dispatchEvent("radio-change",Object.assign({oldValue:l,newValue:a},t),e)},triggerCurrentRowEvent(e,t){var l=H["currentRow"],r=t["row"],o=l!==r;P.setCurrentRow(r),o&&P.dispatchEvent("current-change",Object.assign({oldValue:l,newValue:r},t),e)},triggerRowExpandEvent(e,t){var{rowExpandLazyLoadedMaps:l,expandColumn:r}=H,t=t["row"],o=y.value["lazy"],a=(0,_util.getRowid)(re,t);o&&l[a]||(o=!P.isRowExpandByRow(t),l=P.getColumnIndex(r),a=P.getVMColumnIndex(r),P.setRowExpand(t,o),P.dispatchEvent("toggle-row-expand",{expanded:o,column:r,columnIndex:l,$columnIndex:a,row:t,rowIndex:P.getRowIndex(t),$rowIndex:P.getVMRowIndex(t)},e))},triggerTreeExpandEvent(e,t){var l=H["treeExpandLazyLoadedMaps"],{row:t,column:r}=t,o=le.value["lazy"],a=(0,_util.getRowid)(re,t);o&&l[a]||(o=!P.isTreeExpandByRow(t),l=P.getColumnIndex(r),a=P.getVMColumnIndex(r),P.setTreeExpand(t,o),P.dispatchEvent("toggle-tree-expand",{expanded:o,column:r,columnIndex:l,$columnIndex:a,row:t},e))},triggerSortEvent(e,t,l){var r=j["mouseConfig"],o=w.value,a=ee.value,{field:n,sortable:i}=t;i&&(l&&t.order!==l?P.sort({field:n,order:l}):P.clearSort(o.multiple?t:null),i={$table:re,$event:e,column:t,field:n,property:n,order:t.order,sortList:P.getSortColumns(),sortTime:t.sortTime},r&&a.area&&re.handleSortEvent&&re.handleSortEvent(e,i),P.dispatchEvent("sort-change",i,e))},triggerScrollXEvent(){ot()},triggerScrollYEvent(e){var t=K["scrollYStore"],{adaptive:t,offsetSize:l,visibleSize:r}=t;(isWebkit&&t&&2*l+r<=40?dt:ct)(e)},scrollToTreeRow(t){var e=j["treeConfig"],l=K["tableFullData"];const r=[];if(e){e=le.value,e=e.children||e.childrenField,l=_xeUtils.default.findTree(l,e=>re.eqRow(e,t),{children:e});if(l){const o=l.nodes;o.forEach((e,t)=>{t<o.length-1&&!P.isTreeExpandByRow(e)&&r.push(P.setTreeExpand(e,!0))})}}return Promise.all(r).then(()=>(0,_util.rowToVisible)(re,t))},updateScrollYStatus:ut,updateScrollXSpace(){const{isGroup:t,scrollXLoad:r,scrollbarWidth:o}=H,{visibleColumn:l,scrollXStore:a,elemStore:n,tableWidth:i}=K;var u=W.value,s=B.value,d=Y.value,s=s?s.$el:null;if(s){var u=u?u.$el:null,d=d?d.$el:null,u=u?u.querySelector(".vxe-table--header"):null,s=s.querySelector(".vxe-table--body"),d=d?d.querySelector(".vxe-table--footer"):null,c=l.slice(0,a.startIndex).reduce((e,t)=>e+t.renderWidth,0);let e="";r&&(e=c+"px"),u&&(u.style.marginLeft=t?"":e),s.style.marginLeft=e,d&&(d.style.marginLeft=e),["main"].forEach(l=>{["header","body","footer"].forEach(e=>{var t=n[l+`-${e}-xSpace`],t=t?t.value:null;t&&(t.style.width=r?i+("header"===e?o:0)+"px":"")})}),(0,_vue.nextTick)(b)}},updateScrollYSpace(){var e=H["scrollYLoad"];const{scrollYStore:t,elemStore:l,afterFullData:r}=K;var{startIndex:o,rowHeight:a}=t,n=r.length*a,o=Math.max(0,o*a);let i="",u="";e&&(i=o+"px",u=n+"px"),["main","left","right"].forEach(t=>{var e=l[t+"-body-table"],e=e?e.value:null;e&&(e.style.marginTop=i),["header","body","footer"].forEach(e=>{e=l[t+`-${e}-ySpace`],e=e?e.value:null;e&&(e.style.height=u)})}),(0,_vue.nextTick)(b)},updateScrollXData(){(0,_vue.nextTick)(()=>{rt(),X.updateScrollXSpace()})},updateScrollYData(){(0,_vue.nextTick)(()=>{X.handleTableData(),X.updateScrollYSpace()})},checkScrolling(){var e=ve.value,t=ge.value,l=B.value,l=l?l.$el:null;l&&(e&&(0<l.scrollLeft?(0,_dom.addClass):(0,_dom.removeClass))(e,"scrolling--middle"),t)&&(l.clientWidth<l.scrollWidth-Math.ceil(l.scrollLeft)?(0,_dom.addClass):(0,_dom.removeClass))(t,"scrolling--middle")},updateZindex(){j.zIndex?K.tZindex=j.zIndex:K.tZindex<(0,_utils.getLastZIndex)()&&(K.tZindex=(0,_utils.nextZIndex)())},handleCheckedCheckboxRow:E,triggerHoverEvent(e,{row:t}){X.setHoverRow(t)},setHoverRow(e){var t=(0,_util.getRowid)(re,e),l=q.value;X.clearHoverRow(),l&&_xeUtils.default.arrayEach(l.querySelectorAll(`[rowid="${t}"]`),e=>(0,_dom.addClass)(e,"row--hover")),K.hoverRow=e},clearHoverRow(){var e=q.value;e&&_xeUtils.default.arrayEach(e.querySelectorAll(".vxe-body--row.row--hover"),e=>(0,_dom.removeClass)(e,"row--hover")),K.hoverRow=null},getCell(e,t){var e=(0,_util.getRowid)(re,e),l=B.value,r=g.value,o=d.value;let a;return t&&(t.fixed&&("left"===t.fixed?r&&(a=r.$el):o&&(a=o.$el)),a=a||l.$el)?a.querySelector(`.vxe-body--row[rowid="${e}"] .`+t.id):null},getCellLabel(t,l){var r=l.formatter,o=(0,_util.getCellValue)(t,l);let a=o;if(r){let e;var n=K["fullAllDataRowIdData"],i=(0,_util.getRowid)(re,t),u=l.id,s=n[i];if(s&&(e=(e=s.formatData)||(n[i].formatData={}),s)&&e[u]&&e[u].value===o)return e[u].label;n={cellValue:o,row:t,rowIndex:P.getRowIndex(t),column:l,columnIndex:P.getColumnIndex(l)};a=_xeUtils.default.isString(r)?(i=_vXETable.VXETable.formats.get(r))&&i.cellFormatMethod?i.cellFormatMethod(n):"":_xeUtils.default.isArray(r)?(s=_vXETable.VXETable.formats.get(r[0]))&&s.cellFormatMethod?s.cellFormatMethod(n,...r.slice(1)):"":r(n),e&&(e[u]={value:o,label:a})}return a},findRowIndexOf(e,t){return t?_xeUtils.default.findIndexOf(e,e=>re.eqRow(e,t)):-1},eqRow(e,t){return!(!e||!t||e!==t&&(0,_util.getRowid)(re,e)!==(0,_util.getRowid)(re,t))}},"development"===process.env.NODE_ENV&&("openExport,openPrint,exportData,openImport,importData,saveFile,readFile,importByFile,print".split(",").forEach(e=>{re[e]=function(){(0,_log.errLog)("vxe.error.reqModule",["VxeTableExportModule"])}}),"clearValidate,fullValidate,validate".split(",").forEach(e=>{re[e]=function(){(0,_log.errLog)("vxe.error.reqModule",["VxeTableValidatorModule"])}})),Object.assign(re,P,X),e=>{var{showHeader:t,showFooter:l}=j,{tableData:r,tableColumn:o,tableGroupColumn:a,columnStore:n,footerTableData:i}=H,u="left"===e,n=u?n.leftList:n.rightList;return(0,_vue.h)("div",{ref:u?ve:ge,class:`vxe-table--fixed-${e}-wrapper`},[t?(0,_vue.h)(_header.default,{ref:u?s:p,fixedType:e,tableData:r,tableColumn:o,tableGroupColumn:a,fixedColumn:n}):(0,_vue.createCommentVNode)(),(0,_vue.h)(_body.default,{ref:u?g:d,fixedType:e,tableData:r,tableColumn:o,fixedColumn:n}),l?(0,_vue.h)(_footer.default,{ref:u?f:x,footerTableData:i,tableColumn:o,fixedColumn:n,fixedType:e}):(0,_vue.createCommentVNode)()])});function Tt(){var e=q.value;e&&e.clientWidth&&e.clientHeight&&P.recalculate()}const yt=(0,_vue.ref)(0),St=((0,_vue.watch)(()=>j.data?j.data.length:-1,()=>{yt.value++}),(0,_vue.watch)(()=>j.data,()=>{yt.value++}),(0,_vue.watch)(yt,()=>{const{inited:r,initStatus:o}=K;et(j.data||[]).then(()=>{var{scrollXLoad:e,scrollYLoad:t,expandColumn:l}=H;K.inited=!0,K.initStatus=!0,o||tt(),r||lt(),"development"===process.env.NODE_ENV&&(e||t)&&l&&(0,_log.warnLog)("vxe.error.scrollErrProp",["column.type=expand"]),P.recalculate()})}),(0,_vue.ref)(0)),Dt=((0,_vue.watch)(()=>H.staticColumns.length,()=>{St.value++}),(0,_vue.watch)(()=>H.staticColumns,()=>{St.value++}),(0,_vue.watch)(St,()=>{it(H.staticColumns)}),(0,_vue.ref)(0)),Mt=((0,_vue.watch)(()=>H.tableColumn.length,()=>{Dt.value++}),(0,_vue.watch)(()=>H.tableColumn,()=>{Dt.value++}),(0,_vue.watch)(Dt,()=>{X.analyColumnWidth()}),(0,_vue.watch)(()=>H.upDataFlag,()=>{(0,_vue.nextTick)(()=>{P.updateData()})}),(0,_vue.watch)(()=>H.reColumnFlag,()=>{(0,_vue.nextTick)(()=>{P.refreshColumn()})}),(0,_vue.watch)(()=>j.showHeader,()=>{(0,_vue.nextTick)(()=>{P.recalculate(!0).then(()=>P.refreshScroll())})}),(0,_vue.watch)(()=>j.showFooter,()=>{(0,_vue.nextTick)(()=>{P.recalculate(!0).then(()=>P.refreshScroll())})}),(0,_vue.ref)(0)),kt=((0,_vue.watch)(()=>j.footerData?j.footerData.length:-1,()=>{Mt.value++}),(0,_vue.watch)(()=>j.footerData,()=>{Mt.value++}),(0,_vue.watch)(Mt,()=>{P.updateFooter()}),(0,_vue.watch)(()=>j.height,()=>{(0,_vue.nextTick)(()=>P.recalculate(!0))}),(0,_vue.watch)(()=>j.maxHeight,()=>{(0,_vue.nextTick)(()=>P.recalculate(!0))}),(0,_vue.watch)(()=>j.syncResize,e=>{e&&(Tt(),(0,_vue.nextTick)(()=>{Tt(),setTimeout(()=>Tt())}))}),(0,_vue.ref)(0)),It=((0,_vue.watch)(()=>j.mergeCells?j.mergeCells.length:-1,()=>{kt.value++}),(0,_vue.watch)(()=>j.mergeCells,()=>{kt.value++}),(0,_vue.watch)(kt,()=>{P.clearMergeCells(),(0,_vue.nextTick)(()=>{j.mergeCells&&P.setMergeCells(j.mergeCells)})}),(0,_vue.ref)(0));(0,_vue.watch)(()=>j.mergeFooterItems?j.mergeFooterItems.length:-1,()=>{It.value++}),(0,_vue.watch)(()=>j.mergeFooterItems,()=>{It.value++}),(0,_vue.watch)(It,()=>{P.clearMergeFooterItems(),(0,_vue.nextTick)(()=>{j.mergeFooterItems&&P.setMergeFooterItems(j.mergeFooterItems)})}),_vXETable.VXETable.hooks.forEach(e=>{var e=e["setupTable"];e&&(e=e(re))&&_xeUtils.default.isObject(e)&&Object.assign(re,e)}),X.preventEvent(null,"created",{$table:re});let Lt;(0,_vue.onActivated)(()=>{P.recalculate().then(()=>P.refreshScroll()),X.preventEvent(null,"activated",{$table:re})}),(0,_vue.onDeactivated)(()=>{K.isActivated=!1,X.preventEvent(null,"deactivated",{$table:re})}),(0,_vue.onMounted)(()=>{(0,_vue.nextTick)(()=>{const{data:e,treeConfig:t,showOverflow:l}=j;var{scrollXStore:r,scrollYStore:o}=K,a=_.value,n=Q.value,i=le.value,u=R.value,s=T.value,d=y.value;const c=J.value;if("development"===process.env.NODE_ENV&&(j.rowId&&(0,_log.warnLog)("vxe.error.delProp",["row-id","row-config.keyField"]),j.rowKey&&(0,_log.warnLog)("vxe.error.delProp",["row-key","row-config.useKey"]),j.columnKey&&(0,_log.warnLog)("vxe.error.delProp",["column-id","column-config.useKey"]),j.rowId||c.keyField||!(s.reserve||s.checkRowKeys||u.reserve||u.checkRowKey||d.expandRowKeys||i.expandRowKeys)||(0,_log.warnLog)("vxe.error.reqProp",["row-config.keyField"]),j.editConfig&&(n.showStatus||n.showUpdateStatus||n.showInsertStatus)&&!j.keepSource&&(0,_log.warnLog)("vxe.error.reqProp",["keep-source"]),!t||!i.showLine&&!i.line||(j.rowKey||c.useKey)&&l||(0,_log.warnLog)("vxe.error.reqProp",["row-config.useKey | show-overflow"]),t&&j.stripe&&(0,_log.warnLog)("vxe.error.noTree",["stripe"]),!j.showFooter||j.footerMethod||j.footerData||(0,_log.warnLog)("vxe.error.reqProp",["footer-data | footer-method"]),{exportConfig:u,importConfig:d}=j,g=U.value,v=O.value,d&&v.types&&!v.importMethod&&!_xeUtils.default.includeArrays(_vXETable.VXETable.globalConfs.importTypes,v.types)&&(0,_log.warnLog)("vxe.error.errProp",["export-config.types="+v.types.join(","),v.types.filter(e=>_xeUtils.default.includes(_vXETable.VXETable.globalConfs.importTypes,e)).join(",")||_vXETable.VXETable.globalConfs.importTypes.join(",")]),u)&&g.types&&!g.exportMethod&&!_xeUtils.default.includeArrays(_vXETable.VXETable.globalConfs.exportTypes,g.types)&&(0,_log.warnLog)("vxe.error.errProp",["export-config.types="+g.types.join(","),g.types.filter(e=>_xeUtils.default.includes(_vXETable.VXETable.globalConfs.exportTypes,e)).join(",")||_vXETable.VXETable.globalConfs.exportTypes.join(",")]),"development"===process.env.NODE_ENV){var d=m.value,v=ee.value;const c=J.value;if(!j.id&&j.customConfig&&(!0===d.storage||d.storage&&d.storage.resizable||d.storage&&d.storage.visible)&&(0,_log.errLog)("vxe.error.reqProp",["id"]),j.treeConfig&&s.range&&(0,_log.errLog)("vxe.error.noTree",["checkbox-config.range"]),c.height&&!j.showOverflow&&(0,_log.warnLog)("vxe.error.notProp",["table.show-overflow"]),!re.handleUpdateCellAreas&&(j.clipConfig&&(0,_log.warnLog)("vxe.error.notProp",["clip-config"]),j.fnrConfig&&(0,_log.warnLog)("vxe.error.notProp",["fnr-config"]),v.area))return void(0,_log.errLog)("vxe.error.notProp",["mouse-config.area"]);j.treeConfig&&i.children&&(0,_log.warnLog)("vxe.error.delProp",["tree-config.children","tree-config.childrenField"]),j.treeConfig&&i.line&&(0,_log.warnLog)("vxe.error.delProp",["tree-config.line","tree-config.showLine"]),v.area&&v.selected&&(0,_log.warnLog)("vxe.error.errConflicts",["mouse-config.area","mouse-config.selected"]),v.area&&s.range&&(0,_log.warnLog)("vxe.error.errConflicts",["mouse-config.area","checkbox-config.range"]),j.treeConfig&&v.area&&(0,_log.errLog)("vxe.error.noTree",["mouse-config.area"]),j.editConfig&&n.activeMethod&&(0,_log.warnLog)("vxe.error.delProp",["edit-config.activeMethod","edit-config.beforeEditMethod"]),j.treeConfig&&s.isShiftKey&&(0,_log.errLog)("vxe.error.errConflicts",["tree-config","checkbox-config.isShiftKey"]),s.halfField&&(0,_log.warnLog)("vxe.error.delProp",["checkbox-config.halfField","checkbox-config.indeterminateField"])}if("development"===process.env.NODE_ENV&&(j.editConfig&&!re.insert&&(0,_log.errLog)("vxe.error.reqModule",["Edit"]),j.editRules&&!re.validate&&(0,_log.errLog)("vxe.error.reqModule",["Validator"]),(s.range||j.keyboardConfig||j.mouseConfig)&&!re.triggerCellMousedownEvent&&(0,_log.errLog)("vxe.error.reqModule",["Keyboard"]),j.printConfig||j.importConfig||j.exportConfig)&&!re.exportData&&(0,_log.errLog)("vxe.error.reqModule",["Export"]),Object.assign(o,{startIndex:0,endIndex:0,visibleSize:0,adaptive:!1!==a.adaptive}),Object.assign(r,{startIndex:0,endIndex:0,visibleSize:0}),et(e||[]).then(()=>{e&&e.length&&(K.inited=!0,K.initStatus=!0,tt(),lt()),b()}),j.autoResize){var u=D.value["refreshDelay"],g=q.value,d=X.getParentElem();const f=u?_xeUtils.default.throttle(()=>P.recalculate(!0),u,{leading:!0,trailing:!0}):null;Lt=(0,_resize.createResizeEvent)(f?()=>{j.autoResize&&requestAnimationFrame(f)}:()=>{j.autoResize&&P.recalculate(!0)}),g&&Lt.observe(g),d&&Lt.observe(d)}}),_event.GlobalEvent.on(re,"paste",xt),_event.GlobalEvent.on(re,"copy",_t),_event.GlobalEvent.on(re,"cut",wt),_event.GlobalEvent.on(re,"mousedown",gt),_event.GlobalEvent.on(re,"blur",ft),_event.GlobalEvent.on(re,"mousewheel",ht),_event.GlobalEvent.on(re,"keydown",pt),_event.GlobalEvent.on(re,"resize",bt),re.handleGlobalContextmenuEvent&&_event.GlobalEvent.on(re,"contextmenu",re.handleGlobalContextmenuEvent),X.preventEvent(null,"mounted",{$table:re})}),(0,_vue.onBeforeUnmount)(()=>{Lt&&Lt.disconnect(),P.closeFilter(),re.closeMenu&&re.closeMenu(),X.preventEvent(null,"beforeUnmount",{$table:re})}),(0,_vue.onUnmounted)(()=>{_event.GlobalEvent.off(re,"paste"),_event.GlobalEvent.off(re,"copy"),_event.GlobalEvent.off(re,"cut"),_event.GlobalEvent.off(re,"mousedown"),_event.GlobalEvent.off(re,"blur"),_event.GlobalEvent.off(re,"mousewheel"),_event.GlobalEvent.off(re,"keydown"),_event.GlobalEvent.off(re,"resize"),_event.GlobalEvent.off(re,"contextmenu"),X.preventEvent(null,"unmounted",{$table:re})});return re.renderVN=()=>{var{loading:e,stripe:t,showHeader:l,height:r,treeConfig:o,mouseConfig:a,showFooter:n,highlightCell:i,highlightHoverRow:u,highlightHoverColumn:s,editConfig:d,editRules:c}=j,{isGroup:v,overflowX:g,overflowY:f,scrollXLoad:h,scrollYLoad:m,scrollbarHeight:p,tableData:x,tableColumn:_,tableGroupColumn:w,footerTableData:b,initStore:C,columnStore:E,filterStore:R,customStore:T}=H,{leftList:E,rightList:y}=E;const S=z.loading;var D=pe.value,M=me.value,k=le.value,I=J.value,N=Z.value,L=ne.value,F=Te.value,U=ee.value,A=xe.value,O=Ee.value,V=we.value;return(0,_vue.h)("div",{ref:q,class:["vxe-table","vxe-table--render-default","tid_"+ae,"border--"+F,{["size--"+L]:L,["valid-msg--"+M.msgMode]:!!c,"vxe-editable":!!d,"old-cell-valid":c&&"obsolete"===_conf.default.cellVaildMode,"cell--highlight":i,"cell--selected":a&&U.selected,"cell--area":a&&U.area,"row--highlight":I.isHover||u,"column--highlight":N.isHover||s,"is--header":l,"is--footer":n,"is--group":v,"is--tree-line":o&&(k.showLine||k.line),"is--fixed-left":E.length,"is--fixed-right":y.length,"is--animat":!!j.animat,"is--round":j.round,"is--stripe":!o&&t,"is--loading":e,"is--empty":!e&&!x.length,"is--scroll-y":f,"is--scroll-x":g,"is--virtual-x":h,"is--virtual-y":m}],onKeydown:mt},[(0,_vue.h)("div",{class:"vxe-table-slots"},z.default?z.default({}):[]),(0,_vue.h)("div",{class:"vxe-table--render-wrapper"},[(0,_vue.h)("div",{class:"vxe-table--main-wrapper"},[l?(0,_vue.h)(_header.default,{ref:W,tableData:x,tableColumn:_,tableGroupColumn:w}):(0,_vue.createCommentVNode)(),(0,_vue.h)(_body.default,{ref:B,tableData:x,tableColumn:_}),n?(0,_vue.h)(_footer.default,{ref:Y,footerTableData:b,tableColumn:_}):(0,_vue.createCommentVNode)()]),(0,_vue.h)("div",{class:"vxe-table--fixed-wrapper"},[E&&E.length&&g?Rt("left"):(0,_vue.createCommentVNode)(),y&&y.length&&g?Rt("right"):(0,_vue.createCommentVNode)()])]),(0,_vue.h)("div",{ref:he,class:"vxe-table--empty-placeholder"},[(0,_vue.h)("div",{class:"vxe-table--empty-content"},(F=Ce.value,L={$table:re},z.empty?z.empty(L):(d=(d=F.name?_vXETable.VXETable.renderer.get(F.name):null)?d.renderTableEmptyView||d.renderEmpty:null)?(0,_vn.getSlotVNs)(d(F,L)):(0,_utils.getFuncText)(j.emptyText)||_conf.default.i18n("vxe.table.emptyText")))]),(0,_vue.h)("div",{class:"vxe-table--border-line"}),(0,_vue.h)("div",{ref:fe,class:"vxe-table--resizable-bar",style:g?{"padding-bottom":p+"px"}:null}),(0,_vue.h)(_index.default,{class:"vxe-table--loading",modelValue:e,icon:O.icon,text:O.text},S?{default:()=>S({$table:re,$grid:G})}:{}),C.custom?(0,_vue.h)((0,_vue.resolveComponent)("vxe-table-custom-panel"),{ref:ce,customStore:T}):(0,_vue.createCommentVNode)(),C.filter?(0,_vue.h)((0,_vue.resolveComponent)("vxe-table-filter-panel"),{ref:de,filterStore:R}):(0,_vue.createCommentVNode)(),C.import&&j.importConfig?(0,_vue.h)((0,_vue.resolveComponent)("vxe-table-import-panel"),{defaultOptions:H.importParams,storeData:H.importStore}):(0,_vue.createCommentVNode)(),C.export&&(j.exportConfig||j.printConfig)?(0,_vue.h)((0,_vue.resolveComponent)("vxe-table-export-panel"),{defaultOptions:H.exportParams,storeData:H.exportStore}):(0,_vue.createCommentVNode)(),V?(0,_vue.h)((0,_vue.resolveComponent)("vxe-table-menu-panel"),{ref:se}):(0,_vue.createCommentVNode)(),oe?(0,_vue.h)((0,_vue.resolveComponent)("vxe-tooltip"),{ref:ie,isArrow:!1,enterable:!1}):(0,_vue.createCommentVNode)(),oe?(0,_vue.h)((0,_vue.resolveComponent)("vxe-tooltip"),Object.assign({ref:$},D)):(0,_vue.createCommentVNode)(),oe&&j.editRules&&M.showMessage&&("default"===M.message?!r:"tooltip"===M.message)?(0,_vue.h)((0,_vue.resolveComponent)("vxe-tooltip"),Object.assign({ref:ue,class:[{"old-cell-valid":c&&"obsolete"===_conf.default.cellVaildMode},"vxe-table--valid-error"]},"tooltip"===M.message||1===x.length?A:{})):(0,_vue.createCommentVNode)()])},(0,_vue.provide)("xecolgroup",null),(0,_vue.provide)("$xetable",re),re},render(){return this.renderVN()}});