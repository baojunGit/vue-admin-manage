"use strict";var _vue=require("vue"),_xeUtils=_interopRequireDefault(require("xe-utils")),_ui=require("../../ui"),_vn=require("../../ui/src/vn"),_log=require("../../ui/src/log");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const componentDefaultModelProp="modelValue",defaultCompProps={transfer:!0};function getOldComponentName(e){return"vxe-"+e.replace("$","")}function getDefaultComponent({name:e}){return(0,_vue.resolveComponent)(e)}function getOldComponent({name:e}){return(0,_vue.resolveComponent)(getOldComponentName(e))}function getNativeAttrs(e){let{name:t,attrs:n}=e;return n="input"===t?Object.assign({type:"text"},n):n}function getComponentFormItemProps(e,t,n,o){return _xeUtils.default.assign({},defaultCompProps,o,e.props,{[componentDefaultModelProp]:n})}function getElementOns(e,n,t,o){const r=e["events"],s=(0,_vn.getModelEvent)(e.name),a=(0,_vn.getChangeEvent)(e.name),u=a===s,i={};return r&&_xeUtils.default.objectEach(r,(t,e)=>{i[(0,_vn.getOnName)(e)]=function(...e){t(n,...e)}}),t&&(i[(0,_vn.getOnName)(s)]=function(e){t(e),u&&o&&o(e),r&&r[s]&&r[s](n,e)}),!u&&o&&(i[(0,_vn.getOnName)(a)]=function(...e){o(...e),r&&r[a]&&r[a](n,...e)}),i}function getComponentOns(e,n,t,o){const r=e["events"],s=(0,_vn.getModelEvent)(e.name),a=(0,_vn.getChangeEvent)(e.name),u={};return _xeUtils.default.objectEach(r,(t,e)=>{u[(0,_vn.getOnName)(e)]=function(...e){"development"!==process.env.NODE_ENV||_xeUtils.default.isFunction(t)||(0,_log.errLog)("vxe.error.errFunc",[t]),t(n,...e)}}),t&&(u[(0,_vn.getOnName)(s)]=function(e){t(e),r&&r[s]&&r[s](n,e)}),o&&(u[(0,_vn.getOnName)(a)]=function(...e){o(...e),r&&r[a]&&r[a](n,...e)}),u}function getItemOns(e,t){const{$form:n,data:o,field:r}=t;return getComponentOns(e,t,e=>{_xeUtils.default.set(o,r,e)},()=>{n.updateStatus(t)})}function getNativeItemOns(e,t){const{$form:n,data:o,field:r}=t;return getElementOns(e,t,e=>{e=e.target.value;_xeUtils.default.set(o,r,e)},()=>{n.updateStatus(t)})}function renderNativeOptgroup(n,o,r){var{optionGroups:e,optionGroupProps:t={}}=n;const s=t.options||"options",a=t.label||"label";return e.map((e,t)=>(0,_vue.h)("optgroup",{key:t,label:e[a]},r(e[s],n,o)))}function nativeItemRender(e,t){var{data:n,field:o}=t,r=e["name"],s=getNativeAttrs(e),n=_xeUtils.default.get(n,o);return[(0,_vue.h)(r,Object.assign(Object.assign(Object.assign({class:"vxe-default-"+r},s),{value:!s||"input"!==r||"submit"!==s.type&&"reset"!==s.type?n:null}),getNativeItemOns(e,t)))]}function defaultItemRender(e,t){var{data:n,field:o}=t,n=_xeUtils.default.get(n,o);return[(0,_vue.h)(getDefaultComponent(e),Object.assign(Object.assign({},getComponentFormItemProps(e,t,n)),getItemOns(e,t)))]}function oldItemRender(e,t){var{data:n,field:o}=t,n=_xeUtils.default.get(n,o);return[(0,_vue.h)(getOldComponent(e),Object.assign(Object.assign({},getComponentFormItemProps(e,t,n)),getItemOns(e,t)))]}function oldButtonItemRender(e,t){return[(0,_vue.h)((0,_vue.resolveComponent)("vxe-button"),Object.assign(Object.assign({},getComponentFormItemProps(e,t,null)),getComponentOns(e,t)))]}function oldButtonsItemRender(e,t){return e.children.map(e=>oldButtonItemRender(e,t)[0])}function renderNativeFormOptions(e,t,n){var{data:n,field:o}=n,{optionProps:t={}}=t;const r=t.label||"label",s=t.value||"value",a=t.disabled||"disabled",u=_xeUtils.default.get(n,o);return e.map((e,t)=>(0,_vue.h)("option",{key:t,value:e[s],disabled:e[a],selected:e[s]==u},e[r]))}function defaultFormItemRender(e,t){var{data:n,field:o}=t,n=_xeUtils.default.get(n,o);return[(0,_vue.h)(getDefaultComponent(e),Object.assign(Object.assign({},getComponentFormItemProps(e,t,n)),getItemOns(e,t)))]}function formItemRadioAndCheckboxRender(e,t){var{options:n,optionProps:o}=e,{data:r,field:s}=t,r=_xeUtils.default.get(r,s);return[(0,_vue.h)(getDefaultComponent(e),Object.assign(Object.assign({options:n,optionProps:o},getComponentFormItemProps(e,t,r)),getItemOns(e,t)))]}function oldFormItemRadioAndCheckboxRender(e,t){const{name:n,options:o,optionProps:r={}}=e;var{data:s,field:a}=t;const u=r.label||"label",i=r.value||"value",d=r.disabled||"disabled";s=_xeUtils.default.get(s,a);const m=getOldComponentName(n);return o?[(0,_vue.h)((0,_vue.resolveComponent)(m+"-group"),Object.assign(Object.assign({},getComponentFormItemProps(e,t,s)),getItemOns(e,t)),{default:()=>o.map((e,t)=>(0,_vue.h)((0,_vue.resolveComponent)(m),{key:t,label:e[i],content:e[u],disabled:e[d]}))})]:[(0,_vue.h)((0,_vue.resolveComponent)(m),Object.assign(Object.assign({},getComponentFormItemProps(e,t,s)),getItemOns(e,t)))]}_ui.renderer.mixin({input:{renderItemContent:nativeItemRender},textarea:{renderItemContent:nativeItemRender},select:{renderItemContent(e,t){return[(0,_vue.h)("select",Object.assign(Object.assign({class:"vxe-default-select"},getNativeAttrs(e)),getNativeItemOns(e,t)),e.optionGroups?renderNativeOptgroup(e,t,renderNativeFormOptions):renderNativeFormOptions(e.options,e,t))]}},VxeInput:{renderItemContent:defaultItemRender},VxeNumberInput:{renderItemContent:defaultItemRender},VxePasswordInput:{renderItemContent:defaultItemRender},VxeTextarea:{renderItemContent:defaultItemRender},VxeDatePicker:{renderItemContent:defaultItemRender},VxeButton:{renderItemContent:defaultFormItemRender},VxeButtonGroup:{renderItemContent(e,t){var n=e["options"],{data:o,field:r}=t,o=_xeUtils.default.get(o,r);return[(0,_vue.h)(getDefaultComponent(e),Object.assign(Object.assign({options:n},getComponentFormItemProps(e,t,o)),getItemOns(e,t)))]}},VxeSelect:{renderItemContent(e,t){var{data:n,field:o}=t,{options:r,optionProps:s,optionGroups:a,optionGroupProps:u}=e,n=_xeUtils.default.get(n,o);return[(0,_vue.h)(getDefaultComponent(e),Object.assign(Object.assign({},getComponentFormItemProps(e,t,n,{options:r,optionProps:s,optionGroups:a,optionGroupProps:u})),getItemOns(e,t)))]}},VxeTreeSelect:{renderItemContent(e,t){var{data:n,field:o}=t,{options:r,optionProps:s}=e,n=_xeUtils.default.get(n,o);return[(0,_vue.h)(getDefaultComponent(e),Object.assign(Object.assign({},getComponentFormItemProps(e,t,n,{options:r,optionProps:s})),getItemOns(e,t)))]}},VxeIconPicker:{renderItemContent:defaultFormItemRender},VxeRadio:{renderItemContent:defaultFormItemRender},VxeRadioGroup:{renderItemContent:formItemRadioAndCheckboxRender},VxeCheckbox:{renderItemContent:defaultFormItemRender},VxeCheckboxGroup:{renderItemContent:formItemRadioAndCheckboxRender},VxeSwitch:{renderItemContent:defaultItemRender},VxeImage:{renderItemContent(e,t){var{data:n,field:o}=t,r=e["props"],n=_xeUtils.default.get(n,o);return[(0,_vue.h)(getDefaultComponent(e),Object.assign(Object.assign(Object.assign({},r),{src:n}),getItemOns(e,t)))]}},VxeImageGroup:{renderItemContent(e,t){var{data:n,field:o}=t,r=e["props"],n=_xeUtils.default.get(n,o);return[(0,_vue.h)(getDefaultComponent(e),Object.assign(Object.assign(Object.assign({},r),{urlList:n}),getItemOns(e,t)))]}},VxeUpload:{renderItemContent:defaultItemRender},$input:{renderItemContent:oldItemRender},$textarea:{renderItemContent:oldItemRender},$button:{renderItemContent:oldButtonItemRender},$buttons:{renderItemContent:oldButtonsItemRender},$select:{renderItemContent(e,t){var{data:n,field:o}=t,{options:r,optionProps:s,optionGroups:a,optionGroupProps:u}=e,n=_xeUtils.default.get(n,o);return[(0,_vue.h)(getOldComponent(e),Object.assign(Object.assign({},getComponentFormItemProps(e,t,n,{options:r,optionProps:s,optionGroups:a,optionGroupProps:u})),getItemOns(e,t)))]}},$radio:{renderItemContent:oldFormItemRadioAndCheckboxRender},$checkbox:{renderItemContent:oldFormItemRadioAndCheckboxRender},$switch:{renderItemContent:oldItemRender}});