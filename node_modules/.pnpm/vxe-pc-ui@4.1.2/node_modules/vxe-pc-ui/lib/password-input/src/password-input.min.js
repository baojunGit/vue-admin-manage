"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _vue=require("vue"),_xeUtils=_interopRequireDefault(require("xe-utils")),_ui=require("../../ui"),_utils=require("../../ui/src/utils"),_vn=require("../..//ui/src/vn");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default=exports.default=(0,_vue.defineComponent)({name:"VxePasswordInput",props:{modelValue:String,name:String,clearable:{type:Boolean,default:()=>(0,_ui.getConfig)().passwordInput.clearable},readonly:Boolean,disabled:Boolean,maxLength:[String,Number],placeholder:String,autoComplete:{type:String,default:"off"},className:String,size:{type:String,default:()=>(0,_ui.getConfig)().passwordInput.size||(0,_ui.getConfig)().size},prefixIcon:String,suffixIcon:String,autocomplete:String},emits:["update:modelValue","input","change","click","focus","blur","clear","toggle-visible","prefix-click","suffix-click"],setup(g,e){const{emit:a,slots:m}=e,l=(0,_vue.inject)("$xeForm",null),s=(0,_vue.inject)("xeFormItemInfo",null);var t=_xeUtils.default.uniqueId();const h=(0,_ui.useSize)(g)["computeSize"],x=(0,_vue.reactive)({showPwd:!1,isActivated:!1,inputValue:g.modelValue}),w=(0,_vue.ref)(),V=(0,_vue.ref)(),u={refElem:w,refInput:V},i={xID:t,props:g,context:e,reactData:x,getRefMaps:()=>u};let r={};const I=(0,_vue.computed)(()=>g.clearable),b=(0,_vue.computed)(()=>{var e=g["readonly"];return e}),C=(0,_vue.computed)(()=>{var e=g["placeholder"];return(e=e||(0,_ui.getConfig)().passwordInput.placeholder)?(0,_utils.getFuncText)(e):(0,_ui.getI18n)("vxe.base.pleaseInput")}),S=(0,_vue.computed)(()=>{var e=x["showPwd"];return e?"text":"password"}),n=e=>{var t=x["inputValue"];r.dispatchEvent(e.type,{value:t},e)},o=(e,t)=>{x.inputValue=e,r.dispatchEvent("input",{value:e},t)},E=e=>{var t=e.target.value;o(t,e)},N=e=>{n(e);var t=x["inputValue"];l&&s&&l.triggerItemEvent(e,s.itemConfig.field,t)},P=e=>{x.isActivated=!0,n(e)},k=e=>{var t=x["inputValue"];r.dispatchEvent("blur",{value:t},e)},c=e=>{var{readonly:t,disabled:u}=g,i=x["showPwd"];u||t||(x.showPwd=!i),r.dispatchEvent("toggle-visible",{visible:x.showPwd},e)},y=e=>{n(e)},q=(e,t)=>{var u,i;focus(),u="",i=e,x.inputValue=u,a("update:modelValue",u),r.dispatchEvent("input",{value:u},i),_xeUtils.default.toValueString(g.modelValue)!==u&&(r.dispatchEvent("change",{value:u},i),l)&&s&&l.triggerItemEvent(i,s.itemConfig.field,u),r.dispatchEvent("clear",{value:t},e)},A=e=>{var t=g["disabled"];t||(t=x["inputValue"],r.dispatchEvent("suffix-click",{value:t},e))},D=e=>{var t=g["disabled"];t||(t=x["inputValue"],r.dispatchEvent("prefix-click",{value:t},e))},U=()=>{return e=x.showPwd,(0,_vue.h)("div",{class:"password-input--control-icon",onClick:c},[(0,_vue.h)("i",{class:["password-input--password-icon",e?(0,_ui.getIcon)().PASSWORD_INPUT_SHOW_PWD:(0,_ui.getIcon)().PASSWORD_INPUT_HIDE_PWD]})]);var e};r={dispatchEvent(e,t,u){a(e,(0,_ui.createEvent)(u,{$passwordInput:i},t))},focus(){var e=V.value;return x.isActivated=!0,e.focus(),(0,_vue.nextTick)()},blur(){return V.value.blur(),(x.isActivated=!1,_vue.nextTick)()},select(){return V.value.select(),(x.isActivated=!1,_vue.nextTick)()}},Object.assign(i,r),(0,_vue.watch)(()=>g.modelValue,e=>{x.inputValue=e});return i.renderVN=()=>{var{className:e,name:t,disabled:u,readonly:i,autocomplete:a,autoComplete:l,maxLength:s}=g,{inputValue:r,isActivated:n}=x,o=h.value,c=b.value,d=S.value,v=C.value,p=I.value,_=(f=g.prefixIcon,(_=m.prefix)||f?(0,_vue.h)("div",{class:"password-input--prefix",onClick:D},[(0,_vue.h)("div",{class:"password-input--prefix-icon"},_?(0,_vn.getSlotVNs)(_({})):[(0,_vue.h)("i",{class:f})])]):null),f=(()=>{var{disabled:e,suffixIcon:t}=g,u=x["inputValue"],i=m.suffix,a=I.value;return a||i||t?(0,_vue.h)("div",{class:["password-input--suffix",{"is--clear":a&&!e&&!(""===u||_xeUtils.default.eqNull(u))}]},[a?(0,_vue.h)("div",{class:"password-input--clear-icon",onClick:q},[(0,_vue.h)("i",{class:(0,_ui.getIcon)().INPUT_CLEAR})]):(0,_vue.createCommentVNode)(),U(),i||t?(0,_vue.h)("div",{class:"password-input--suffix-icon",onClick:A},i?(0,_vn.getSlotVNs)(i({})):[(0,_vue.h)("i",{class:t})]):(0,_vue.createCommentVNode)()]):null})();return(0,_vue.h)("div",{ref:w,class:["password-input",e,{["size--"+o]:o,"is--prefix":!!_,"is--suffix":!!f,"is--readonly":i,"is--disabled":u,"is--active":n,"show--clear":p&&!u&&!(""===r||_xeUtils.default.eqNull(r))}],spellcheck:!1},[_||(0,_vue.createCommentVNode)(),(0,_vue.h)("div",{class:"password-input--wrapper"},[(0,_vue.h)("input",{ref:V,class:"password-input--inner",value:r,name:t,type:d,placeholder:v,readonly:c,disabled:u,autocomplete:a||l,maxlength:s,onClick:y,onInput:E,onChange:N,onFocus:P,onBlur:k})]),f||(0,_vue.createCommentVNode)()])},i},render(){return this.renderVN()}});