"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WidgetRowViewComponent=exports.WidgetRowEditComponent=void 0;var _vue=require("vue"),_util=require("../src/util"),_core=require("@vxe-ui/core"),_vn=require("../../ui/src/vn"),_xeUtils=_interopRequireDefault(require("xe-utils")),_formGather=_interopRequireDefault(require("../../form/src/form-gather")),_formItem=_interopRequireDefault(require("../../form/src/form-item")),_row=_interopRequireDefault(require("../../row/src/row")),_col=_interopRequireDefault(require("../../row/src/col")),_button=_interopRequireDefault(require("../../button/src/button"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const ViewColItemComponent=(0,_vue.defineComponent)({props:{parentWidget:{type:Object,default:()=>({})},widget:{type:Object,default:()=>({})},span:Number,colItemIndex:{type:Number,default:0}},emits:[],setup(a){const s=(0,_vue.inject)("$xeFormDesign",null);if(!s)return()=>[];const l=s["reactData"],m=e=>{var{parentWidget:t,colItemIndex:r}=a;const{widgetObjList:i,sortWidget:o}=l;var n,d,u=t.children[r];e.stopPropagation(),o&&t&&o.id!==t.id&&((0,_util.hasFormDesignLayoutType)(o)||u&&u.name||(0,_util.hasFormDesignLayoutType)(u)||(u=_xeUtils.default.findTree(i,e=>e.id===o.id,{children:"children"}))&&({item:u,index:n,items:d}=u,t.children.length||(t.children=_xeUtils.default.range(0,t.options.colSize).map(()=>s.createEmptyWidget())),t.children[r]=u,d.splice(n,1),s.dispatchEvent("drag-widget",{widget:u},e)))};return()=>{const{widget:o,span:e}=a,{dragWidget:n,activeWidget:d,sortWidget:u}=l;return(0,_vue.h)(_formItem.default,{span:e,padding:!1},{default(){var e=o?o.name:"",t=_core.renderer.get(e)||{},t=t.renderFormDesignWidgetEdit||t.renderFormDesignWidgetView,e=o||{name:e},r={widget:o,readonly:!1,disabled:!1,isEditMode:!0,isViewMode:!1,$formDesign:s,$formView:null},i=d&&o&&d.id===o.id;return(0,_vue.h)("div",{class:["vxe-form-design--widget-row-view",{"is--active":i,"is--sort":u&&o&&u.id===o.id,"is--drag":n&&o&&n.id===o.id}],"data-widget-id":o.id,onDragover:m,onClick(e){o&&s.handleClickWidget(e,o)}},[t?(0,_vue.h)("div",{class:"vxe-form-design--widget-row-view-item-wrapper"},[(0,_vue.h)("div",{class:"vxe-form-design--widget-row-view-item-box vxe-form--item-row"},(0,_vn.getSlotVNs)(t(e,r))),i?(0,_vue.h)("div",{class:"vxe-form-design--preview-item-operate"},[(0,_vue.h)(_button.default,{icon:(0,_core.getIcon)().FORM_DESIGN_WIDGET_COPY,status:"primary",size:"mini",circle:!0,onClick(e){s.handleCopyWidget(e.$event,o)}}),(0,_vue.h)(_button.default,{icon:(0,_core.getIcon)().FORM_DESIGN_WIDGET_DELETE,status:"danger",size:"mini",circle:!0,onClick(e){s.handleRemoveWidget(e.$event,o)}})]):(0,_vue.createCommentVNode)()]):(0,_vue.h)("div",{class:"vxe-form-design--widget-row-view-empty"},"控件位置")])}})}}}),WidgetRowEditComponent=exports.WidgetRowEditComponent=(0,_vue.defineComponent)({props:{renderOpts:{type:Object,default:()=>({})},renderParams:{type:Object,default:()=>({})}},emits:[],setup(t){const i=(0,_vue.computed)(()=>{var e=t["renderParams"],e=e["widget"],e=e["options"],e=e["colSpan"];return(e?(""+e).split(","):[]).map(e=>Number(e))});return()=>{var e=t["renderParams"];const r=e["widget"];return(0,_vue.h)(_formGather.default,{},{default(){return i.value.map((e,t)=>(0,_vue.h)(ViewColItemComponent,{key:t,parentWidget:r,widget:r.children[t],span:e,colItemIndex:t}))}})}}}),WidgetRowViewComponent=exports.WidgetRowViewComponent=(0,_vue.defineComponent)({props:{renderOpts:{type:Object,default:()=>({})},renderParams:{type:Object,default:()=>({})}},emits:[],setup(r){const d=(0,_vue.inject)("$xeFormDesign",null),u=(0,_vue.inject)("$xeFormView",null),i=(0,_vue.computed)(()=>{var e=r["renderParams"],e=e["widget"],e=e["options"],e=e["colSpan"];return(e?(""+e).split(","):[]).map(e=>Number(e))});return()=>{var e=r["renderParams"];const n=e["widget"],t=i.value;return(0,_vue.h)(_row.default,{},{default(){return t.map((e,o)=>(0,_vue.h)(_col.default,{key:o,class:"vxe-form--item-row",span:e},{default(){var e=n.children[o];if(e){var t=e["name"],t=(_core.renderer.get(t)||{}).renderFormDesignWidgetView,r=e,i=!!d,e={widget:e,readonly:!1,disabled:!1,isEditMode:i,isViewMode:!i,$formDesign:d,$formView:u};if(t)return(0,_vn.getSlotVNs)(t(r,e))}return(0,_vue.createCommentVNode)()}}))}})}}});