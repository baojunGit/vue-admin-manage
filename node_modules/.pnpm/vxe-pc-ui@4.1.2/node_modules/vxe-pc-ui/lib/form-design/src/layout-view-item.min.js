"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewItemComponent=void 0;var _vue=require("vue"),_xeUtils=_interopRequireDefault(require("xe-utils")),_core=require("@vxe-ui/core"),_button=_interopRequireDefault(require("../../button/src/button"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const ViewItemComponent=exports.ViewItemComponent=(0,_vue.defineComponent)({name:"FormDesignLayoutViewItem",props:{item:{type:Object,default:()=>({})},itemIndex:{type:Number,default:0},items:{type:Array,default:()=>[]}},emits:[],setup(o,{slots:u}){const s=(0,_vue.inject)("$xeFormDesign",null);if(!s)return()=>[];const a=s["reactData"],l=e=>{var{widgetObjList:t,sortSubWidget:i}=a;if(i)e.preventDefault();else{i=e.currentTarget;const r=Number(i.getAttribute("data-widget-id"));e=_xeUtils.default.findTree(t,e=>e&&e.id===r,{children:"children"});e&&(a.dragWidget=null,a.sortWidget=e.item,a.sortSubWidget=null)}},g=()=>{a.activeWidget=a.sortWidget,a.sortWidget=null};let c=!1;const v=e=>{const{widgetObjList:t,sortWidget:i,sortSubWidget:r}=a;if(c||r)e.preventDefault();else if(i){var d,n=e.currentTarget;e.preventDefault();const o=Number(n.getAttribute("data-widget-id"));o!==i.id&&(n=_xeUtils.default.findTree(t,e=>e&&e.id===o,{children:"children"}))&&(d=_xeUtils.default.findTree(t,e=>e&&e.id===i.id,{children:"children"}))&&(d.items.splice(d.index,1),n.items.splice(n.index,0,d.item),s.dispatchEvent("drag-widget",{widget:d.item},e),c=!0,setTimeout(()=>{c=!1},150))}},m=e=>{var{sortWidget:t,dragWidget:i,sortSubWidget:r}=a;(t||i||r)&&e.preventDefault()};return()=>{var{dragWidget:e,activeWidget:t,sortWidget:i}=a;const r=o["item"];var d=r["name"],t=t&&t.id===r.id,n=u.default;return(0,_vue.h)("div",{key:r.id,"data-widget-id":r.id,draggable:!0,class:["vxe-form-design--preview-item","widget-"+_xeUtils.default.kebabCase(d),{"is--active":t,"is--sort":i&&i.id===r.id,"is--drag":e&&e.id===r.id}],onDragstart:l,onDragend:g,onDragenter:v,onDragover:m,onClick(e){var t;e=e,t=r,s.handleClickWidget(e,t),a.sortSubWidget=null}},[(0,_vue.h)("div",{class:"vxe-form-design--preview-item-view vxe-form--item-row"},n?n({}):[]),t?(0,_vue.h)("div",{class:"vxe-form-design--preview-item-operate"},[(0,_vue.h)(_button.default,{icon:(0,_core.getIcon)().FORM_DESIGN_WIDGET_COPY,status:"primary",size:"mini",circle:!0,onClick(e){s.handleCopyWidget(e.$event,r)}}),(0,_vue.h)(_button.default,{icon:(0,_core.getIcon)().FORM_DESIGN_WIDGET_DELETE,status:"danger",size:"mini",circle:!0,onClick(e){s.handleRemoveWidget(e.$event,r)}})]):(0,_vue.createCommentVNode)()])}}});