"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _vue=require("vue"),_ui=require("../../ui"),_vn=require("../../ui/src/vn"),_dom=require("../..//ui/src/dom"),_loading=_interopRequireDefault(require("../../loading/src/loading")),_xeUtils=_interopRequireDefault(require("xe-utils"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default=exports.default=(0,_vue.defineComponent)({name:"VxeCarousel",props:{modelValue:[String,Number],options:Array,loading:{type:Boolean,default:()=>(0,_ui.getConfig)().carousel.loading},height:{type:[Number,String],default:()=>(0,_ui.getConfig)().carousel.height},width:{type:[Number,String],default:()=>(0,_ui.getConfig)().carousel.width},autoPlay:{type:Boolean,default:()=>(0,_ui.getConfig)().carousel.autoPlay},loop:{type:Boolean,default:()=>(0,_ui.getConfig)().carousel.loop},vertical:{type:Boolean,default:()=>(0,_ui.getConfig)().carousel.vertical},showIndicators:{type:Boolean,default:()=>(0,_ui.getConfig)().carousel.showIndicators}},emits:["update:modelValue","change"],setup(n,e){const{emit:s,slots:r}=e;var t=_xeUtils.default.uniqueId();const o=(0,_vue.ref)(),c=(0,_vue.ref)(),v=(0,_vue.reactive)({activeName:"",staticItems:[],itemWidth:0,itemHeight:0}),a={refElem:o},d=(0,_vue.computed)(()=>{var{vertical:e,options:t}=n;const{activeName:a,itemWidth:i,itemHeight:u,staticItems:l}=v;var t=(l&&l.length?l:t)||[],s=Math.max(0,_xeUtils.default.findIndexOf(t,e=>e.name===a)),r={};return e?r.transform=`translateY(-${s*u}px)`:(r.width=i*t.length+"px",r.transform=`translateX(-${s*i}px)`),r}),i={},u={xID:t,props:n,context:e,reactData:v,getRefMaps:()=>a,getComputeMaps:()=>i},l=()=>{(0,_vue.nextTick)(()=>{var e=c.value;e&&(v.itemWidth=e.clientWidth,v.itemHeight=e.clientHeight)})},_=(e,t)=>{var a=t.name;v.activeName=t.name,s("update:modelValue",a),s("change",{value:a},e),l()},m=e=>{let a=null;if(e&&e.length){let t=!1;a=n.modelValue,e.forEach(e=>{a===e.name&&(t=!0)}),t||(a=e[0].name,s("update:modelValue",a))}v.activeName=a};const h=t=>{var{options:a,loop:i}=n;const{activeName:u,staticItems:e}=v;var a=(e&&e.length?e:a)||[],l=Math.max(0,_xeUtils.default.findIndexOf(a,e=>e.name===u));if(-1<l){let e=null;if(t?l<a.length-1?e=a[l+1]:i&&(e=a[0]):0<l?e=a[l-1]:i&&(e=a[a.length-1]),e)return l=t=e.name,v.activeName=t,s("update:modelValue",l),!0}return!1},g=e=>{var t;h(!1)&&(t=v.activeName,s("change",{value:t},e))},p=e=>{var t;h(!0)&&(t=v.activeName,s("change",{value:t},e))};Object.assign(u,{dispatchEvent:(e,t,a)=>{s(e,(0,_ui.createEvent)(a,{$carousel:u},t))},prev(){return h(!1),(0,_vue.nextTick)()},next(){return h(!0),(0,_vue.nextTick)()}},{});u.renderVN=()=>{var{loading:e,height:t,width:a,vertical:i,options:u}=n,l=v["staticItems"],s=r.default,l=(l&&l.length?l:u)||[];return(0,_vue.h)("div",{ref:o,class:["vxe-carousel","is--"+(i?"vertical":"horizontal")],style:a?{width:(0,_dom.toCssUnit)(a)}:null},[(0,_vue.h)("div",{class:"vxe-carousel--slots"},s?s({}):[]),(0,_vue.h)("div",{ref:c,class:"vxe-carousel--item-wrapper",style:t?{height:(0,_dom.toCssUnit)(t)}:null},(e=>{const i=n["height"],u=v["activeName"];var t=d.value;return(0,_vue.h)("div",{class:"vxe-carousel--list",style:t},e.map(e=>{var{name:e,url:t,slots:a}=e,a=a?a.default:null;return(0,_vue.h)("div",{key:""+e,class:["vxe-carousel--item-inner",{"is--active":u===e}],style:i?{height:(0,_dom.toCssUnit)(i)}:null},a?(0,_vn.getSlotVNs)(a({})):[(0,_vue.h)("img",{class:"vxe-carousel--item-img",src:t})])}))})(l)),(e=>{const a=v["activeName"];return(0,_vue.h)("div",{class:"vxe-carousel--indicators"},e.map(t=>{var e=t["name"];return(0,_vue.h)("div",{key:""+e,class:["vxe-carousel--indicators-item",{"is--active":a===e}],onClick(e){_(e,t)}})}))})(l),(0,_vue.h)("div",{class:"vxe-carousel--btn-wrapper"},[(0,_vue.h)("div",{class:"vxe-carousel--previous-btn",onClick:g},[(0,_vue.h)("i",{class:i?(0,_ui.getIcon)().CAROUSEL_VERTICAL_PREVIOUS:(0,_ui.getIcon)().CAROUSEL_HORIZONTAL_PREVIOUS})]),(0,_vue.h)("div",{class:"vxe-carousel--next-btn",onClick:p},[(0,_vue.h)("i",{class:i?(0,_ui.getIcon)().CAROUSEL_VERTICAL_NEXT:(0,_ui.getIcon)().CAROUSEL_HORIZONTAL_NEXT})])]),(0,_vue.h)(_loading.default,{class:"vxe-carousel--loading",modelValue:e})])};const f=(0,_vue.ref)(0),x=((0,_vue.watch)(()=>n.options?n.options.length:-1,()=>{f.value++}),(0,_vue.watch)(()=>n.options,()=>{f.value++}),(0,_vue.watch)(f,()=>{m(n.options)}),(0,_vue.ref)(0));return(0,_vue.watch)(()=>v.staticItems?v.staticItems.length:-1,()=>{x.value++}),(0,_vue.watch)(()=>v.staticItems,()=>{x.value++}),(0,_vue.watch)(x,()=>{m(v.staticItems)}),m(v.staticItems.length?v.staticItems:n.options),(0,_vue.onMounted)(()=>{l()}),(0,_vue.provide)("$xeCarousel",u),u},render(){return this.renderVN()}});